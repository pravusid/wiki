<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Refactoring | TIL wiki</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/wiki/assets/css/0.styles.28a8e502.css" as="style"><link rel="preload" href="/wiki/assets/js/app.6ca71e99.js" as="script"><link rel="preload" href="/wiki/assets/js/2.05cc4ee4.js" as="script"><link rel="preload" href="/wiki/assets/js/135.bb0ec3de.js" as="script"><link rel="prefetch" href="/wiki/assets/js/10.25463cd2.js"><link rel="prefetch" href="/wiki/assets/js/100.5d422659.js"><link rel="prefetch" href="/wiki/assets/js/101.4ffe14ca.js"><link rel="prefetch" href="/wiki/assets/js/102.42302bbb.js"><link rel="prefetch" href="/wiki/assets/js/103.e60186f1.js"><link rel="prefetch" href="/wiki/assets/js/104.2a78eac7.js"><link rel="prefetch" href="/wiki/assets/js/105.4d089b64.js"><link rel="prefetch" href="/wiki/assets/js/106.357830cf.js"><link rel="prefetch" href="/wiki/assets/js/107.487a4ef4.js"><link rel="prefetch" href="/wiki/assets/js/108.d6c93e86.js"><link rel="prefetch" href="/wiki/assets/js/109.280e49bd.js"><link rel="prefetch" href="/wiki/assets/js/11.ab0440cc.js"><link rel="prefetch" href="/wiki/assets/js/110.7bca741e.js"><link rel="prefetch" href="/wiki/assets/js/111.e5d8b9c2.js"><link rel="prefetch" href="/wiki/assets/js/112.f0c3997f.js"><link rel="prefetch" href="/wiki/assets/js/113.98fccca8.js"><link rel="prefetch" href="/wiki/assets/js/114.80803ef6.js"><link rel="prefetch" href="/wiki/assets/js/115.326693bc.js"><link rel="prefetch" href="/wiki/assets/js/116.3f2be2b4.js"><link rel="prefetch" href="/wiki/assets/js/117.5a8d4bb7.js"><link rel="prefetch" href="/wiki/assets/js/118.cc5b89af.js"><link rel="prefetch" href="/wiki/assets/js/119.59a067c1.js"><link rel="prefetch" href="/wiki/assets/js/12.a9867bc5.js"><link rel="prefetch" href="/wiki/assets/js/120.53725c63.js"><link rel="prefetch" href="/wiki/assets/js/121.badf847a.js"><link rel="prefetch" href="/wiki/assets/js/122.818bb340.js"><link rel="prefetch" href="/wiki/assets/js/123.e9f28818.js"><link rel="prefetch" href="/wiki/assets/js/124.18966c4c.js"><link rel="prefetch" href="/wiki/assets/js/125.e25f7cc0.js"><link rel="prefetch" href="/wiki/assets/js/126.612eabad.js"><link rel="prefetch" href="/wiki/assets/js/127.6238d825.js"><link rel="prefetch" href="/wiki/assets/js/128.3544e4fb.js"><link rel="prefetch" href="/wiki/assets/js/129.49dfbf61.js"><link rel="prefetch" href="/wiki/assets/js/13.ea3fc194.js"><link rel="prefetch" href="/wiki/assets/js/130.f797d170.js"><link rel="prefetch" href="/wiki/assets/js/131.da4d549b.js"><link rel="prefetch" href="/wiki/assets/js/132.195d6d44.js"><link rel="prefetch" href="/wiki/assets/js/133.c1bff2b4.js"><link rel="prefetch" href="/wiki/assets/js/134.6ed6bfd7.js"><link rel="prefetch" href="/wiki/assets/js/136.e9961e8c.js"><link rel="prefetch" href="/wiki/assets/js/137.ec2d38a2.js"><link rel="prefetch" href="/wiki/assets/js/138.1752a738.js"><link rel="prefetch" href="/wiki/assets/js/139.4b5b52df.js"><link rel="prefetch" href="/wiki/assets/js/14.c5dc23f3.js"><link rel="prefetch" href="/wiki/assets/js/140.06d1e087.js"><link rel="prefetch" href="/wiki/assets/js/141.4105daae.js"><link rel="prefetch" href="/wiki/assets/js/142.05ccae7b.js"><link rel="prefetch" href="/wiki/assets/js/143.716cd46d.js"><link rel="prefetch" href="/wiki/assets/js/144.790cf13e.js"><link rel="prefetch" href="/wiki/assets/js/145.19731114.js"><link rel="prefetch" href="/wiki/assets/js/146.a658747b.js"><link rel="prefetch" href="/wiki/assets/js/147.d81b2821.js"><link rel="prefetch" href="/wiki/assets/js/148.ba7bd0a7.js"><link rel="prefetch" href="/wiki/assets/js/149.f2a87de6.js"><link rel="prefetch" href="/wiki/assets/js/15.6461f7ab.js"><link rel="prefetch" href="/wiki/assets/js/150.7d352737.js"><link rel="prefetch" href="/wiki/assets/js/151.d9b9e887.js"><link rel="prefetch" href="/wiki/assets/js/152.68a4c414.js"><link rel="prefetch" href="/wiki/assets/js/153.e87973d5.js"><link rel="prefetch" href="/wiki/assets/js/154.e76263df.js"><link rel="prefetch" href="/wiki/assets/js/155.436e0ed8.js"><link rel="prefetch" href="/wiki/assets/js/156.e3381354.js"><link rel="prefetch" href="/wiki/assets/js/157.9eaa5b90.js"><link rel="prefetch" href="/wiki/assets/js/158.b114dc60.js"><link rel="prefetch" href="/wiki/assets/js/159.d4fede59.js"><link rel="prefetch" href="/wiki/assets/js/16.cdb087a1.js"><link rel="prefetch" href="/wiki/assets/js/160.91c2b0c3.js"><link rel="prefetch" href="/wiki/assets/js/161.46e74335.js"><link rel="prefetch" href="/wiki/assets/js/162.b93af4eb.js"><link rel="prefetch" href="/wiki/assets/js/163.9b816955.js"><link rel="prefetch" href="/wiki/assets/js/164.3bea5fc5.js"><link rel="prefetch" href="/wiki/assets/js/165.491570eb.js"><link rel="prefetch" href="/wiki/assets/js/166.46c09a5b.js"><link rel="prefetch" href="/wiki/assets/js/167.2c24cc7b.js"><link rel="prefetch" href="/wiki/assets/js/168.ac78a253.js"><link rel="prefetch" href="/wiki/assets/js/169.4564ce4c.js"><link rel="prefetch" href="/wiki/assets/js/17.b7b7fec7.js"><link rel="prefetch" href="/wiki/assets/js/170.bf660d2f.js"><link rel="prefetch" href="/wiki/assets/js/171.78a6e48d.js"><link rel="prefetch" href="/wiki/assets/js/172.7a73f7a3.js"><link rel="prefetch" href="/wiki/assets/js/173.fa199918.js"><link rel="prefetch" href="/wiki/assets/js/174.c0cbf394.js"><link rel="prefetch" href="/wiki/assets/js/175.ba6b31ef.js"><link rel="prefetch" href="/wiki/assets/js/176.f0a9a609.js"><link rel="prefetch" href="/wiki/assets/js/177.58c5374e.js"><link rel="prefetch" href="/wiki/assets/js/178.81ff4020.js"><link rel="prefetch" href="/wiki/assets/js/179.a1f0b90d.js"><link rel="prefetch" href="/wiki/assets/js/18.d42a5a75.js"><link rel="prefetch" href="/wiki/assets/js/180.19955cd1.js"><link rel="prefetch" href="/wiki/assets/js/181.5dbd0b7b.js"><link rel="prefetch" href="/wiki/assets/js/182.f1cb99d5.js"><link rel="prefetch" href="/wiki/assets/js/183.c24cb4aa.js"><link rel="prefetch" href="/wiki/assets/js/184.5ba3bd1f.js"><link rel="prefetch" href="/wiki/assets/js/185.14b6bf74.js"><link rel="prefetch" href="/wiki/assets/js/186.3b507c9c.js"><link rel="prefetch" href="/wiki/assets/js/187.72c347d5.js"><link rel="prefetch" href="/wiki/assets/js/188.e7387f3a.js"><link rel="prefetch" href="/wiki/assets/js/189.d4daf473.js"><link rel="prefetch" href="/wiki/assets/js/19.962d2138.js"><link rel="prefetch" href="/wiki/assets/js/190.bd488f2f.js"><link rel="prefetch" href="/wiki/assets/js/191.4d73222c.js"><link rel="prefetch" href="/wiki/assets/js/192.a5da609d.js"><link rel="prefetch" href="/wiki/assets/js/193.ae615d54.js"><link rel="prefetch" href="/wiki/assets/js/194.e381a404.js"><link rel="prefetch" href="/wiki/assets/js/195.6d256358.js"><link rel="prefetch" href="/wiki/assets/js/196.cd6e561d.js"><link rel="prefetch" href="/wiki/assets/js/197.49a9665a.js"><link rel="prefetch" href="/wiki/assets/js/198.9b5fcb8c.js"><link rel="prefetch" href="/wiki/assets/js/199.4e66d6ee.js"><link rel="prefetch" href="/wiki/assets/js/20.7aaef2ea.js"><link rel="prefetch" href="/wiki/assets/js/200.2b34f949.js"><link rel="prefetch" href="/wiki/assets/js/201.c1306b52.js"><link rel="prefetch" href="/wiki/assets/js/202.f26321b8.js"><link rel="prefetch" href="/wiki/assets/js/203.f733c291.js"><link rel="prefetch" href="/wiki/assets/js/204.7c5921f7.js"><link rel="prefetch" href="/wiki/assets/js/205.31e48468.js"><link rel="prefetch" href="/wiki/assets/js/206.af70852a.js"><link rel="prefetch" href="/wiki/assets/js/207.344d0c5b.js"><link rel="prefetch" href="/wiki/assets/js/208.6d967a4a.js"><link rel="prefetch" href="/wiki/assets/js/209.04091c27.js"><link rel="prefetch" href="/wiki/assets/js/21.a273efba.js"><link rel="prefetch" href="/wiki/assets/js/210.8a1ed2ce.js"><link rel="prefetch" href="/wiki/assets/js/211.aa104a1f.js"><link rel="prefetch" href="/wiki/assets/js/212.7dcca7f0.js"><link rel="prefetch" href="/wiki/assets/js/213.04e80003.js"><link rel="prefetch" href="/wiki/assets/js/214.96767a7d.js"><link rel="prefetch" href="/wiki/assets/js/215.01008b6d.js"><link rel="prefetch" href="/wiki/assets/js/216.fff32c3b.js"><link rel="prefetch" href="/wiki/assets/js/217.e07991dd.js"><link rel="prefetch" href="/wiki/assets/js/218.b60a3443.js"><link rel="prefetch" href="/wiki/assets/js/219.3379f602.js"><link rel="prefetch" href="/wiki/assets/js/22.8f78e9ba.js"><link rel="prefetch" href="/wiki/assets/js/220.456a255a.js"><link rel="prefetch" href="/wiki/assets/js/221.7c0fcace.js"><link rel="prefetch" href="/wiki/assets/js/222.f884e51f.js"><link rel="prefetch" href="/wiki/assets/js/223.e605d8e3.js"><link rel="prefetch" href="/wiki/assets/js/224.02225df6.js"><link rel="prefetch" href="/wiki/assets/js/225.db265989.js"><link rel="prefetch" href="/wiki/assets/js/226.c39ff4d4.js"><link rel="prefetch" href="/wiki/assets/js/227.20a3c4e7.js"><link rel="prefetch" href="/wiki/assets/js/228.697c0088.js"><link rel="prefetch" href="/wiki/assets/js/229.ad28e588.js"><link rel="prefetch" href="/wiki/assets/js/23.48ddc56f.js"><link rel="prefetch" href="/wiki/assets/js/230.02091c7a.js"><link rel="prefetch" href="/wiki/assets/js/231.43946405.js"><link rel="prefetch" href="/wiki/assets/js/232.74818868.js"><link rel="prefetch" href="/wiki/assets/js/233.a6fad884.js"><link rel="prefetch" href="/wiki/assets/js/234.cd305fb7.js"><link rel="prefetch" href="/wiki/assets/js/235.a1071b75.js"><link rel="prefetch" href="/wiki/assets/js/236.0c7f0dbd.js"><link rel="prefetch" href="/wiki/assets/js/237.0998dfcc.js"><link rel="prefetch" href="/wiki/assets/js/238.a403d345.js"><link rel="prefetch" href="/wiki/assets/js/239.d5f1a06b.js"><link rel="prefetch" href="/wiki/assets/js/24.fadbfb2d.js"><link rel="prefetch" href="/wiki/assets/js/240.10debed9.js"><link rel="prefetch" href="/wiki/assets/js/241.1e59386b.js"><link rel="prefetch" href="/wiki/assets/js/242.3ceb42e7.js"><link rel="prefetch" href="/wiki/assets/js/243.a077f738.js"><link rel="prefetch" href="/wiki/assets/js/244.7f781b38.js"><link rel="prefetch" href="/wiki/assets/js/245.a75f3385.js"><link rel="prefetch" href="/wiki/assets/js/246.62ddc6a1.js"><link rel="prefetch" href="/wiki/assets/js/247.728e254b.js"><link rel="prefetch" href="/wiki/assets/js/248.e4cdd9cb.js"><link rel="prefetch" href="/wiki/assets/js/249.9c63a21a.js"><link rel="prefetch" href="/wiki/assets/js/25.eb8246d7.js"><link rel="prefetch" href="/wiki/assets/js/250.109133a8.js"><link rel="prefetch" href="/wiki/assets/js/251.b17f8cc0.js"><link rel="prefetch" href="/wiki/assets/js/252.45634548.js"><link rel="prefetch" href="/wiki/assets/js/253.b7525eec.js"><link rel="prefetch" href="/wiki/assets/js/254.db77916a.js"><link rel="prefetch" href="/wiki/assets/js/255.b7bbc187.js"><link rel="prefetch" href="/wiki/assets/js/256.5e3a6143.js"><link rel="prefetch" href="/wiki/assets/js/257.6a3b9360.js"><link rel="prefetch" href="/wiki/assets/js/258.da9da0de.js"><link rel="prefetch" href="/wiki/assets/js/259.c945937b.js"><link rel="prefetch" href="/wiki/assets/js/26.2706b766.js"><link rel="prefetch" href="/wiki/assets/js/260.8de02f03.js"><link rel="prefetch" href="/wiki/assets/js/261.5475d09a.js"><link rel="prefetch" href="/wiki/assets/js/262.dd3a47e3.js"><link rel="prefetch" href="/wiki/assets/js/263.3f722bc7.js"><link rel="prefetch" href="/wiki/assets/js/264.b130fd27.js"><link rel="prefetch" href="/wiki/assets/js/265.f6b7420d.js"><link rel="prefetch" href="/wiki/assets/js/266.96a1e171.js"><link rel="prefetch" href="/wiki/assets/js/267.9e9c78f4.js"><link rel="prefetch" href="/wiki/assets/js/268.64ee3173.js"><link rel="prefetch" href="/wiki/assets/js/269.f3b362a1.js"><link rel="prefetch" href="/wiki/assets/js/27.1253dc78.js"><link rel="prefetch" href="/wiki/assets/js/270.9e2cab93.js"><link rel="prefetch" href="/wiki/assets/js/271.964b8fc9.js"><link rel="prefetch" href="/wiki/assets/js/272.d716b10f.js"><link rel="prefetch" href="/wiki/assets/js/273.266872b5.js"><link rel="prefetch" href="/wiki/assets/js/274.4e0b9181.js"><link rel="prefetch" href="/wiki/assets/js/275.674bd35c.js"><link rel="prefetch" href="/wiki/assets/js/276.2f4036b3.js"><link rel="prefetch" href="/wiki/assets/js/277.95e62013.js"><link rel="prefetch" href="/wiki/assets/js/28.45305508.js"><link rel="prefetch" href="/wiki/assets/js/29.9b5181de.js"><link rel="prefetch" href="/wiki/assets/js/3.2323fdab.js"><link rel="prefetch" href="/wiki/assets/js/30.69514220.js"><link rel="prefetch" href="/wiki/assets/js/31.b94940bc.js"><link rel="prefetch" href="/wiki/assets/js/32.60cf21d2.js"><link rel="prefetch" href="/wiki/assets/js/33.2de027fb.js"><link rel="prefetch" href="/wiki/assets/js/34.4aa03548.js"><link rel="prefetch" href="/wiki/assets/js/35.cbc9121f.js"><link rel="prefetch" href="/wiki/assets/js/36.d26d9bc5.js"><link rel="prefetch" href="/wiki/assets/js/37.79cae13b.js"><link rel="prefetch" href="/wiki/assets/js/38.0255436e.js"><link rel="prefetch" href="/wiki/assets/js/39.e607db51.js"><link rel="prefetch" href="/wiki/assets/js/4.70e730be.js"><link rel="prefetch" href="/wiki/assets/js/40.074c5155.js"><link rel="prefetch" href="/wiki/assets/js/41.2682b777.js"><link rel="prefetch" href="/wiki/assets/js/42.1a84e23e.js"><link rel="prefetch" href="/wiki/assets/js/43.db897e03.js"><link rel="prefetch" href="/wiki/assets/js/44.99bb2ea6.js"><link rel="prefetch" href="/wiki/assets/js/45.f5c81de0.js"><link rel="prefetch" href="/wiki/assets/js/46.57a806a7.js"><link rel="prefetch" href="/wiki/assets/js/47.1db10530.js"><link rel="prefetch" href="/wiki/assets/js/48.501685d1.js"><link rel="prefetch" href="/wiki/assets/js/49.2ab321c7.js"><link rel="prefetch" href="/wiki/assets/js/5.611833a9.js"><link rel="prefetch" href="/wiki/assets/js/50.572bc777.js"><link rel="prefetch" href="/wiki/assets/js/51.79c8dd12.js"><link rel="prefetch" href="/wiki/assets/js/52.7e21798b.js"><link rel="prefetch" href="/wiki/assets/js/53.87c8a5f0.js"><link rel="prefetch" href="/wiki/assets/js/54.c5576eed.js"><link rel="prefetch" href="/wiki/assets/js/55.20e796fc.js"><link rel="prefetch" href="/wiki/assets/js/56.8af5d610.js"><link rel="prefetch" href="/wiki/assets/js/57.342b507e.js"><link rel="prefetch" href="/wiki/assets/js/58.a30a8c21.js"><link rel="prefetch" href="/wiki/assets/js/59.5fbe6e0e.js"><link rel="prefetch" href="/wiki/assets/js/6.b3198dbe.js"><link rel="prefetch" href="/wiki/assets/js/60.6643b037.js"><link rel="prefetch" href="/wiki/assets/js/61.87e218c6.js"><link rel="prefetch" href="/wiki/assets/js/62.253ba3fa.js"><link rel="prefetch" href="/wiki/assets/js/63.f8fe99b0.js"><link rel="prefetch" href="/wiki/assets/js/64.68b97266.js"><link rel="prefetch" href="/wiki/assets/js/65.6aea3179.js"><link rel="prefetch" href="/wiki/assets/js/66.27dd8fe9.js"><link rel="prefetch" href="/wiki/assets/js/67.e1b42e43.js"><link rel="prefetch" href="/wiki/assets/js/68.42386d9b.js"><link rel="prefetch" href="/wiki/assets/js/69.b6b72d4c.js"><link rel="prefetch" href="/wiki/assets/js/7.b48a85c8.js"><link rel="prefetch" href="/wiki/assets/js/70.f08719c4.js"><link rel="prefetch" href="/wiki/assets/js/71.bb32be15.js"><link rel="prefetch" href="/wiki/assets/js/72.2f341440.js"><link rel="prefetch" href="/wiki/assets/js/73.c522b187.js"><link rel="prefetch" href="/wiki/assets/js/74.06d1abab.js"><link rel="prefetch" href="/wiki/assets/js/75.9ac0d07b.js"><link rel="prefetch" href="/wiki/assets/js/76.bc2bd62a.js"><link rel="prefetch" href="/wiki/assets/js/77.5df406d3.js"><link rel="prefetch" href="/wiki/assets/js/78.6450c7a2.js"><link rel="prefetch" href="/wiki/assets/js/79.f60cbf68.js"><link rel="prefetch" href="/wiki/assets/js/8.ed910aa6.js"><link rel="prefetch" href="/wiki/assets/js/80.89f66b72.js"><link rel="prefetch" href="/wiki/assets/js/81.bdd2794f.js"><link rel="prefetch" href="/wiki/assets/js/82.36560094.js"><link rel="prefetch" href="/wiki/assets/js/83.e6a40183.js"><link rel="prefetch" href="/wiki/assets/js/84.5f352082.js"><link rel="prefetch" href="/wiki/assets/js/85.f1babfd1.js"><link rel="prefetch" href="/wiki/assets/js/86.670d693c.js"><link rel="prefetch" href="/wiki/assets/js/87.76b8d67a.js"><link rel="prefetch" href="/wiki/assets/js/88.f956d053.js"><link rel="prefetch" href="/wiki/assets/js/89.16cbf0af.js"><link rel="prefetch" href="/wiki/assets/js/9.ddf634b9.js"><link rel="prefetch" href="/wiki/assets/js/90.039cde6b.js"><link rel="prefetch" href="/wiki/assets/js/91.c5f54f32.js"><link rel="prefetch" href="/wiki/assets/js/92.a1886a7b.js"><link rel="prefetch" href="/wiki/assets/js/93.e52e3ab7.js"><link rel="prefetch" href="/wiki/assets/js/94.c3c33eb1.js"><link rel="prefetch" href="/wiki/assets/js/95.42881c10.js"><link rel="prefetch" href="/wiki/assets/js/96.3d73501a.js"><link rel="prefetch" href="/wiki/assets/js/97.3c0dc0f5.js"><link rel="prefetch" href="/wiki/assets/js/98.4dc63992.js"><link rel="prefetch" href="/wiki/assets/js/99.81c877b0.js">
    <link rel="stylesheet" href="/wiki/assets/css/0.styles.28a8e502.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki/" class="home-link router-link-active"><!----> <span class="site-name">TIL wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/pravusid/TIL" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/pravusid/TIL" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Refactoring</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki/Lecture/refactoring.html#리팩토링-개론" class="sidebar-link">리팩토링 개론</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#리팩토링은-무엇인가" class="sidebar-link">리팩토링은 무엇인가</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#리팩토링-목적" class="sidebar-link">리팩토링 목적</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#리팩토링이-필요할-때" class="sidebar-link">리팩토링이 필요할 때</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#인다이렉션과-리팩토링" class="sidebar-link">인다이렉션과 리팩토링</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#리팩토링-관련-문제" class="sidebar-link">리팩토링 관련 문제</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#리팩토링과-설계" class="sidebar-link">리팩토링과 설계</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#리팩토링과-성능" class="sidebar-link">리팩토링과 성능</a></li></ul></li><li><a href="/wiki/Lecture/refactoring.html#code-smell" class="sidebar-link">Code Smell</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#중복코드-duplicated-code" class="sidebar-link">중복코드(Duplicated code)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#장황한-메소드-long-method" class="sidebar-link">장황한 메소드(Long method)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#거대한-클래스-large-class" class="sidebar-link">거대한 클래스(Large class)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#과다한-매개변수-long-parameter-list" class="sidebar-link">과다한 매개변수(Long parameter list)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#수정의-산발-divergent-change" class="sidebar-link">수정의 산발(Divergent change)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#기능의-산재-shotgun-surgery" class="sidebar-link">기능의 산재(Shotgun surgery)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#잘못된-소속-feature-envy" class="sidebar-link">잘못된 소속(Feature envy)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#데이터-뭉치-data-clumps" class="sidebar-link">데이터 뭉치(Data clumps)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#강박적-기본-타입-사용-primitive-obsession" class="sidebar-link">강박적 기본 타입 사용(Primitive obsession)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#switch-문-switch-statement" class="sidebar-link">Switch 문(Switch statement)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#평행-상속-계층-parallel-inheritance-hierarchies" class="sidebar-link">평행 상속 계층(Parallel inheritance hierarchies)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#직무유기-클래스-lazy-class" class="sidebar-link">직무유기 클래스(Lazy class)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#막연한-범용-코드-speculative-generality" class="sidebar-link">막연한 범용 코드(Speculative generality)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#임시-필드-temporary-field" class="sidebar-link">임시 필드(Temporary field)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#메시지-체인-message-chains" class="sidebar-link">메시지 체인(Message chains)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#과잉-중개-메소드-middle-man" class="sidebar-link">과잉 중개 메소드(Middle Man)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#지나친-관여-inappropriate-intimacy" class="sidebar-link">지나친 관여(Inappropriate intimacy)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#인터페이스가-다른-대용-클래스-alternative-classes-with-different-interfaces" class="sidebar-link">인터페이스가 다른 대용 클래스(Alternative classes with different interfaces)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#미흡한-라이브러리-클래스-incomplete-library-class" class="sidebar-link">미흡한 라이브러리 클래스(Incomplete library class)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#데이터-클래스-data-class" class="sidebar-link">데이터 클래스(Data class)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#방치된-상속물-refused-bequest" class="sidebar-link">방치된 상속물(Refused Bequest)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#불필요한-주석-comments" class="sidebar-link">불필요한 주석(Comments)</a></li></ul></li><li><a href="/wiki/Lecture/refactoring.html#테스트작성" class="sidebar-link">테스트작성</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#자가-테스트-코드의-가치" class="sidebar-link">자가 테스트 코드의 가치</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#테스트-추가" class="sidebar-link">테스트 추가</a></li></ul></li><li><a href="/wiki/Lecture/refactoring.html#메소드-정리" class="sidebar-link">메소드 정리</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#메소드-추출" class="sidebar-link">메소드 추출</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#메소드-내용-직접-삽입" class="sidebar-link">메소드 내용 직접 삽입</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#임시변수-내용-직접-삽입" class="sidebar-link">임시변수 내용 직접 삽입</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#임시변수를-메소드-호출로-전환-replace-temp-with-query" class="sidebar-link">임시변수를 메소드 호출로 전환(Replace Temp with Query)</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#직관적-임시변수-사용" class="sidebar-link">직관적 임시변수 사용</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#임시변수-분리" class="sidebar-link">임시변수 분리</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#매개변수로의-값-대입-제거" class="sidebar-link">매개변수로의 값 대입 제거</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#메소드를-메소드-객체로-전환" class="sidebar-link">메소드를 메소드 객체로 전환</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#알고리즘-전환" class="sidebar-link">알고리즘 전환</a></li></ul></li><li><a href="/wiki/Lecture/refactoring.html#객체-간의-기능-이동" class="sidebar-link">객체 간의 기능 이동</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#메소드-이동" class="sidebar-link">메소드 이동</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#필드-이동" class="sidebar-link">필드 이동</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#클래스-추출" class="sidebar-link">클래스 추출</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#클래스-내용-직접-삽입" class="sidebar-link">클래스 내용 직접 삽입</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#대리-객체-은폐" class="sidebar-link">대리 객체 은폐</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#과잉-중개-메소드-제거" class="sidebar-link">과잉 중개 메소드 제거</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#외래-클래스에-메소드-추가" class="sidebar-link">외래 클래스에 메소드 추가</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#국소적-상속확장-클래스-사용" class="sidebar-link">국소적 상속확장 클래스 사용</a></li></ul></li><li><a href="/wiki/Lecture/refactoring.html#데이터-체계화" class="sidebar-link">데이터 체계화</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#필드-자체-캡슐화" class="sidebar-link">필드 자체 캡슐화</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#데이터-값을-객체로-전환" class="sidebar-link">데이터 값을 객체로 전환</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#값을-참조로-전환" class="sidebar-link">값을 참조로 전환</a></li><li class="sidebar-sub-header"><a href="/wiki/Lecture/refactoring.html#참조를-값으로-전환" class="sidebar-link">참조를 값으로 전환</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="refactoring"><a href="#refactoring" class="header-anchor">#</a> Refactoring</h1> <h2 id="리팩토링-개론"><a href="#리팩토링-개론" class="header-anchor">#</a> 리팩토링 개론</h2> <h3 id="리팩토링은-무엇인가"><a href="#리팩토링은-무엇인가" class="header-anchor">#</a> 리팩토링은 무엇인가</h3> <p>리팩토링: 겉으로 드러나는 기능은 그대로 둔 채, 알아보기 쉽고 수정하기 간편하게 소프트웨어 내부를 수정하는 작업</p> <p>리팩토링의 목적은 소프트웨어를 더 이해하기 쉽고 수정하기 쉽게 만드는 것이다.
리팩토링은 성능 최적화와 상반된다. 성능 최적화를 수행하면 코드를 파악하기 더 어려워질 때가 많다.</p> <p>소프트웨어 개발에 리팩토링을 적용할 때 기능 추가와 리팩토링이라는 별개의 두 작업에 시간을 분배해야 한다.</p> <ul><li>기능을 추가할 땐 코드를 수정하지 말고 기능만 추가해야 하며, 진행상태를 파악하려면 테스트를 추가하고 통과여부를 확인한다</li> <li>리팩토링 할 때는 코드를 추가하지 말고 코드 구조 개선만 해야 한다</li> <li>인터페이스가 변경되어 그에 맞게 코드를 고치는 것이 불가할 때는 테스트만 변경해야 한다</li></ul> <h3 id="리팩토링-목적"><a href="#리팩토링-목적" class="header-anchor">#</a> 리팩토링 목적</h3> <ul><li><p>소프트웨어 설계 개선</p> <ul><li>지속적으로 코드를 수정하면 코드 구조가 복잡해진다</li> <li>코드의 처음 설계구조를 유지하려면 정기적으로 리팩토링을 실시해야 한다</li> <li>특히 설계가 깔끔하지 않으면 중복코드로 인해 쓸데없이 코드가 길어진다</li></ul></li> <li><p>소프트웨어 이해를 쉽게 한다</p> <ul><li>코드에는 나중에 수정될 다른 개발자에 대한 고려가 반영되어야 한다</li> <li>코드를 파악하기 쉽게 수정하기 위한 과정이 리팩토링이다</li> <li>리팩토링을 하면서 낮선 코드를 쉽게 이해할 수도 있다</li></ul></li> <li><p>버그를 찾기 쉬워진다</p> <ul><li>프로그램 구조를 명료하게 만들어 특정해놓은 전제들이 확실해지면 버그 발견하기가 쉬워진다</li></ul></li> <li><p>프로그래밍 속도가 빨라진다</p> <ul><li>깔끔한 설계는 소프트웨어 개발속도를 높이기위한 핵심이다</li> <li>깔끔하지 않다면 버그를 찾고 중복코드를 찾느라 시간이 길어진다</li></ul></li></ul> <h3 id="리팩토링이-필요할-때"><a href="#리팩토링이-필요할-때" class="header-anchor">#</a> 리팩토링이 필요할 때</h3> <ul><li><p>같은 작업의 삼진 아웃</p> <ul><li>어떤 작업을 처음 하면 그냥 한다.</li> <li>비슷한 작업을 두 번째 하면 중복이라도 그냥 한다</li> <li>그러나 비슷한 작업을 세 번째 하게 되면 리팩토링을 실시해야 한다</li></ul></li> <li><p>기능을 추가할 때</p> <ul><li>기능을 추가할 때 기존 코드를 이해하기 위해서, 혹은 이해하기 쉽게 만들기 위해 리팩토링이 필요하다</li> <li>리팩토링 여부는 이해가 쉽게 고칠 수 있는지 고민한 뒤 결정한다</li> <li>기능 추가 중 설계 때문에 작업의 어려움을 느낀다면 리팩토링을 실시해야 한다</li></ul></li> <li><p>버그 수정시</p> <ul><li>버그를 수정하려면 코드의 기능을 파악하여야 하고 이를 위해 리팩토링을 실시한다</li> <li>버그 리포팅을 받았을 때도 리팩토링이 필요하다. 버그 존재를 파악하기 힘든 구조가 존재했기 때문이다</li></ul></li> <li><p>코드 검수시</p> <ul><li>코드를 검수한다면 리팩토링을 통해 자신의 코드를 이해하기 쉽게 만들고 타인의 코드를 쉽게 이해하여야 한다</li></ul></li></ul> <h3 id="인다이렉션과-리팩토링"><a href="#인다이렉션과-리팩토링" class="header-anchor">#</a> 인다이렉션과 리팩토링</h3> <p>소프트웨어 공학자들은 인다이렉션을 광적으로 좋아한다는 점에서 대부분의 리팩토링에서 인다이렉션이 적용되는 것은 당연한 일이다.</p> <p>그러나 인다이렉션은 양날의 검이다. 한 부분을 둘로 쪼개면 관리할 부분이 늘어난다.
또한 객체가 또 다른 객체에 작업을 위임하기 때문에 코드를 알아보기 힘들어질 수도 있다.</p> <p>하지만 인다이렉션은 다음과 같은 장점이 있다</p> <ul><li>로직을 공유: 하나의 로직을 여러곳에서 공유할 수 있다</li> <li>의도와 구현부를 분리: 클래스명과 메소드명으로 의도를 드러낼 수 있고, 클래스나 메소드의 내부 코드를 통해 의도를 어떻게 구현했는지 보여줄 수 있다</li> <li>수정 부분을 분리: 한 객체를 두 위치에서 사용했는데 객체를 수정하면 두곳 다 변경될 위험이 있다. 이 때 하위클래스로 수정할 수 있다</li> <li>조건문을 코드화: 조건문을 메시지로 바꾸면 중복코드가 줄어들어 명료해지며 유연성도 높아진다</li></ul> <h3 id="리팩토링-관련-문제"><a href="#리팩토링-관련-문제" class="header-anchor">#</a> 리팩토링 관련 문제</h3> <h4 id="데이터베이스"><a href="#데이터베이스" class="header-anchor">#</a> 데이터베이스</h4> <p>수많은 비즈니스 애플리케이션은 데이터베이스 스키마와 강력히 결합되어 있다.
데이터베이스 스키마와 객체 모델의 상호 의존성을 최소화 하여 구성해도,
데이터베이스 스키마를 수정하면 데이터도 이전해야 하는데 시간도 오래 걸리며 위험성도 높다.</p> <h4 id="인터페이스-변경"><a href="#인터페이스-변경" class="header-anchor">#</a> 인터페이스 변경</h4> <p>객체의 장점중 하나는 인터페이스를 건드리지 않고 내부 구현을 수정할 수 이:ㅆ다는 점이다.</p> <p>하지만 인터페이스를 수정하면 어떤 문제가 발생할지 알 수 없다.
리팩토링에서 불안한 점은 상당수의 리팩토링이 인터페이스를 건드린다는 것이다.</p> <p>만일 메소드를 사용하는 모든 코드에 접근할 수 있다면 메소드명을 변경하는 것은 문제가 되지 않을 수 이:ㅆ다.
public 메소드라 해도 메소드를 호출하는 부분을 수정할 수 있다면 변경가능하다.</p> <p>그러나 인터페이스가 public 보다 더 적극적으로 공개된 published 인터페이스라면 문제가 생긴다.</p> <p>published 인터페이스(공개한 라이브러리 인터페이스의 경우) 라면 해당 인터페이스를 사용하는 부분이 수정되기 전까지는
기존 인터페이스와 새 인터페이스를 모두 그대로 유지해야 한다.</p> <p>이 경우 기존 인터페이스가 새 인터페이스를 호출하게 하면 된다. 더불어 deprecation을 통해 더 이상 사용하지 않는 인터페이스임을 알려야한다.</p> <h4 id="리팩토링-하면-안-되는-상황"><a href="#리팩토링-하면-안-되는-상황" class="header-anchor">#</a> 리팩토링 하면 안 되는 상황</h4> <p>기존 코드를 리팩토링 할 수 있지만, 너무나 지저분해서 차라리 새로 작성하는 것이 나은 경우가 있다.</p> <p>만일 코드가 돌아가지 않는다면 완전히 새로 작성해야 한다는 신호이다.
테스트만 하려다 코드가 안정화 될 수 없는 경우도 그런 경우이다.</p> <p>종료 시점이 임박했을 때도 리팩토링은 피해야 한다.</p> <h3 id="리팩토링과-설계"><a href="#리팩토링과-설계" class="header-anchor">#</a> 리팩토링과 설계</h3> <p>리팩토링은 설계를 보완하는 특수한 역할을 한다.
설계가 핵심이고 프로그래밍은 구현 도구에 불과하다고 생각할 수 있으나, 설계에는 빈틈이 많다.</p> <p>사전 설계 없이 리팩토링만 하는 방법을 택할수도 있지만, 결국 설계를 수정해야 하는 시점이 오면 큰 비용이 발생할 수도 있다.</p> <p>리팩토링을 실시하더라도 여전히 설계는 해야 하지만, 사전 설계 과정에서 완벽함을 추구할 필요 없이 적당한 솔루션만 생각하면 된다.
솔루션을 구축해 나가면서 문제를 더 잘 이해하게 되며, 최상의 솔루션이 처음의 생각과는 다르다는 사실을 깨닫게 된다.</p> <p>작업 중심 방식으로 이동하여 얻는 장점은 설계가 단순해진다는 점이다.</p> <p>사전설계를 한다면 항상 발생하지도 않을 수정에 대한 비용을 걱정하느라 과도하게 유연한 솔루션을 갖추려하게 되고 이는 복잡성을 유발한다.</p> <h3 id="리팩토링과-성능"><a href="#리팩토링과-성능" class="header-anchor">#</a> 리팩토링과 성능</h3> <p>소프트웨어를 이해하기 쉽게 만드려면 수정할 일이 많은데, 그러한 수정으로 프로그램이 느려질수도 있다.</p> <p>빠른 소프트웨어를 작성할 수 있는 일반적인 세 가지 방법이 있다</p> <ul><li><p>실시간 시스템에 주로 사용되는 시간분배</p> <ul><li>설계를 분해하면서 각 구성요소에 시간이나 메모리 같은 자원별 예산을 할당하는 것</li> <li>컴포넌트간 할당된 시간의 상호교환은 혀용하나 예산을 초과하면 안된다</li> <li>이 방식은 철저히 성능 시간을 중시한다</li></ul></li> <li><p>성능에 관심을 가지는 것이다</p> <ul><li>개발자에게 성능을 유지해야 함을 인식시키는 방법이다</li> <li>실제로 효과는 없는 편이다, 성능은 크게 오르지 않고 개발속도는 느려진다</li></ul></li> <li><p>성능에 관심을 가지는 방식의 문제점 개선</p> <ul><li>개발 절차중 후기 단계에 있는 성능 최적화 전까지는 성능에 신경쓰지 않고 잘 쪼개진 방식의 프로그램을 제작하는 것</li> <li>성능 최적화 단계에서는 그 프로그램을 튜닝하는 절차를 따른다</li></ul></li></ul> <h2 id="code-smell"><a href="#code-smell" class="header-anchor">#</a> Code Smell</h2> <p>리팩토링이 필요하다고 판단되는 '의심되는 상황'이 code smell이다.
다음과 같은 상황에서 code smell이 존재한다고 볼 수 있다.</p> <h3 id="중복코드-duplicated-code"><a href="#중복코드-duplicated-code" class="header-anchor">#</a> 중복코드(Duplicated code)</h3> <p>가장 빈번하게 볼 수 있는 code smell이다</p> <ul><li>한 클래스의 두 메소드 안에 겹치는 코드가 들어있는 경우: <strong>메소드 추출</strong></li> <li>한 클래스의 두 하위클래스에 같은 코드가 들어있는 경우: <strong>메소드 추출</strong> &amp; <strong>메소드 상향</strong></li> <li>한 클래스의 두 하위클래스에 비슷한 코드가 들어있는 경우: <strong>메소드 추출</strong> &amp; <strong>템플릿 메소드 형성</strong></li> <li>두 메소드가 알고리즘만 다르고 기능이 같다면: <strong>알고리즘 전환</strong></li> <li>서로 상관없는 두 클래스 안에 중복코드 존재: <strong>클래스 추출</strong> or <strong>모듈 추출</strong></li></ul> <h3 id="장황한-메소드-long-method"><a href="#장황한-메소드-long-method" class="header-anchor">#</a> 장황한 메소드(Long method)</h3> <ul><li><p>주석을 달아야 할 것 같은 부분에 주석을 넣는 대신 메소드를 작성한다</p> <ul><li>메소드명은 기능 수행 방식이 아니라 목적을 나타내는 이름을 정한다</li> <li>메소드 호출이 원래 코드보다 길어지는 한이 있어도 메소드명은 그 코드의 의도를 잘 반영하는 것으로 정해야 한다</li></ul></li> <li><p>메소드를 줄이려면 대부분 <strong>메소드 추출</strong> 기법을 적용해야 한다</p> <ul><li>메소드에서 하나로 묶으면 좋을 만한 부분을 찾아내어 메소드로 만드는 것</li> <li>메소드에 매개변수와 임시변수가 많으면 <strong>메소드 추출</strong>이 까다롭다</li> <li><strong>임시변수를 메소드 호출로 전환</strong>하거나 <strong>임시변수를 메소드 체인으로 전환</strong>하면 임시변수를 제거할 수 있다</li> <li>매개변수는 <strong>매개변수 세트를 객체로 전환</strong>하거나 <strong>객체를 통째로 전달</strong>하면 간결해진다</li> <li>리팩토링을 적용했어도 임시변수와 매개변수가 너무 많다면 <strong>메소드를 메소드 객체로 전환</strong>하면 된다</li></ul></li> <li><p>조건문과 루프문도 메소드로 빼야 한다</p> <ul><li>조건문을 추출하려면 <strong>조건문 쪼개기</strong> 기법을 사용한다</li> <li><strong>루프를 컬렉션 클로저 메소드로 전환</strong>한 후, <strong>클로저 메소드 호출과 클로저 자체에 메소드 추출</strong>을 실시한다</li></ul></li></ul> <h3 id="거대한-클래스-large-class"><a href="#거대한-클래스-large-class" class="header-anchor">#</a> 거대한 클래스(Large class)</h3> <p>기능이 지나치게 많은 클래스에는 보통 엄청난 수의 인스턴스 변수가 들어있다.
클래스에 인스턴스 변수가 너무 많으면 중복 코드가 반드시 존재하기 마련이다.</p> <ul><li><p>인스턴스 변수가 너무 많은 클래스: <strong>클래스 추출</strong></p> <ul><li>서로 연관된 인스턴스 변수를 콜라서 클래스로 묶는다</li> <li>클래스 안의 일부 변수의 접두/접미사가 같다면 하나의 클래스로 추출할 것을 고려해봐야 한다</li> <li>하위클래스로 추출하는 것이 적합할 것 같다면 하위클래스 추출을 실시할 수도 있다</li> <li>추출할 클래스가 대리자로 부적절할 것 같다면 모듈 추출을 실시한다</li></ul></li> <li><p>코드 분량이 거대한 클래스</p> <ul><li>중복코드가 존재할 가능성이 크며, <strong>클래스 추출</strong>, <strong>모듈 추출</strong>, <strong>하위클래스 추출</strong>, <strong>인터페이스 추출</strong>등을 실시한다</li></ul></li> <li><p>방대한 클래스가 GUI 클래스인경우</p> <ul><li>데이터와 기능을 서로 다른 도메인 객체로 옮겨야 할 수 있다</li> <li>데이터와 기능을 분리하기 위해 일부 중복 데이터는 놔두고 싱크를 유지해야 할 수 있다</li> <li>이는 <strong>관측 데이터 복제 기법</strong>을 사용하면 된다</li></ul></li></ul> <h3 id="과다한-매개변수-long-parameter-list"><a href="#과다한-매개변수-long-parameter-list" class="header-anchor">#</a> 과다한 매개변수(Long parameter list)</h3> <p>매개변수 세트가 길면 서로 일관성이 없어지거나 사용이 불편해지고 지속적인 수정이 필요하다</p> <ul><li><p>객체지향이 아니라면</p> <ul><li>전역 데이터를 사용하지 않기 위해서 루틴에 필요한 모든 것을 매개변수로 전달한다</li></ul></li> <li><p>객체를 사용할 때는</p> <ul><li>메소드에 필요한 모든 데이터를 전달하는 것이 아니라 필요한 데이터를 가져올 수 있는 메소드만 전달하면 된다</li> <li>메소드가 필요로 하는 각종 데이터는 그 메소드가 속한 클래스에 들어있다</li></ul></li> <li><p><strong>매개변수 세트를 메소드로 전환</strong></p> <ul><li>이미 알고 있는 객체(인스턴스 변수/다른 매개변수)에 요청하여 한 매개변수에 들어 있는 데이터를 가져올 수 있을 때</li></ul></li> <li><p><strong>객체를 통째로 전달</strong></p> <ul><li>객체에 있는 데이터 세트를 가져온 후, 데이터 세트를 그 객체 자체로 전환할 때</li></ul></li> <li><p><strong>매개변수 세트를 객체로 전환</strong></p> <ul><li>여러 데이터 항목에 논리적 객체가 없다면</li></ul></li> <li><p>호출되는 객체가 호출 객체에 의존적일때</p> <ul><li>데이터를 개별적으로 빼서 매개변수로 전달하는 것이 바람직함</li></ul></li></ul> <h3 id="수정의-산발-divergent-change"><a href="#수정의-산발-divergent-change" class="header-anchor">#</a> 수정의 산발(Divergent change)</h3> <ul><li><p>한 클래스가 다양한 원인 때문에 다양한 방식으로 자주 수정될 때</p> <ul><li>클래스를 여러 개의 변형 객체로 분리하는 것이 좋다</li> <li>분리를 통해 각 객체는 한 종류의 수정에 의해서만 변경된다</li></ul></li> <li><p>특정 원인으로 인해 변하는 모든 부분을 찾은 후 <strong>클래스 추출</strong>을 적용한다</p></li></ul> <h3 id="기능의-산재-shotgun-surgery"><a href="#기능의-산재-shotgun-surgery" class="header-anchor">#</a> 기능의 산재(Shotgun surgery)</h3> <ul><li><p>기능의 산재는 수정의 산발과 반대의 상황이다</p></li> <li><p>수정할 때마다 여러 클래스에서 수많은 자잘한 부분을 고쳐야 할 때</p> <ul><li><strong>메소드 이동</strong>과 <strong>필드 이동</strong>을 적용하여 수정할 부분을 합친다</li> <li>기존의 클래스 중 적절한 병합 대상이 없다면 새 클래스를 만들어야 한다</li> <li><strong>클래스 내용 직접 삽입</strong>을 적용하여 별도 클래스에 분산되어 있던 모든기능을 한 곳으로 가져와도 된다</li></ul></li></ul> <h3 id="잘못된-소속-feature-envy"><a href="#잘못된-소속-feature-envy" class="header-anchor">#</a> 잘못된 소속(Feature envy)</h3> <ul><li><p>객체의 핵심은 데이터와 그 데이터에 사용되는 프로세스를 한 데 묶는 기술이란 점이다</p></li> <li><p>어떤 메소드가 자신이 속하지 않은 클래스에 더 많이 접근한다면 잘못된 소속의 문제가 발생한 것이다</p> <ul><li>다른 객체에 있는 여러 읽기 메소드를 호출한다면 <strong>메소드 이동</strong> 기법을 실시할 수 있다</li> <li>메소드의 일부만 소속이 잘못되었다면 <strong>메소드 추출</strong>을 적용한 뒤 <strong>메소드 이동</strong>을 적용할 수 있다</li></ul></li> <li><p>한 메소드가 여러 클래스에 들어있는 기능을 이용할 때</p> <ul><li>문제의 메소드가 접근하는 데이터가 어느 클래스에 제일 많이 들어있는지 파악하여 해당 클래스로 옮긴다</li> <li>그 전에 <strong>메소드 추출</strong>을 통해 메소드를 다른 클래스로 옮길 여러 부분으로 쪼개면 더 작업이 쉬워진다</li></ul></li> <li><p>strategy pattern, visitor pattern, self delegation pattern</p> <ul><li>기본 규칙은 함께 수정되는 것은 하나로 뭉치는 것이다</li> <li>해당 패턴들은 재정의가 필요한 일부기능을 따로 빼내서 기능을 수정하기 쉽게하는 대신 인다이렉션이 늘어난다</li></ul></li></ul> <h3 id="데이터-뭉치-data-clumps"><a href="#데이터-뭉치-data-clumps" class="header-anchor">#</a> 데이터 뭉치(Data clumps)</h3> <ul><li><p>몰려있는 데이터 뭉치는 객체로 만들어야 한다</p> <ul><li>두 클래스에 들어 있는 인스턴스 변수나 여러 메소드 시그니처에 들어있는 매개변수</li> <li>데이터 뭉치를 객체로 전환하려면 해당 필드를 대상으로 <strong>클래스 추출</strong> 기법을 적용한다</li> <li>그리고 나서 메소드 시그니처를 대상으로 <strong>매개변수 세트를 객체로 전환</strong> 기법과 <strong>객체를 통째로 전달</strong> 기법을 적용한다</li></ul></li> <li><p>새로생긴 객체의 속성들 중 일부만 이용하는 데이터뭉치라 해도 효과가 있다</p> <ul><li>둘 이상의 필드를 객체로 전환하면 코드 개선이 가능하다</li> <li>여러 데이터 값 중 하나를 삭제했을 때 나머지 데이터 값들이 제대로 돌아가야 한다</li> <li>객체로 전환하고 나면 전체적인 성능이 개선될 여지도 있다</li></ul></li></ul> <h3 id="강박적-기본-타입-사용-primitive-obsession"><a href="#강박적-기본-타입-사용-primitive-obsession" class="header-anchor">#</a> 강박적 기본 타입 사용(Primitive obsession)</h3> <p>프로그래밍 환경의 데이터는 기본타입과 레코드 타입이 있다. 레코드에는 항상 일정 양의 오버헤드가 따른다.</p> <ul><li><p>객체는 언어에 내장된 기본 타입과 구별하기 힘든 작은 클래스를 손쉽게 작성할 수 있다</p></li> <li><p>데이터 값을 객체로 전환</p> <ul><li>객체에 익숙하지 않다면 전화번호와 우편번호와 같은 특수 문자열 클래스 등의 사소한 작업에 작은 객체를 잘 사용하지 않으려는 경향이 있다</li> <li>데이터 값이 분류 부호일 때는 그 값이 기능에 영향을 주지 않는다면 <strong>분류부호를 열거 클래스로 전환</strong>하자</li> <li>조건문에 분류 부호가 사용될 때는 <strong>분류부호를 하위클래스로 전환</strong>하거나 <strong>분류부호를 상태/전략패턴으로 전환</strong> 기법을 적용하자</li></ul></li></ul> <h3 id="switch-문-switch-statement"><a href="#switch-문-switch-statement" class="header-anchor">#</a> Switch 문(Switch statement)</h3> <ul><li><p>객체지향 코드에서는 switch-case 문이 비교적 적게 사용된다</p> <ul><li>switch 문의 단점은 반드시 중복이 생긴다는 점이다</li> <li>이를 해결하기 위한 방법은 객체지향의 다형성을 이용하는 것이다</li></ul></li> <li><p>대부분의 switch문은 재정의로 바꿔야 한다</p> <ul><li>switch문에 사용되는 분류부호 값이 들어있는 메소드나 클래스가 있어야 한다</li> <li><strong>메소드 추출</strong>을 실시해서 switch문을 메소드로 빼낸 후 <strong>메소드 이동</strong>을 실시해서 클래스를 옮긴다</li> <li><strong>동시에 분류 부호를 하위클래스로 전환</strong>하거나 <strong>분류부호를 상태/전략 패턴으로 전환</strong>한다</li> <li>상속구조를 만들었다면 <strong>조건문을 재정의로 전환</strong>한다</li></ul></li> <li><p>하나의 메소드에 영향을 미치는 case문 수가 적다면</p> <ul><li>모든 case문을 수정할일이 없을 것 같으면 재정의로 전환하는것은 과하다</li> <li>그런경우 <strong>매개변수를 메소드로 변환</strong>하는 편이 낫다</li> <li>여러 case문 중 하나가 null인 경우 <strong>Null 검사를 널 객체에 위임</strong>해야 한다</li></ul></li></ul> <h3 id="평행-상속-계층-parallel-inheritance-hierarchies"><a href="#평행-상속-계층-parallel-inheritance-hierarchies" class="header-anchor">#</a> 평행 상속 계층(Parallel inheritance hierarchies)</h3> <ul><li><p>평행 상속 계층은 기능의 산재의 특수한 상황임</p> <ul><li>이 문제가 있다면 한 클래스의 하위 클래스를 만들 때마다 다른 클래스의 하위클래스도 만들어야 한다</li> <li>서로 다른 두 상속 계층의 클래스명 접두어가 같으면 이 문제를 의심할 수 있다</li></ul></li> <li><p>보통 한 상속계층의 인스턴스가 다른 상속 계층의 인스턴스를 참조하게 만들면 된다</p> <ul><li><strong>메소드 이동</strong>과 <strong>필드 이동</strong>을 실시하면 참조하는 클래스에 있는 계층이 제거된다</li></ul></li></ul> <h3 id="직무유기-클래스-lazy-class"><a href="#직무유기-클래스-lazy-class" class="header-anchor">#</a> 직무유기 클래스(Lazy class)</h3> <ul><li>하나의 클래스를 작성할 때 마다 유지관리 비용이 추가된다
<ul><li>비용대비 효율이 떨어지는 하위클래스나 모듈은 <strong>계층 병합</strong>을 실시하면 된다</li> <li>거의 쓸모 없는 구성요소에는 <strong>클래스 내용 직접 삽입</strong>이나 <strong>모듈 내용 직접 삽입</strong> 기법을 적용해야 한다</li></ul></li></ul> <h3 id="막연한-범용-코드-speculative-generality"><a href="#막연한-범용-코드-speculative-generality" class="header-anchor">#</a> 막연한 범용 코드(Speculative generality)</h3> <ul><li><p>조만간 필요할 것이란 생각에 아직은 필요없는 기능을 수행하고자 갖은 호출과 조건문을 넣으려는 경우</p> <ul><li>모든 경우가 활용될 경우 문제가 없겠지만, 그렇지 않다면 제거해야 한다</li> <li>별다른 기능이 없는 클래스나 모듈이 있다면 <strong>계층 병합</strong>을 실시</li> <li>불필요한 위임을 제거하려면 <strong>클래스 내용 직접 삽입</strong>을 실시</li> <li>메소드에 사용되지 않는 매개변수가 있으면 <strong>매개변수 제거</strong>를 실시</li> <li>메소드명이 이상하다면 <strong>메소드명 변경</strong> 실시</li></ul></li> <li><p>메소드나 클래스가 오직 테스트케이스에서만 사용된다면 유력한 용의자로 막연한 범용코드를 지목할 수 있다</p> <ul><li>해당 메소드나 클래스를 발견하면 그것과 그것을 실행하는 테스트케이스를 모두 삭제하자</li> <li>적절한 기능을 실행하는 테스트케이스용 헬퍼 메소드나 클래스는 삭제하지 않아도 된다</li></ul></li></ul> <h3 id="임시-필드-temporary-field"><a href="#임시-필드-temporary-field" class="header-anchor">#</a> 임시 필드(Temporary field)</h3> <ul><li>어떤 객체 안에 인스턴스 변수가 특정 상황에서만 할당되는 경우가 간혹 있다
<ul><li>임시 필드는 복잡한 알고리즘에 여러 변수를 사용해야 할때 자주 발생한다</li> <li>많은 매개변수를 전달하는 것을 꺼린 나머지 매개변수를 필드에 대입한다</li> <li>이럴 때는 인스턴스 변수와 그 변수를 사용하는 메소드 전부에 대해 <strong>클래스 추출</strong>을 적용한다</li></ul></li></ul> <h3 id="메시지-체인-message-chains"><a href="#메시지-체인-message-chains" class="header-anchor">#</a> 메시지 체인(Message chains)</h3> <ul><li><p>메시지 체인은 클라이언트가 한 객체에 다른 객체를 요청하면 다른 객체가 또다른 객체를 요청하는 식의 연쇄 요청을 말한다</p> <ul><li>메시지 체인은 수많은 코드행이 든 <code>getThis</code> 메소드나 임시변수 세트라고 봐도 된다</li> <li>호출 사이의 관계가 수정될 때마다 코드들도 모두 수정해야 한다</li></ul></li> <li><p>이런 경우 <strong>대리객체 은폐</strong>를 실시한다</p> <ul><li>원칙적으로 체인을 구성하는 모든 객체에 적용할 수 있지만 과잉 중개 메소드 문제가 발생할 수 있다</li> <li>결과 객체가 어느 대상에 사용되는지 알아내서 객체가 사용되는 코드 부분을 <strong>메소드 추출</strong>한다</li> <li>추출한 메소드를 <strong>메소드 이동</strong>을 통해 체인 아래로 밀어낼 수 있는지 확인한다</li></ul></li></ul> <h3 id="과잉-중개-메소드-middle-man"><a href="#과잉-중개-메소드-middle-man" class="header-anchor">#</a> 과잉 중개 메소드(Middle Man)</h3> <ul><li>캡슐화에는 대개 위임이 수반된다
<ul><li>위임이 지나치면 문제가 된다. 어떤 클래스의 인터페이스의 절반이상이 다른 클래스에 위임을 하고 있다면 문제이다</li> <li><strong>과잉 중개 메소드 제거</strong>를 실시하여 원리가 구현된 객체에 직접 접근할 수 있다</li> <li>일부 메소드에 별 기능이 없다면 <strong>메소드 내용 직접 삽입</strong>을 한다</li> <li>부수적인 기능이 있다면 <strong>위임을 상속으로 전환</strong> 기법을 실시한다</li></ul></li></ul> <h3 id="지나친-관여-inappropriate-intimacy"><a href="#지나친-관여-inappropriate-intimacy" class="header-anchor">#</a> 지나친 관여(Inappropriate intimacy)</h3> <ul><li><p>간혹 클래스끼리 관계가 지나치게 밀접한 경우</p> <ul><li>밀접한 클래스는 서로의 private을 알아내는데 지나친 노력을 기울일 때가 있다</li> <li>서로 지나치게 관여하는 클래스는 <strong>메소드 이동</strong>과 <strong>필드 이동</strong>으로 분리해야 한다</li></ul></li> <li><p><strong>클래스의 양방향 연결을 단방향으로 전환</strong> 기법을 적용할 수 있으면</p> <ul><li>해당 클래스들이 공통으로 필요로하는 부분이 있따면 <strong>클래스 추출</strong>을 실시하여 별도의 클래스로 빼낸다</li> <li>혹은 <strong>대리 객체 은폐</strong>를 실시하여 다른 클래스가 중개 메소드 역할을 하게 한다</li></ul></li> <li><p>상속으로 인해 지나친 관여가 발생하는 경우가 많다</p> <ul><li>하위 클래스는 항상 상위 클래스가 공개하는 것보다 많은 데이터를 필요로 한다</li> <li>상위 클래스에서 하위 클래스를 빼내는 경우 <strong>상속을 위임으로 전환</strong> 기법을 사용한다</li></ul></li></ul> <h3 id="인터페이스가-다른-대용-클래스-alternative-classes-with-different-interfaces"><a href="#인터페이스가-다른-대용-클래스-alternative-classes-with-different-interfaces" class="header-anchor">#</a> 인터페이스가 다른 대용 클래스(Alternative classes with different interfaces)</h3> <ul><li>기능은 같은데 시그니처가 다른 메소드
<ul><li><strong>메소드명 변경</strong>을 실시해야 한다</li> <li>클래스에 충분한 기능이 구현되어 있지 않기 때문에 프로토콜이 같아질 때까지 <strong>메소드 이동</strong>을 실시해야 한다</li> <li>코드를 너무 여러 번 옮겨야 한다면 <strong>상위클래스 추출</strong>을 실시한다</li></ul></li></ul> <h3 id="미흡한-라이브러리-클래스-incomplete-library-class"><a href="#미흡한-라이브러리-클래스-incomplete-library-class" class="header-anchor">#</a> 미흡한 라이브러리 클래스(Incomplete library class)</h3> <ul><li><p>재사용을 객체의 목적이라 생각하는 것은 재사용을 과대평가한 것</p></li> <li><p>라이브러리 제작자라 해도 모든 설계를 파악한다는 것은 거의 불가능하다</p> <ul><li>라이브러리 클래스에게 원하는 기능을 수정하도록 수정하는 것이 보통은 불가능하다</li> <li>이 경우 메소드 이동같은 방법이 무용지물이 된다</li> <li>라이브러리 클래스에 넣어야 할 메소드가 적다면 외래 클래스에 <strong>메소드 추가</strong> 기법을 사용한다</li> <li>추가할 기능이 많다면 <strong>국소적 상속확장 클래스 사용</strong>기법을 사용한다</li></ul></li></ul> <h3 id="데이터-클래스-data-class"><a href="#데이터-클래스-data-class" class="header-anchor">#</a> 데이터 클래스(Data class)</h3> <ul><li><p>데이터 클래스는 필드와 필드 읽기/쓰기 메소드만 들어있는 클래스다</p> <ul><li>해당 클래스는 데이터 보관만 담당한다</li> <li>구체적인 데이터 조작은 다른 클래스가 수행한다</li> <li>필드는 <strong>필드 캡슐화</strong> 기법을 실시한다</li> <li>컬렉션 필드는 <strong>컬렉션 캡슐화</strong> 기법을 적용한다</li> <li>변경되지 않아야 하는 필드에는 <strong>쓰기 메소드 제거</strong>를 적용한다</li></ul></li> <li><p>읽기/쓰기 메소드가 다른 클래스에 의해 사용되는 부분을 찾는다</p> <ul><li>다른 클래스의 해당 부분을 데이터 클래스로 <strong>메소드 이동</strong>을 실시한다</li> <li>메소드 전체를 옮길 수 없다면 <strong>메소드 추출</strong>을 실시하고, 읽기/쓰기 메소드에 <strong>메소드 은폐</strong>를 적용한다</li></ul></li></ul> <h3 id="방치된-상속물-refused-bequest"><a href="#방치된-상속물-refused-bequest" class="header-anchor">#</a> 방치된 상속물(Refused Bequest)</h3> <ul><li><p>하위클래스가 상속받은 부모 클래스의 메소드와 데이터중 더이상 쓰이지 않거나 필요없는 경우</p></li> <li><p>잘못된 계층구조로 인하여 발생한 경우에는</p> <ul><li>새로운 대등 클래스를 작성한다</li> <li><strong>메소드 하향</strong>과 <strong>필드 하향</strong>을 실시해서 사용되지 않는 메소드를 대등한 클래스에 몰아넣어야 한다</li></ul></li> <li><p>방치된 상속물을 반드시 처리해야 하는 것은 아니다</p> <ul><li>일부기능을 재사용하고자 하위 클래스로 몰아넣는 작업은 효과적일 수 있다</li> <li>이 문제는 심각하지 않은 경우가 대부분이므로 리팩토링이 별로 필요하지 않을 수 있다</li></ul></li> <li><p>하위클래스가 기능은 재사용하지만 상위클래스의 인터페이스를 지원하지 않을 때</p> <ul><li>상속 구현을 거부할 수는 있지만 인터페이스를 거부하는 것은 문제임</li> <li><strong>상속을 위임으로 전환</strong> 기법을 적용해서 계층 구조를 없애야 한다</li></ul></li></ul> <h3 id="불필요한-주석-comments"><a href="#불필요한-주석-comments" class="header-anchor">#</a> 불필요한 주석(Comments)</h3> <ul><li>어떤 코드 구간의 기능을 설명할 주석이 필요한 경우 <strong>메소드 추출</strong> 실시</li> <li>메소드가 추출된 상태임에도 기능을 설명할 주석이 필요하다면 <strong>메소드명 변경</strong>을 실시</li> <li>시스템에 필수적인 상태에 관한 규칙을 설명해야 할때는 <strong>Assertion 넣기</strong>를 실시</li> <li>주석은 무슨 작업을 해야 좋을지 모를때만 넣는것이 좋다</li></ul> <h2 id="테스트작성"><a href="#테스트작성" class="header-anchor">#</a> 테스트작성</h2> <p>리팩토링을 실시하기 위한 필수 전제조건은 반드시 견고한 테스트를 해야 한다는 것이다.</p> <h3 id="자가-테스트-코드의-가치"><a href="#자가-테스트-코드의-가치" class="header-anchor">#</a> 자가 테스트 코드의 가치</h3> <p>자가 테스트 코드를 작성하지 않으면 작업을 파악하거나 설계하는 시간에 비해 디버깅 시간이 길었다.
일반적으로 테스트를 작성하면 훨씬 시간이 절약된다.</p> <p>테스트를 작성하기 가장 적합한 시점 중 하나는 프로그래밍을 시작할 때다.</p> <p>기능을 추가해야 할 때는 우선 테스트부터 작성하자.
테스트를 작성하면 그 기능을 추가하려고 해야 할 작업이 무엇인지 자문하게 된다.
그리고 테스트를 작성하면 구현부가 아니라 인터페이스에 집중하게 된다.</p> <h3 id="테스트-추가"><a href="#테스트-추가" class="header-anchor">#</a> 테스트 추가</h3> <p>모든 public 메소드를 테스트 할 수도 있지만, 위험 위주로 테스트를 작성할 수도 있다.</p> <p>현재나 미래에 버그를 찾을 곳에서 테스트를 하며, 읽고 쓰는 기능뿐인 메소드는 테스트 하지 않을 수 있다.</p> <p>너무 많은 테스트를 작성하려다 보면 오히려 질려서 테스트를 필요한 만크도 작성하지 못하게 되므로,
버그 가능성이 거의 없는 부분은 애시장초 테스트 작성 대상에서 제외시키는게 나을 수 있다.</p> <p>테스트에서 가장 힘든 일은 경계 조건을 찾는 것이다.
경계찾기에는 테스트를 실패하게 할 가능성이 있는 특수조건을 찾는 작업도 포함이된다.</p> <p>테스트를 실시할 때는 반드시 예상한 에러가 제대로 발생하는지 검사해야 한다.</p> <h2 id="메소드-정리"><a href="#메소드-정리" class="header-anchor">#</a> 메소드 정리</h2> <p>리팩토링의 주된 작업은 메소드를 적절히 정리하는 것이다. 거의 모든 문제점은 장황한 메소드로 인해 생긴다.</p> <h3 id="메소드-추출"><a href="#메소드-추출" class="header-anchor">#</a> 메소드 추출</h3> <blockquote><p>Extract Method</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">printOwing</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span> <span class="token operator">+</span> _name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;amount&quot;</span> <span class="token operator">+</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>메소드 추출을 적용하면</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">printOwing</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printDetails</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">printDetails</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span> <span class="token operator">+</span> _name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;amount&quot;</span> <span class="token operator">+</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="메소드-추출-동기"><a href="#메소드-추출-동기" class="header-anchor">#</a> 메소드 추출: 동기</h4> <ul><li><p>메소드가 너무 길거나 코드에 주석을 달아야만 의도를 이해할 수 있을 때</p> <ul><li>메소드가 적절히 잘게 쪼개져 있으면 다른 메소드에서 쉽게 사용할 수 있다</li> <li>상위계층의 메소드에서 메소드 이름으로 더 많은 정보를 읽어들일 수 있다</li> <li>재정의하기도 훨씬 수월하다</li></ul></li> <li><p>메소드 내용이 간결한 것도 중요하지만, 메소드 이름도 잘 지어야 한다</p> <ul><li>메소드 추출로 코드의 명료성이 향상된다면 메소드명이 추출한 코드보다 길어도 추출을 실시해야 한다</li></ul></li></ul> <h4 id="메소드-추출-방법"><a href="#메소드-추출-방법" class="header-anchor">#</a> 메소드 추출: 방법</h4> <ul><li>기존 메소드에서 추출할 코드를 새로운 메소드로 이동시킨다</li> <li>옮긴 코드에서 기존 메소드의 모든 지역변수 참조를 찾아, 새로 생성한 메소드의 지역변수나 매개변수로 만든다</li> <li>추출 코드에 의해 변경되는 지역변수를 파악하여 처리한다</li> <li>생성한 코드에서 사용하는 지역변수를 대상 메소드에 매개변수로 전달한다</li> <li>둘 이상의 변수를 반환해야 할 때
<ul><li>최선의 방법은 각기 다른 값을 하나씩 반환하는 여러개의 메소드를 만드는 방법이다.</li> <li>자신이 사용하는 언어가 출력 매개변수 기능이 있다면 출력 매개변수를 사용해도 된다.</li></ul></li> <li>테스트를 실시한다</li></ul> <h3 id="메소드-내용-직접-삽입"><a href="#메소드-내용-직접-삽입" class="header-anchor">#</a> 메소드 내용 직접 삽입</h3> <blockquote><p>Inline Method</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">getRating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">moreThanFiveLateDeliveries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">boolean</span> <span class="token function">moreThanFiveLateDeliveries</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _numberOfLateDeliveries <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>메소드 내용 직접 삽입을 적용하면</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">getRating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>_numberOfLateDeliveries <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="메소드-내용-직접-삽입-동기"><a href="#메소드-내용-직접-삽입-동기" class="header-anchor">#</a> 메소드 내용 직접 삽입: 동기</h4> <ul><li>간혹 메소드명에 모든 기능이 반영될 정도로 지나치게 단순한 경우 해당 메소드를 없애야 한다</li> <li>잘못 쪼개진 메소드의 내용을 하나의 큰 메소드에 직접 삽입 후, 합쳐진 메소드를 다시 각각 작은 메소드로 추출한다</li> <li>과다한 인다이렉션과 동시에 모든 메소드가 다른 메소드에 단순 위임을 하고 있어 코드가 지나치게 복잡할 때 실시한다</li></ul> <h4 id="메소드-내용-직접-삽입-방법"><a href="#메소드-내용-직접-삽입-방법" class="header-anchor">#</a> 메소드 내용 직접 삽입: 방법</h4> <ul><li>메소드가 재정의되어 있지 않은지 확인한다(재정의 되어 있다면 실시X)</li> <li>해당 메소드를 호출하는 부분을 모두 찾는다</li> <li>각 호출 부분을 메소드 내용으로 교체한다</li> <li>테스트를 실시한다</li></ul> <h3 id="임시변수-내용-직접-삽입"><a href="#임시변수-내용-직접-삽입" class="header-anchor">#</a> 임시변수 내용 직접 삽입</h3> <blockquote><p>Inline Temp</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">double</span> basePrice <span class="token operator">=</span> anOrder<span class="token punctuation">.</span><span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>basePrice <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>임시변수 내용 직접 삽입을 적용하면</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">return</span> <span class="token punctuation">(</span>anOrder<span class="token punctuation">.</span><span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="임시변수-내용-직접-삽입-동기"><a href="#임시변수-내용-직접-삽입-동기" class="header-anchor">#</a> 임시변수 내용 직접 삽입: 동기</h4> <ul><li>임시변수 내용 직접 삽입은 임시변수를 메소드 호출로 전환을 실시하는 도중에 병용하게 되는 경우가 많음</li> <li>메소드 호출의 결과가 임시변수에 대입될 때, 임시변수가 다른 리팩토링에 방해가 되면 내용 직접삽입을 한다</li></ul> <h4 id="임시변수-내용-직접-삽입-방법"><a href="#임시변수-내용-직접-삽입-방법" class="header-anchor">#</a> 임시변수 내용 직접 삽입: 방법</h4> <ul><li>대입문의 우변에 문제가 없는지 확인</li> <li>문제가 없다면 임시변수를 <code>final</code>로 선언하고 확인해보자</li> <li>임시변수를 참조하는 모든 부분을 찾아서 대입문 우변의 수식으로 바꾸자</li> <li>하나씩 수정할 때마다 테스트를 실시한다</li></ul> <h3 id="임시변수를-메소드-호출로-전환-replace-temp-with-query"><a href="#임시변수를-메소드-호출로-전환-replace-temp-with-query" class="header-anchor">#</a> 임시변수를 메소드 호출로 전환(Replace Temp with Query)</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">double</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> basePrice <span class="token operator">=</span> _quantity <span class="token operator">*</span> _itemPrice<span class="token punctuation">;</span>
  <span class="token keyword">double</span> discountFactor<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>basePrice <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    discountFactor <span class="token operator">=</span> <span class="token number">0.95</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    discountFactor <span class="token operator">=</span> <span class="token number">0.98</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> basePrice <span class="token operator">*</span> discountFactor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>임시변수를 메소드 호출로 전환을 적용하면</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">double</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">discountFactor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>

<span class="token keyword">double</span> <span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _quantity <span class="token operator">*</span> _itemPrice<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">double</span> <span class="token function">discountFactor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">basePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0.95</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0.98</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="임시변수를-메소드-호출로-전환-동기"><a href="#임시변수를-메소드-호출로-전환-동기" class="header-anchor">#</a> 임시변수를 메소드 호출로 전환: 동기</h4> <ul><li>임시변수는 일시적이고 국소 범위로 제한된다</li> <li>임시변수를 메소드 호출로 수정하면 클래스 안 모든 메소드가 그 정보에 접근할 수 있다</li> <li>임시변수를 메소드 호출로 전환은 대부분의 경우 메소드 추출을 적용하기 전에 반드시 적용해야 한다</li> <li>지역변수가 많을 수록 메소드 추출이 힘들어진다</li></ul> <h4 id="임시변수를-메소드-호출로-전환-방법"><a href="#임시변수를-메소드-호출로-전환-방법" class="header-anchor">#</a> 임시변수를 메소드 호출로 전환: 방법</h4> <ul><li>값이 한번만 대입되는 임시변수를 찾는다</li> <li>값이 여러번 대입되는 임시변수는 임시변수 분리 기법을 실시한다</li> <li>임시변수를 final로 선언한다</li> <li>대입문 우변을 분리하여 private 메소드로 만든다</li> <li>만약 메소드가 객체변경등을 한다면 상태 변경메소드와 값 반환 메소드를 분리한다</li> <li>임시변수를 대상으로 임시변수 내용 직접 삽입을 실시한다</li> <li>테스트를 실시한다</li></ul> <h3 id="직관적-임시변수-사용"><a href="#직관적-임시변수-사용" class="header-anchor">#</a> 직관적 임시변수 사용</h3> <blockquote><p>Introduce Explaining Variable</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>platform<span class="token punctuation">.</span><span class="token function">toUpeerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;MAC&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
    <span class="token punctuation">(</span>browser<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;IE&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
    <span class="token function">wasInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> resize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>직관적 임시변수 사용 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">boolean</span> isMacOs <span class="token operator">=</span> platform<span class="token punctuation">.</span><span class="token function">toUpeerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;MAC&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token keyword">boolean</span> isIEBrowser <span class="token operator">=</span> browser<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;IE&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token keyword">boolean</span> wasResized <span class="token operator">=</span> resize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>isMacOs <span class="token operator">&amp;&amp;</span> isIEBrowser <span class="token operator">&amp;&amp;</span> <span class="token function">wasInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> wasResized<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="직관적-임시변수-사용-동기"><a href="#직관적-임시변수-사용-동기" class="header-anchor">#</a> 직관적 임시변수 사용: 동기</h4> <ul><li>수식이 너무 복잡해져 이해하기 어려운 경우 임시변수를 사용하여 수식을 쪼갤 수 있다</li> <li>직관적 임시변수 사용은 조건문에서 각 조건절을 가져와서 직관적 이름의 임시변수로 의미를 설명할 때 사용한다</li> <li>직관적 임시변수 사용보다는 메소드추출을 우선 고려하는 것이 좋다
<ul><li>임시변수는 하나의 지역내에서만 사용할 수 있기 때문이다</li> <li>하지만 지역변수로 인해 메소드추출을 적용하기 힘들다면 임시변수 사용 기법을 활용한다</li></ul></li> <li>나중에 코드나 로직의 복잡함이 덜해지면 임시변수를 메소드 호출로 전환 기법을 적용한다</li></ul> <h4 id="직관적-임시변수-사용-방법"><a href="#직관적-임시변수-사용-방법" class="header-anchor">#</a> 직관적 임시변수 사용: 방법</h4> <ul><li>임시변수를 final로 선언하고 복잡한 수식에서 한 부분의 결과를 그 임시변수에 대입</li> <li>수식에서 한 부분의 결과를 임시변수의 값으로 교체한다(여러개가 있어도 순차적으로 진행한다)</li> <li>테스트를 실시한다</li></ul> <h3 id="임시변수-분리"><a href="#임시변수-분리" class="header-anchor">#</a> 임시변수 분리</h3> <blockquote><p>Split Temporary Variable</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">double</span> temp <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>_height <span class="token operator">+</span> _width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
temp <span class="token operator">=</span> _height <span class="token operator">*</span> _width<span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>임시변수 분리 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">double</span> perimeter <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>_height <span class="token operator">+</span> _width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>perimeter<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token keyword">double</span> area <span class="token operator">=</span> _height <span class="token operator">*</span> _width<span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="임시변수-분리-동기"><a href="#임시변수-분리-동기" class="header-anchor">#</a> 임시변수 분리: 동기</h4> <ul><li>임시변수를 사용하다보면 임시변수에 값이 여러번 대입될 경우가 있다</li> <li>많은 임시변수는 긴 코드의 계산 결과를 나중에 간편히 참조할 수 있게 하는 용도로 사용된다</li> <li>이런 변수에는 값이 한 번만 대입되어야 한다
<ul><li>값이 두 번 이상 대입된다는 것은 변수가 메소드 안에서 여러 용도로 사용된다는 반증이다</li> <li>임시변수 하나를 여러 용도로 사용하면 코드분석시 혼란을 줄 수 있다</li></ul></li></ul> <h4 id="임시변수-분리-방법"><a href="#임시변수-분리-방법" class="header-anchor">#</a> 임시변수 분리: 방법</h4> <ul><li>선언문과 첫 번째 대입문에 있는 임시변수 이름을 변경한다(값 누적용 임시변수는 분리하지 않는다)</li> <li>이름을 바꾼 새 임시변수를 final로 선언한다</li> <li>임시변수의 다음 대입문 전 범위의 임시변수 참조를 모두 수정한다</li> <li>두 번째 대입문에 있는 임시변수를 선언한다</li> <li>임시변수마다 차례대로 수정한다</li> <li>테스트를 실시한다</li></ul> <h3 id="매개변수로의-값-대입-제거"><a href="#매개변수로의-값-대입-제거" class="header-anchor">#</a> 매개변수로의 값 대입 제거</h3> <blockquote><p>Remove Assignments to Parameters</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">discount</span><span class="token punctuation">(</span><span class="token keyword">int</span> inputVal<span class="token punctuation">,</span> <span class="token keyword">int</span> quantity<span class="token punctuation">,</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>inputVal <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">)</span> inputVal <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>매개변수로의 값 대입 제거 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">discount</span><span class="token punctuation">(</span><span class="token keyword">int</span> inputVal<span class="token punctuation">,</span> <span class="token keyword">int</span> quantity<span class="token punctuation">,</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> result <span class="token operator">=</span> inputVal<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">)</span> result <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="매개변수로의-값-대입-제거-동기"><a href="#매개변수로의-값-대입-제거-동기" class="header-anchor">#</a> 매개변수로의 값 대입 제거: 동기</h4> <ul><li><p>전달받은 매개변수에 다른 객체 참조를 대입할 때의 문제</p> <ul><li>코드의 명료성이 떨어진다</li> <li>값을 통한 전달과 참조를 통한 전달을 혼동하게 된다 (자바는 값을 통한 전달만 사용한다)</li></ul></li> <li><p>매개변수로의 값 대입 제거 규칙은 출력 매개변수가 사용되는 다른언어에서는 사용하지 않아도 된다</p> <ul><li>그러나 출력 매개변수는 가능하면 적게 사용하는 것이 좋다</li></ul></li></ul> <h4 id="매개변수로의-값-대입-제거-방법"><a href="#매개변수로의-값-대입-제거-방법" class="header-anchor">#</a> 매개변수로의 값 대입 제거: 방법</h4> <ul><li>매개변수 대신 사용할 임시변수를 선언한다</li> <li>매개변수로 값을 대입하는 코드 뒤에 나오는 매개변수 참조를 모두 임시변수로 수정한다</li> <li>매개변수로의 값 대입을 임시변수로의 값 대입으로 수정한다</li> <li>테스트를 실시한다</li></ul> <h3 id="메소드를-메소드-객체로-전환"><a href="#메소드를-메소드-객체로-전환" class="header-anchor">#</a> 메소드를 메소드 객체로 전환</h3> <blockquote><p>Replace Method with Method Object</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> <span class="token function">gamma</span><span class="token punctuation">(</span><span class="token keyword">int</span> inputVal<span class="token punctuation">,</span> <span class="token keyword">int</span> quantity<span class="token punctuation">,</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> importantValue1 <span class="token operator">=</span> <span class="token punctuation">(</span>inputVal <span class="token operator">*</span> quantity<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">delta</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> importantValue2 <span class="token operator">=</span> <span class="token punctuation">(</span>inputVal <span class="token operator">*</span> yearToDate<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>yearToDate <span class="token operator">-</span> importantValue1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      importantValue2 <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> importantValue3 <span class="token operator">=</span> importantValue2 <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> importantValue3 <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> importantValue1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>메소드를 메소드 객체로 전환 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Gamma</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Account</span> account<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> inputVal<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> quantity<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> importantValue1<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> importantValue2<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> importantValue3<span class="token punctuation">;</span>

  <span class="token class-name">Gamma</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">,</span> <span class="token keyword">int</span> inputVal<span class="token punctuation">,</span> <span class="token keyword">int</span> quantity<span class="token punctuation">,</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>account <span class="token operator">=</span> account<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>inputVal <span class="token operator">=</span> inputVal<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>quantity <span class="token operator">=</span> quantity<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>yearToDate <span class="token operator">=</span> yearToDate<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">int</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    importantValue1 <span class="token operator">=</span> <span class="token punctuation">(</span>inputVal <span class="token operator">*</span> quantity<span class="token punctuation">)</span> <span class="token operator">+</span> account<span class="token punctuation">.</span><span class="token function">delta</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    importantValue2 <span class="token operator">=</span> <span class="token punctuation">(</span>inputVal <span class="token operator">*</span> yearToDate<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token comment">// 아래의 계산에 메소드 추출을 적용할 수 있다!!</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>yearToDate <span class="token operator">-</span> importantValue1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      importantValue2 <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    importantValue3 <span class="token operator">=</span> importantValue2 <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> importantValue3 <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> importantValue1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> <span class="token function">gamma</span><span class="token punctuation">(</span><span class="token keyword">int</span> inputVal<span class="token punctuation">,</span> <span class="token keyword">int</span> quantity<span class="token punctuation">,</span> <span class="token keyword">int</span> yearToDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Gamma</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> inputVal<span class="token punctuation">,</span> quantity<span class="token punctuation">,</span> yearToDate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h4 id="메소드를-메소드-객체로-전환-동기"><a href="#메소드를-메소드-객체로-전환-동기" class="header-anchor">#</a> 메소드를 메소드 객체로 전환: 동기</h4> <ul><li><p>메소드 분해를 어렵게 많드는 것은 지역변수이다</p> <ul><li>임시변수를 메소드 호출로 전환하면 어려움이 어느정도 해소된다</li></ul></li> <li><p>메소드를 메소드 객체로 전환을 적용하면</p> <ul><li>모든 지역변수가 메소드 객체의 속성이된다</li> <li>그 객체에 메소드 추출을 적용해서 원래의 메소드를 쪼개어 여러개의 추가 메소드를 만든다</li></ul></li></ul> <h4 id="메소드를-메소드-객체로-전환-방법"><a href="#메소드를-메소드-객체로-전환-방법" class="header-anchor">#</a> 메소드를 메소드 객체로 전환: 방법</h4> <ul><li>전환할 메소드의 이름과 같은 이름으로 새 클래스를 생성한다</li> <li>클래스에 원본 메소드가 들어있던 객체를 나타내는 final 필드를 추가한다</li> <li>final 필드는 원본 메소드안의 각 임시변수와 매개변수에 해당하는 속성이다</li> <li>새 클래스에 원본 객체와 각 매개변수를 받는 생성자 메소드를 작성한다</li> <li>새 클래스에 compute라는 이름의 메소드를 작성한다</li> <li>원본 메소드 내용을 compute 메소드 안에 복사해넣는다</li> <li>원본 객체에 있는 메소드 호출시 원본 객체를 나타내는 필드를 사용한다</li> <li>테스트를 실시한다</li></ul> <h3 id="알고리즘-전환"><a href="#알고리즘-전환" class="header-anchor">#</a> 알고리즘 전환</h3> <blockquote><p>Substitute Algorithm</p></blockquote> <h4 id="알고리즘-전환-동기"><a href="#알고리즘-전환-동기" class="header-anchor">#</a> 알고리즘 전환: 동기</h4> <ul><li>기능을 수행하기 위한 비교적 간단한 방법이 있다면 복잡한 방법을 좀 더 간단한 방법으로 교체해야 한다</li> <li>문제를 해결해나가다 더 간단한 방법이 있음을 발견하면 알고리즘을 교체해야 하는 상황이다</li> <li>알고리즘 교체를 위해서는 메소드를 최대한 잘게 쪼개야 한다</li></ul> <h4 id="알고리즘-전환-방법"><a href="#알고리즘-전환-방법" class="header-anchor">#</a> 알고리즘 전환: 방법</h4> <ul><li>교체할 간결한 알고리즘을 준비한다</li> <li>새 알고리즘을 실행하면서 여러 번의 테스트를 실시한다</li></ul> <h2 id="객체-간의-기능-이동"><a href="#객체-간의-기능-이동" class="header-anchor">#</a> 객체 간의 기능 이동</h2> <h3 id="메소드-이동"><a href="#메소드-이동" class="header-anchor">#</a> 메소드 이동</h3> <blockquote><p>Move Method</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">AccountType</span> type<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> daysOverdrawn<span class="token punctuation">;</span>

  <span class="token keyword">double</span> <span class="token function">overdraftCharge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">isPremium</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>daysOverdrawn <span class="token operator">&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">+=</span> <span class="token punctuation">(</span>daysOverdrawn <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.85</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> daysOverdrawn <span class="token operator">*</span> <span class="token number">1.75</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">double</span> <span class="token function">bankCharge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">4.5</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>daysOverdrawn <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">+=</span> <span class="token function">overdraftCharge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>객체 간의 기능 이동 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">AccountType</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> <span class="token function">overdraftCharge</span><span class="token punctuation">(</span><span class="token keyword">int</span> daysOverdrawn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPremium</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>daysOverdrawn <span class="token operator">&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">+=</span> <span class="token punctuation">(</span>daysOverdrawn <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.85</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> daysOverdrawn <span class="token operator">*</span> <span class="token number">1.75</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">AccountType</span> type<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> daysOverdrawn<span class="token punctuation">;</span>

  <span class="token comment">// 메소드는 위임으로 변경한거나 삭제한다</span>
  <span class="token keyword">double</span> <span class="token function">overdraftCharge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> type<span class="token punctuation">.</span><span class="token function">overdraftCharge</span><span class="token punctuation">(</span>daysOverdrawn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">double</span> <span class="token function">bankCharge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">4.5</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>daysOverdrawn <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">+=</span> <span class="token function">overdraftCharge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="메소드-이동-동기"><a href="#메소드-이동-동기" class="header-anchor">#</a> 메소드 이동: 동기</h4> <ul><li>클래스에 기능이 너무 많거나 클래스가 다른 클래스와 과하게 연동되어 의존성이 지나친 경우 메소드를 옮기는 것이 좋다</li> <li>자신이 속한 객체보다 다른 객체를 더 많이 참조하는 것 같은 메소드를 찾는다
<ul><li>그 메소드를 호출하는 메소드, 그 메소드가 호출하는 메소드, 상속계층에서 재정의 메소드를 확인한다</li> <li>옮기려는 메소드가 더 많이 참조한다고 보이는 메소드가 들어있는 객체를 기준으로 진행여부를 판단한다</li></ul></li></ul> <h4 id="메소드-이동-방법"><a href="#메소드-이동-방법" class="header-anchor">#</a> 메소드 이동: 방법</h4> <ul><li>원본 메소드에서 사용한 기능 중 원본 클래스에 정의되어 있는 기능을 확인한다
<ul><li>원본 메소드에서만 사용하는 기능이라면 그 메소드와 함께 옮겨야 한다</li> <li>그 기능이 다른 메소드에서도 사용된다면 또 다른 메소드도 옮길지를 확인해보자</li></ul></li> <li>원본 클래스의 하위 클래스와 상위 클래스에서 그 메소드에 대한 다른 선언이 있는지를 검사한다</li> <li>원본 메소드를 대상 클래스 안에 선언한다</li> <li>원본 메소드의 코드를 대상 메소드에 복사한 후 대상 클래스에 맞춰 수정한다</li> <li>원본 객체에서 대상 객체를 참조할 방법을 정한다</li> <li>원본 메소드를 위임 메소드로 전환하거나 삭제한다</li> <li>테스트를 실시한다</li></ul> <h3 id="필드-이동"><a href="#필드-이동" class="header-anchor">#</a> 필드 이동</h3> <blockquote><p>Move Field</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">AccountType</span> type<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> interestRate<span class="token punctuation">;</span>

  <span class="token keyword">double</span> <span class="token function">interestForAmountDays</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">,</span> <span class="token keyword">int</span> days<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> interestRate <span class="token operator">*</span> amount <span class="token operator">*</span> days <span class="token operator">/</span> <span class="token number">365</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>필드 이동 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">AccountType</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> interestRate<span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">getInterestRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> interestRate<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">setInterestRate</span><span class="token punctuation">(</span><span class="token keyword">double</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    interestRate <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">AccountType</span> type<span class="token punctuation">;</span>

  <span class="token keyword">double</span> <span class="token function">interestForAmountDays</span><span class="token punctuation">(</span><span class="token keyword">double</span> amount<span class="token punctuation">,</span> <span class="token keyword">int</span> days<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> type<span class="token punctuation">.</span><span class="token function">getInterestRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> amount <span class="token operator">*</span> days <span class="token operator">/</span> <span class="token number">365</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="필드-이동-동기"><a href="#필드-이동-동기" class="header-anchor">#</a> 필드 이동: 동기</h4> <ul><li>어떤 필드가 자신이 속한 클래스보다 다른 클래스에 있는 메소드를 더 많이 참조할 때
<ul><li>필드를 해당 클래스로 옮기는 것을 고려한다</li> <li>인터페이스에 따라 메소드를 옮길수도 있지만, 메소드의 위치가 적절하다고 판단되면 필드를 옮긴다</li></ul></li> <li>클래스 추출을 실시하는 중에서 필드 이동이 수반된다. 이 경우 필드가 판단 기준에서 우선한다.</li></ul> <h4 id="필드-이동-방법"><a href="#필드-이동-방법" class="header-anchor">#</a> 필드 이동: 방법</h4> <ul><li>필드가 public이면 필드 캡슐화 기법을 실시한다</li> <li>대상 클래스 안에 읽기/쓰기 메소드와 함께 필드를 작성한다</li> <li>원본 객체에서 대상 객체를 참조할 방법을 정한다
<ul><li>기존 필드나 메소드에 대상 클래스를 참조하는 기능이 있을 수도 있다</li> <li>기존 기능이 없다면 얼마나 간편히 그런 기능의 메소드를 작성할 수 있는지 확인한다</li></ul></li> <li>원본 클래스에서 필드를 삭제한다</li> <li>원본 필드를 참조하는 모든 부분을 대상 클래스에 있는 적절한 메소드를 참조하도록 수정한다
<ul><li>변수 접근 참조는 대상객체의 getter 메소드로 대입 참조 부분은 setter 메소드 호출로 수정한다</li></ul></li> <li>테스트를 실시한다</li></ul> <h3 id="클래스-추출"><a href="#클래스-추출" class="header-anchor">#</a> 클래스 추출</h3> <blockquote><p>Extract Class</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> officeAreaCode<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> officeNumber<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTelephoneNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> officeAreaCode <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">+</span> officeNumber<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">String</span> <span class="token function">getOfficeAreaCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> officeAreaCode<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">setOfficeAreaCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    officeAreaCode <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">String</span> <span class="token function">getOfficeNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> officeNumber<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">setOfficeNumber</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    officeNumber <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>클래스 추출 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">TelephoneNumber</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> areaCode<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTelephoneNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> areaCode <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">+</span> number<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">String</span> <span class="token function">getAreaCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> areaCode<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">setAreaCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    areaCode <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">String</span> <span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> number<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    number <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">TelephoneNumber</span> officeTelephone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TelephoneNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTelephoneNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> officeTelephone<span class="token punctuation">.</span><span class="token function">getTelephoneNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">TelephoneNumber</span> <span class="token function">getOfficeTelephone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> officeTelephone<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h4 id="클래스-추출-동기"><a href="#클래스-추출-동기" class="header-anchor">#</a> 클래스 추출: 동기</h4> <ul><li>클래스는 확실히 추상화되어야 하며 명확한 기능을 담당해야 한다</li> <li>개발이 진행되며 클래스에 많은 메소드와 데이터가 추가되어 방대해진다
<ul><li>데이터와 메소드가 한 덩어리인 경우</li> <li>함께 변화하거나 서로 의존적인 데이터</li></ul></li></ul> <h4 id="클래스-추출-방법"><a href="#클래스-추출-방법" class="header-anchor">#</a> 클래스 추출: 방법</h4> <ul><li>클래스의 기능 분리 방법을 정한다</li> <li>분리한 기능을 넣을 새 클래스를 작성한다
<ul><li>원본 클래스의 기능이 변했다면 원본 클래스의 이름을 변경한다</li></ul></li> <li>원본 클래스에서 새 클래스의 링크를 만든다
<ul><li>필요할때까지는 양방향 링크(역방향 링크 추가)를 만들지 않는다</li></ul></li> <li>옮길 필드마다 필드이동을 실시한다</li> <li>필드 이동마다 테스트를 실시한다</li> <li>메소드 이동을 실시하여 원본 클래스의 메소드를 새 클래스로 옮긴다
<ul><li>피호출 메소드부터 시작해서 호출 메소드 순으로 적용한다</li></ul></li> <li>메소드 이동을 실시할 때마다 테스트를 실시한다</li> <li>각 클래스를 다시 검사하여 인터페이스를 줄인다
<ul><li>양방향 링크가 있다면 단방향으로 바꿀수 있는지 확인한다</li></ul></li> <li>여러 곳에서 클래스에 접근할 수 있도록 할지 결정한다</li></ul> <h3 id="클래스-내용-직접-삽입"><a href="#클래스-내용-직접-삽입" class="header-anchor">#</a> 클래스 내용 직접 삽입</h3> <blockquote><p>Inline Class</p></blockquote> <p>클래스 추출의 역순으로 수행한다</p> <h4 id="클래스-내용-직접-삽입-동기"><a href="#클래스-내용-직접-삽입-동기" class="header-anchor">#</a> 클래스 내용 직접 삽입: 동기</h4> <ul><li>클래스 내용 직접 삽입은 클래스 추출과 반대이다</li> <li>클래스의 기능 대부분을 다른곳으로 옮기는 리팩토링을 실시하여 남은 기능이 거의 없을 때</li> <li>작은 클래스를 가장 많이 사용하는 다른 클래스에 병합한다</li></ul> <h4 id="클래스-내용-직접-삽입-방법"><a href="#클래스-내용-직접-삽입-방법" class="header-anchor">#</a> 클래스 내용 직접 삽입: 방법</h4> <ul><li>원본 클래스의 public 프로토콜 메소드를 합칠 클래스에 선언하고, 이 메소드를 전부 원본 클래스에 위임한다
<ul><li>원본 클래스의 메소드 대신 별도의 인터페이스가 필요하다고 판단되면 인터페이스 추출을 실시한다</li></ul></li> <li>원본 클래스의 모든 참조를 합칠 클래스 참조로 수정한다
<ul><li>원본 클래스를 private로 선언하고 패키지 밖의 참조를 삭제한다</li></ul></li> <li>테스트를 실시한다</li> <li>메소드 이동과 필드 이동을 실시해서 원본 클래스의 모든 기능을 합칠 클래스로 옮긴다</li> <li>원본 클래스를 삭제한다</li></ul> <h3 id="대리-객체-은폐"><a href="#대리-객체-은폐" class="header-anchor">#</a> 대리 객체 은폐</h3> <blockquote><p>Hide Delegate</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Department</span> department<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Department</span> <span class="token function">getDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> department<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDepartment</span><span class="token punctuation">(</span><span class="token class-name">Department</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    department <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Department</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> chargeCode<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token class-name">Person</span> manager<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token class-name">Person</span> manager<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>manager <span class="token operator">=</span> manager<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> manager<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>클라이언트 클래스는 매니저를 알아내려면 우선 부서를 알아야 한다: <code>manager = kim.getDepartment().getManager();</code></p> <p>이런 의존성을 줄이려면 Department 클래스를 클라이언트가 알 수 없게 감춰야 한다.
그러려면 Person 클래스에 위임 메소드를 작성하면 된다.</p> <p>대리 객체 은폐 적용하면 다음과 같다</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Department</span> department<span class="token punctuation">;</span>

  <span class="token comment">// ...</span>

  <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> department<span class="token punctuation">.</span><span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="대리-객체-은폐-동기"><a href="#대리-객체-은폐-동기" class="header-anchor">#</a> 대리 객체 은폐: 동기</h4> <ul><li>객체의 핵심 개념중 하나가 캡슐화이다</li> <li>클라이언트가 서버 객체의 필드 중 하나에 정의된 메소드를 호출할 때 클라이언트는 대리객체에 관해 알아야 한다
<ul><li>대리객체가 변경될 때 클라이언트도 변경해야 할 가능성이 있다</li> <li>이런 의존성을 없애려면 대리객체를 감추는 위임 메소드를 서버에 두면 된다</li> <li>이 경우 변경은 서버에만 이루어지고 클라이언트에는 영향을 주지 않는다</li></ul></li> <li>서버의 일부 클라이언트나 모든 클라이언트에 대리 객체 은폐를 실시하는 것이 좋다
<ul><li>모든 클라이언트를 대상으로 대리 객체를 감출 경우 서버의 인터페이스에서 대리객체에 관한 부분을 삭제해도 된다</li></ul></li></ul> <h4 id="대리-객체-은폐-방법"><a href="#대리-객체-은폐-방법" class="header-anchor">#</a> 대리 객체 은폐: 방법</h4> <ul><li>대리 객체에 들어 있는 각 메소드를 대상으로 서버에 간단한 위임 메소드를 작성한다</li> <li>클라이언트를 수정해서 서버를 호출하게 만든다</li> <li>각 메소드를 수정할 때마다 테스트를 실시한다</li> <li>대리 객체를 읽고 써야 할 클라이언트가 하나도 남지 않게 되면 서버에서 대리 객체가 사용하는 읽기/쓰기 메소드를 삭제한다</li></ul> <h3 id="과잉-중개-메소드-제거"><a href="#과잉-중개-메소드-제거" class="header-anchor">#</a> 과잉 중개 메소드 제거</h3> <blockquote><p>Remove Middle Man</p></blockquote> <p>대리 객체 은폐의 역순으로 수행한다</p> <h4 id="과잉-중개-메소드-제거-동기"><a href="#과잉-중개-메소드-제거-동기" class="header-anchor">#</a> 과잉 중개 메소드 제거: 동기</h4> <ul><li>대리 객체 은폐를 사용하면 장점을 얻는 대신 단점도 생긴다
<ul><li>클라이언트가 대리 객체의 새 기능을 사용할 때마다 서버에 위임 메소드를 추가해야 한다</li></ul></li> <li>은폐의 적절한 정도를 알기란 쉽지 않다
<ul><li>대리 객체 은폐와 과잉 중개 메소드 제거를 실시할 때는 은폐의 정도를 몰라도 된다</li> <li>시스템이 변경되면 은폐 정도의 기준도 변한다</li></ul></li></ul> <h4 id="과잉-중개-메소드-제거-방법"><a href="#과잉-중개-메소드-제거-방법" class="header-anchor">#</a> 과잉 중개 메소드 제거: 방법</h4> <ul><li>대리 객체에 접근하는 메소드를 작성한다</li> <li>서버에서 위임 메소드를 제거하고 클라이언트에서 호출을 대리 메소드 호출로 교체한다</li> <li>메소드를 수정할 때마다 테스트를 실시한다</li></ul> <h3 id="외래-클래스에-메소드-추가"><a href="#외래-클래스에-메소드-추가" class="header-anchor">#</a> 외래 클래스에 메소드 추가</h3> <blockquote><p>Introduce Foreign Method</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Date</span> newStart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>prevEnd<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>외래 클래스에 메소드 추가 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Date</span> newStart <span class="token operator">=</span> <span class="token function">nextDay</span><span class="token punctuation">(</span>prevEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Date</span> <span class="token function">nextDay</span><span class="token punctuation">(</span><span class="token class-name">Date</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Date 클래스의 외래 메소드</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>prevEnd<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="외래-클래스에-메소드-추가-동기"><a href="#외래-클래스에-메소드-추가-동기" class="header-anchor">#</a> 외래 클래스에 메소드 추가: 동기</h4> <ul><li>현재 클래스에 없는 한가지 기능이 필요한데 원본 클래스를 수정할 수 없다면
<ul><li>외래 클래스에 메소드로 추가 기법을 사용</li></ul></li> <li>서버 클래스에 수많은 외래 메소드를 작성해야 하거나 하나의 외래 메소드를 여러 클래스가 사용해야 할 때
<ul><li>국소적 상속확장 클래스 사용 기법을 대신 사용한다</li></ul></li> <li>외래 메소드는 임시방편에 불과하다
<ul><li>가능하다면 외래 메소드를 원래 있어야 할 위치로 옮겨야 한다</li></ul></li></ul> <h4 id="외래-클래스에-메소드-추가-방법"><a href="#외래-클래스에-메소드-추가-방법" class="header-anchor">#</a> 외래 클래스에 메소드 추가: 방법</h4> <ul><li>필요한 기능의 메소드를 우선 클라이언트 클래스안에 작성한다
<ul><li>해당 메소드는 클라이언트 클래스의 어느 기능에도 접근하면 안된다</li> <li>값이 필요할 때는 매개변수로 전달해야 한다</li></ul></li> <li>서버 클래스의 인스턴스를 찾아 첫 번째 매개변수로 만든다</li> <li>그 메소드에 '서버 클래스의 외래 메소드'와 같은 주석을 추가한다</li></ul> <h3 id="국소적-상속확장-클래스-사용"><a href="#국소적-상속확장-클래스-사용" class="header-anchor">#</a> 국소적 상속확장 클래스 사용</h3> <blockquote><p>Introduce Local Extension</p></blockquote> <h4 id="국소적-상속확장-클래스-사용-동기"><a href="#국소적-상속확장-클래스-사용-동기" class="header-anchor">#</a> 국소적 상속확장 클래스 사용: 동기</h4> <ul><li>원본 클래스를 수정하는 것이 불가능 할 경우
<ul><li>필요 메소드가 적다면 외래 클래스에 메소드 추가 기법을 사용할 수 있다</li> <li>그러나 세 개이상이라면 필요 메소드를 적당한 곳에 모아두어야 한다</li> <li>이 경우 하위클래스화와 wrapper화를 적용한 국소적 상속확장 클래스를 사용한다</li></ul></li> <li>국소적 상속확장 클래스는 별도의 클래스지만 상속확장하는 클래스의 하위타입이다</li> <li>Wrapper 클래스와 하위 클래스 중 방식을 선택할 수 있다
<ul><li>하위클래스의 작업량이 적다</li> <li>하위클래스의 문제점은 객체를 생성함과 동시에 하위클래스로 만들어야 한다는 점이다</li> <li>원본객체가 mutable이면 한 객체를 수정해도 다른객체가 수정되지 않으므로 이때는 wrapper 클래스를 사용해야 한다</li></ul></li></ul> <h4 id="국소적-상속확장-클래스-사용-방법"><a href="#국소적-상속확장-클래스-사용-방법" class="header-anchor">#</a> 국소적 상속확장 클래스 사용: 방법</h4> <ul><li>상속확장 클래스를 작성한 후 원본 클래스의 하위클래스나 래퍼클래스로 만든다</li> <li>상속확장 클래스에 변환생성자 메소드를 작성한다
<ul><li>생성자는 원본클래스를 인자로 받는다</li></ul></li> <li>상속확장 클래스에 새 기능을 추가한다</li> <li>필요한 위치마다 원본 클래스를 상속확장 클래스로 수정한다</li> <li>해당 클래스용으로 정의된 외래 메소드를 모두 상속확장 클래스로 옮긴다</li></ul> <h4 id="국소적-상속확장-클래스-사용-예제"><a href="#국소적-상속확장-클래스-사용-예제" class="header-anchor">#</a> 국소적 상속확장 클래스 사용: 예제</h4> <p>Date 클래스를 확장해서 사용하는 경우를 살펴보자</p> <h5 id="하위-클래스-사용"><a href="#하위-클래스-사용" class="header-anchor">#</a> 하위 클래스 사용</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MfDateSub</span> <span class="token keyword">extends</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">MfDateSub</span><span class="token punctuation">(</span><span class="token class-name">String</span> dateString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>dateString<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">MfDateSub</span><span class="token punctuation">(</span><span class="token class-name">Date</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">Date</span> <span class="token function">nextDay</span><span class="token punctuation">(</span><span class="token class-name">Date</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>prevEnd<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h5 id="래퍼-클래스-사용"><a href="#래퍼-클래스-사용" class="header-anchor">#</a> 래퍼 클래스 사용</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MfDateWrap</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Date</span> date<span class="token punctuation">;</span>
  
  <span class="token keyword">public</span> <span class="token class-name">MfDateWrap</span><span class="token punctuation">(</span><span class="token class-name">String</span> dateString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>dateString<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">MfDateWrap</span><span class="token punctuation">(</span><span class="token class-name">Date</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    date <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 원본 Date 클래스의 모든 메소드를 위임</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> date<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 중략 ...</span>

  <span class="token class-name">Date</span> <span class="token function">nextDay</span><span class="token punctuation">(</span><span class="token class-name">Date</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>prevEnd<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prevEnd<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Wrapper 클래스를 사용하는 경우 <code>equals</code>와 같은 시스템의 메소드를 재정의하는 것은 위험하다.
이런 경우 <code>public boolean equalsDate(Date arg)</code>와 같은 메소드명을 사용할 수 밖에 없다.</p> <h2 id="데이터-체계화"><a href="#데이터-체계화" class="header-anchor">#</a> 데이터 체계화</h2> <h3 id="필드-자체-캡슐화"><a href="#필드-자체-캡슐화" class="header-anchor">#</a> 필드 자체 캡슐화</h3> <blockquote><p>Self Encapsulate Field</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">IntRange</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> low<span class="token punctuation">;</span>

  <span class="token class-name">IntRange</span><span class="token punctuation">(</span><span class="token keyword">int</span> low<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>low <span class="token operator">=</span> low<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">boolean</span> <span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg <span class="token operator">&gt;=</span> low<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>필드 자체 캡슐화 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">IntRange</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> low<span class="token punctuation">;</span>

  <span class="token class-name">IntRange</span><span class="token punctuation">(</span><span class="token keyword">int</span> low<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>low <span class="token operator">=</span> low<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">boolean</span> <span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> arg <span class="token operator">&gt;=</span> <span class="token function">getLow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">int</span> <span class="token function">getLow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> low<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">int</span> <span class="token function">setLow</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>low <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="필드-자체-캡슐화-동기"><a href="#필드-자체-캡슐화-동기" class="header-anchor">#</a> 필드 자체 캡슐화: 동기</h4> <ul><li>변수 간접 접근 방식
<ul><li>하위클래스가 메소드에 해당 정보를 가져오는 방식을 재정의 할수 있다</li> <li>속성 초기화 시점을 바꾸는 등의 데이터 관리가 더 유연해진다</li></ul></li> <li>변수 직접 접근 방식
<ul><li>코드를 알아보기 쉽다</li></ul></li> <li>필드 자체 캡슐화를 실시해야 할 시점
<ul><li>상위클래스의 안의 필드에 접근하되 변수 접근을 하위클래스에서 계산된 값으로 재정의 해야 할 때</li></ul></li></ul> <h4 id="필드-자체-캡슐화-방법"><a href="#필드-자체-캡슐화-방법" class="header-anchor">#</a> 필드 자체 캡슐화: 방법</h4> <ul><li>필드 읽기 메소드와 쓰기 메소드를 작성한다</li> <li>필드를 private으로 만든다</li> <li>필드 참조 부분을 전부 찾아서 일긱 메소드와 쓰기 메소드로 연결한다</li> <li>테스트를 실시한다</li></ul> <h3 id="데이터-값을-객체로-전환"><a href="#데이터-값을-객체로-전환" class="header-anchor">#</a> 데이터 값을 객체로 전환</h3> <blockquote><p>Replace Data Value with Object</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> customer<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token class-name">String</span> customer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>customer <span class="token operator">=</span> customer<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCustomer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCustomer</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>customer <span class="token operator">=</span> arg<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>데이터 값을 객체로 전환 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Customer</span> customer<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token class-name">String</span> customerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span>customerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCustomer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> customer<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCustomer</span><span class="token punctuation">(</span><span class="token class-name">String</span> customerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span>customerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="데이터-값을-객체로-전환-동기"><a href="#데이터-값을-객체로-전환-동기" class="header-anchor">#</a> 데이터 값을 객체로 전환: 동기</h4> <ul><li>개발 초기 단계에서는 단순 정보를 간단한 데이터 항목으로 표현하는 사안이 개발 진행과 함께 복잡해진다
<ul><li>한동안은 전화번호를 문자열로 표현해도 되지만 시간이 흐르면 형식화, 지역번호 추출등의 기능이 필요하다</li> <li>한두 항목은 객체 안에 메소드를 넣어도 되겠지만 금방 Code Smell이 발생하게된다</li></ul></li></ul> <h4 id="데이터-값을-객체로-전환-방법"><a href="#데이터-값을-객체로-전환-방법" class="header-anchor">#</a> 데이터 값을 객체로 전환: 방법</h4> <ul><li>데이터 값을 넣을 클래스를 작성한다</li> <li>클래스에 원본 클래스 안의 값과 같은 타입의 필드를 추가하고 필드를 인자로 받는 생성자와 읽기 메소드를 추가한다</li> <li>원본 클래스의 필드 타입을 새 클래스로 바꾼다</li> <li>원본 클래스 안의 읽기 메소드를 새 클래스의 읽기 메소드를 호출하도록 수정한다</li> <li>필드값 생성은 새 클래스의 생성자를 이용한다</li> <li>테스트를 실시한다</li></ul> <h3 id="값을-참조로-전환"><a href="#값을-참조로-전환" class="header-anchor">#</a> 값을 참조로 전환</h3> <blockquote><p>Change Value to Reference</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Customer</span> customer<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>

  <span class="token keyword">public</span> <span class="token class-name">Order</span><span class="token punctuation">(</span>string customerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cumstomer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span>customerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>값을 참조로 전환 적용</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Customer</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Customer</span><span class="token punctuation">&gt;</span></span> instances <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Customer</span> <span class="token function">getNamed</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> instances<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">loadCustomers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;고객1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span><span class="token string">&quot;고객2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    instances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Customer</span> customer<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>

  <span class="token keyword">public</span> <span class="token class-name">Order</span><span class="token punctuation">(</span>string customerName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cumstomer <span class="token operator">=</span> <span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token function">getNamed</span><span class="token punctuation">(</span>customerName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h4 id="값을-참조로-전환-동기"><a href="#값을-참조로-전환-동기" class="header-anchor">#</a> 값을 참조로 전환: 동기</h4> <ul><li>참조 객체와 값 객체중 어느 것을 사용할지 결정하기 애매할 때도 있다</li></ul> <h4 id="값을-참조로-전환-방법"><a href="#값을-참조로-전환-방법" class="header-anchor">#</a> 값을 참조로 전환: 방법</h4> <ul><li>생성자를 팩토리 메소드로 전환한다</li> <li>참조 객체로 접근을 담당할 객체를 정한다
<ul><li>이 기능은 정적 딕셔너리나 레지스트리 객체가 담당할 수 있다</li> <li>참조 객체로의 접근을 둘 이상의 객체가 담당할 수도 있다</li></ul></li> <li>객체를 미리생성할지 사용하기 직전에 생성할지를 정한다</li> <li>참조 객체를 반환하도록 팩토리 메소드를 수정한다
<ul><li>객체를 미리생성하는 경우 존재하지 않는 객체 요청에 대한 예외처리 해야함</li> <li>팩토리 메소드가 원본 객체를 반환함을 알수있도록 메소드명 변경을 적용해야 할 수도 있다</li></ul></li> <li>테스트를 실시한다</li></ul> <h3 id="참조를-값으로-전환"><a href="#참조를-값으로-전환" class="header-anchor">#</a> 참조를 값으로 전환</h3> <blockquote><p>Change Reference to Value</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Currency</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> code<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> code<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token class-name">Currency</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Currency</span><span class="token punctuation">(</span><span class="token string">&quot;KRW&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Currency</span><span class="token punctuation">(</span><span class="token string">&quot;KRW&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>참조를 값으로 전환</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Currency</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> code<span class="token punctuation">;</span>

  <span class="token comment">// ...</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>arg <span class="token keyword">instanceof</span> <span class="token class-name">Currency</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token class-name">Currency</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Currency</span><span class="token punctuation">)</span> arg<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>code<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> code<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Currency</span><span class="token punctuation">(</span><span class="token string">&quot;KRW&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Currency</span><span class="token punctuation">(</span><span class="token string">&quot;KRW&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="참조를-값으로-전환-동기"><a href="#참조를-값으로-전환-동기" class="header-anchor">#</a> 참조를 값으로 전환: 동기</h4> <ul><li>참조 객체를 사용한 작업이 복잡해지는 순간 참조를 값으로 바꿔야 할 시점이다</li> <li>값 객체는 변경할 수 없어야 한다는 특성이 있다
<ul><li>값 객체는 분산 시스템이나 병렬 시스템에 주로 사용된다</li> <li>값이 바뀌는 경우 기존의 객체를 새 객체로 교체해야 한다</li></ul></li></ul> <h4 id="참조를-값으로-전환-방법"><a href="#참조를-값으로-전환-방법" class="header-anchor">#</a> 참조를 값으로 전환: 방법</h4> <ul><li>전환할 객체가 변경불가인지 변경가능인지 확인한다
<ul><li>전환할 객체가 변경불가가 아니면 변경불가가 될 때 까지 쓰기 메소드 제거 실시</li></ul></li> <li>equals / hashCode 메소드를 작성한다</li> <li>팩토리 메소드를 삭제하고 생성자를 public으로 만들어야 좋은지 생각해본다</li> <li>테스트 실시</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/wiki/assets/js/app.6ca71e99.js" defer></script><script src="/wiki/assets/js/2.05cc4ee4.js" defer></script><script src="/wiki/assets/js/135.bb0ec3de.js" defer></script>
  </body>
</html>
