<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>방화벽 정책 | TIL wiki</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/wiki/assets/css/0.styles.30d8ad8c.css" as="style"><link rel="preload" href="/wiki/assets/js/app.4788f4bf.js" as="script"><link rel="preload" href="/wiki/assets/js/2.4118eb96.js" as="script"><link rel="preload" href="/wiki/assets/js/137.0c8913c9.js" as="script"><link rel="prefetch" href="/wiki/assets/js/10.623e6f21.js"><link rel="prefetch" href="/wiki/assets/js/100.2b6d99a8.js"><link rel="prefetch" href="/wiki/assets/js/101.9a81cdd2.js"><link rel="prefetch" href="/wiki/assets/js/102.43622084.js"><link rel="prefetch" href="/wiki/assets/js/103.62205932.js"><link rel="prefetch" href="/wiki/assets/js/104.4cd9f8ba.js"><link rel="prefetch" href="/wiki/assets/js/105.14372e66.js"><link rel="prefetch" href="/wiki/assets/js/106.619f102d.js"><link rel="prefetch" href="/wiki/assets/js/107.d06ce9aa.js"><link rel="prefetch" href="/wiki/assets/js/108.ed9d41e3.js"><link rel="prefetch" href="/wiki/assets/js/109.aa1e245d.js"><link rel="prefetch" href="/wiki/assets/js/11.f107d9c9.js"><link rel="prefetch" href="/wiki/assets/js/110.74c5db23.js"><link rel="prefetch" href="/wiki/assets/js/111.67e59dea.js"><link rel="prefetch" href="/wiki/assets/js/112.b47a8621.js"><link rel="prefetch" href="/wiki/assets/js/113.59c46f85.js"><link rel="prefetch" href="/wiki/assets/js/114.c90487ac.js"><link rel="prefetch" href="/wiki/assets/js/115.7c5d5cb8.js"><link rel="prefetch" href="/wiki/assets/js/116.03b246ed.js"><link rel="prefetch" href="/wiki/assets/js/117.1b22b082.js"><link rel="prefetch" href="/wiki/assets/js/118.09860361.js"><link rel="prefetch" href="/wiki/assets/js/119.430f8468.js"><link rel="prefetch" href="/wiki/assets/js/12.b6c373de.js"><link rel="prefetch" href="/wiki/assets/js/120.b659162f.js"><link rel="prefetch" href="/wiki/assets/js/121.2479c12a.js"><link rel="prefetch" href="/wiki/assets/js/122.73360588.js"><link rel="prefetch" href="/wiki/assets/js/123.4093f0cb.js"><link rel="prefetch" href="/wiki/assets/js/124.f951ec94.js"><link rel="prefetch" href="/wiki/assets/js/125.3edd7f85.js"><link rel="prefetch" href="/wiki/assets/js/126.c4f02b78.js"><link rel="prefetch" href="/wiki/assets/js/127.630ad0f6.js"><link rel="prefetch" href="/wiki/assets/js/128.5ffe2531.js"><link rel="prefetch" href="/wiki/assets/js/129.c7ae595d.js"><link rel="prefetch" href="/wiki/assets/js/13.c2f3db7a.js"><link rel="prefetch" href="/wiki/assets/js/130.8e491d8e.js"><link rel="prefetch" href="/wiki/assets/js/131.13c49706.js"><link rel="prefetch" href="/wiki/assets/js/132.0b7a8797.js"><link rel="prefetch" href="/wiki/assets/js/133.2c789b79.js"><link rel="prefetch" href="/wiki/assets/js/134.7b1c69f6.js"><link rel="prefetch" href="/wiki/assets/js/135.4023e98c.js"><link rel="prefetch" href="/wiki/assets/js/136.c0a28d87.js"><link rel="prefetch" href="/wiki/assets/js/138.72040ddb.js"><link rel="prefetch" href="/wiki/assets/js/139.173228df.js"><link rel="prefetch" href="/wiki/assets/js/14.f1db8566.js"><link rel="prefetch" href="/wiki/assets/js/140.358d652b.js"><link rel="prefetch" href="/wiki/assets/js/141.77176e35.js"><link rel="prefetch" href="/wiki/assets/js/142.e8fb8dfb.js"><link rel="prefetch" href="/wiki/assets/js/143.8cd30a68.js"><link rel="prefetch" href="/wiki/assets/js/144.e6235283.js"><link rel="prefetch" href="/wiki/assets/js/145.5779a8d4.js"><link rel="prefetch" href="/wiki/assets/js/146.98438879.js"><link rel="prefetch" href="/wiki/assets/js/147.6017d2b6.js"><link rel="prefetch" href="/wiki/assets/js/148.f4e2b68f.js"><link rel="prefetch" href="/wiki/assets/js/149.cd897554.js"><link rel="prefetch" href="/wiki/assets/js/15.b8feff3f.js"><link rel="prefetch" href="/wiki/assets/js/150.657ea716.js"><link rel="prefetch" href="/wiki/assets/js/151.83443f3a.js"><link rel="prefetch" href="/wiki/assets/js/152.bed114b8.js"><link rel="prefetch" href="/wiki/assets/js/153.5fb4d700.js"><link rel="prefetch" href="/wiki/assets/js/154.ca93cb53.js"><link rel="prefetch" href="/wiki/assets/js/155.a134f015.js"><link rel="prefetch" href="/wiki/assets/js/156.947aad3a.js"><link rel="prefetch" href="/wiki/assets/js/157.e4810a9d.js"><link rel="prefetch" href="/wiki/assets/js/158.e2b2c73e.js"><link rel="prefetch" href="/wiki/assets/js/159.3ee47071.js"><link rel="prefetch" href="/wiki/assets/js/16.08f716ec.js"><link rel="prefetch" href="/wiki/assets/js/160.9fcb6f00.js"><link rel="prefetch" href="/wiki/assets/js/161.1e1b806b.js"><link rel="prefetch" href="/wiki/assets/js/162.a9dcf141.js"><link rel="prefetch" href="/wiki/assets/js/163.74d882de.js"><link rel="prefetch" href="/wiki/assets/js/164.9e3539c2.js"><link rel="prefetch" href="/wiki/assets/js/165.ae2b6a05.js"><link rel="prefetch" href="/wiki/assets/js/166.d3c44187.js"><link rel="prefetch" href="/wiki/assets/js/167.f33dc966.js"><link rel="prefetch" href="/wiki/assets/js/168.e5a19b43.js"><link rel="prefetch" href="/wiki/assets/js/169.ab445040.js"><link rel="prefetch" href="/wiki/assets/js/17.e60466ae.js"><link rel="prefetch" href="/wiki/assets/js/170.f58bd62a.js"><link rel="prefetch" href="/wiki/assets/js/171.8b89d5ca.js"><link rel="prefetch" href="/wiki/assets/js/172.d63b2bc3.js"><link rel="prefetch" href="/wiki/assets/js/173.787584f9.js"><link rel="prefetch" href="/wiki/assets/js/174.d9463c8a.js"><link rel="prefetch" href="/wiki/assets/js/175.80f71338.js"><link rel="prefetch" href="/wiki/assets/js/176.8e0794ec.js"><link rel="prefetch" href="/wiki/assets/js/177.22d94550.js"><link rel="prefetch" href="/wiki/assets/js/178.84f1822e.js"><link rel="prefetch" href="/wiki/assets/js/179.0ea72ea4.js"><link rel="prefetch" href="/wiki/assets/js/18.5e8afd3f.js"><link rel="prefetch" href="/wiki/assets/js/180.569a384e.js"><link rel="prefetch" href="/wiki/assets/js/181.d43682c3.js"><link rel="prefetch" href="/wiki/assets/js/182.36600b32.js"><link rel="prefetch" href="/wiki/assets/js/183.615b09b1.js"><link rel="prefetch" href="/wiki/assets/js/184.c692aedb.js"><link rel="prefetch" href="/wiki/assets/js/185.82ce714b.js"><link rel="prefetch" href="/wiki/assets/js/186.92174f7c.js"><link rel="prefetch" href="/wiki/assets/js/187.77aa9818.js"><link rel="prefetch" href="/wiki/assets/js/188.df05ad09.js"><link rel="prefetch" href="/wiki/assets/js/189.088e4c37.js"><link rel="prefetch" href="/wiki/assets/js/19.6ac5247a.js"><link rel="prefetch" href="/wiki/assets/js/190.850b015c.js"><link rel="prefetch" href="/wiki/assets/js/191.85d3d38f.js"><link rel="prefetch" href="/wiki/assets/js/192.731c376e.js"><link rel="prefetch" href="/wiki/assets/js/193.290c231c.js"><link rel="prefetch" href="/wiki/assets/js/194.14ed1c66.js"><link rel="prefetch" href="/wiki/assets/js/195.73fb606c.js"><link rel="prefetch" href="/wiki/assets/js/196.6639ac8d.js"><link rel="prefetch" href="/wiki/assets/js/197.cee56831.js"><link rel="prefetch" href="/wiki/assets/js/198.5a48865a.js"><link rel="prefetch" href="/wiki/assets/js/199.0b550a56.js"><link rel="prefetch" href="/wiki/assets/js/20.54a420b8.js"><link rel="prefetch" href="/wiki/assets/js/200.f06f4894.js"><link rel="prefetch" href="/wiki/assets/js/201.51431844.js"><link rel="prefetch" href="/wiki/assets/js/202.94d14533.js"><link rel="prefetch" href="/wiki/assets/js/203.3fd058b2.js"><link rel="prefetch" href="/wiki/assets/js/204.8be4b4b0.js"><link rel="prefetch" href="/wiki/assets/js/205.dcfb65c6.js"><link rel="prefetch" href="/wiki/assets/js/206.50667ac7.js"><link rel="prefetch" href="/wiki/assets/js/207.78b5895d.js"><link rel="prefetch" href="/wiki/assets/js/208.c22380c2.js"><link rel="prefetch" href="/wiki/assets/js/209.8a1aac0f.js"><link rel="prefetch" href="/wiki/assets/js/21.7d4cfd89.js"><link rel="prefetch" href="/wiki/assets/js/210.19832c75.js"><link rel="prefetch" href="/wiki/assets/js/211.fee3949e.js"><link rel="prefetch" href="/wiki/assets/js/22.fb1308d8.js"><link rel="prefetch" href="/wiki/assets/js/23.2ba59b16.js"><link rel="prefetch" href="/wiki/assets/js/24.4e6317cd.js"><link rel="prefetch" href="/wiki/assets/js/25.306e8bd2.js"><link rel="prefetch" href="/wiki/assets/js/26.15978247.js"><link rel="prefetch" href="/wiki/assets/js/27.5c4c72a3.js"><link rel="prefetch" href="/wiki/assets/js/28.2863e531.js"><link rel="prefetch" href="/wiki/assets/js/29.f7d1cfbb.js"><link rel="prefetch" href="/wiki/assets/js/3.f08f8ac3.js"><link rel="prefetch" href="/wiki/assets/js/30.ee2be7f5.js"><link rel="prefetch" href="/wiki/assets/js/31.78283169.js"><link rel="prefetch" href="/wiki/assets/js/32.968328bf.js"><link rel="prefetch" href="/wiki/assets/js/33.2bcb5def.js"><link rel="prefetch" href="/wiki/assets/js/34.502b4f0f.js"><link rel="prefetch" href="/wiki/assets/js/35.26db2a99.js"><link rel="prefetch" href="/wiki/assets/js/36.767e6606.js"><link rel="prefetch" href="/wiki/assets/js/37.a042626d.js"><link rel="prefetch" href="/wiki/assets/js/38.357801fb.js"><link rel="prefetch" href="/wiki/assets/js/39.9a75673d.js"><link rel="prefetch" href="/wiki/assets/js/4.fba677d7.js"><link rel="prefetch" href="/wiki/assets/js/40.924775ca.js"><link rel="prefetch" href="/wiki/assets/js/41.72fd53c9.js"><link rel="prefetch" href="/wiki/assets/js/42.21451784.js"><link rel="prefetch" href="/wiki/assets/js/43.ed63762f.js"><link rel="prefetch" href="/wiki/assets/js/44.3eba6fec.js"><link rel="prefetch" href="/wiki/assets/js/45.242396cf.js"><link rel="prefetch" href="/wiki/assets/js/46.45ec5f58.js"><link rel="prefetch" href="/wiki/assets/js/47.0f5ae507.js"><link rel="prefetch" href="/wiki/assets/js/48.4921e16b.js"><link rel="prefetch" href="/wiki/assets/js/49.217dcb24.js"><link rel="prefetch" href="/wiki/assets/js/5.80b0801e.js"><link rel="prefetch" href="/wiki/assets/js/50.244664fc.js"><link rel="prefetch" href="/wiki/assets/js/51.86820643.js"><link rel="prefetch" href="/wiki/assets/js/52.347b00a3.js"><link rel="prefetch" href="/wiki/assets/js/53.d9673492.js"><link rel="prefetch" href="/wiki/assets/js/54.78b9ad68.js"><link rel="prefetch" href="/wiki/assets/js/55.dbd704b9.js"><link rel="prefetch" href="/wiki/assets/js/56.65839868.js"><link rel="prefetch" href="/wiki/assets/js/57.a03edc12.js"><link rel="prefetch" href="/wiki/assets/js/58.f0cff11d.js"><link rel="prefetch" href="/wiki/assets/js/59.6ed3f8a3.js"><link rel="prefetch" href="/wiki/assets/js/6.9bd999fa.js"><link rel="prefetch" href="/wiki/assets/js/60.eeda7871.js"><link rel="prefetch" href="/wiki/assets/js/61.cd10b4ca.js"><link rel="prefetch" href="/wiki/assets/js/62.c95c137e.js"><link rel="prefetch" href="/wiki/assets/js/63.db57c134.js"><link rel="prefetch" href="/wiki/assets/js/64.ee1046b3.js"><link rel="prefetch" href="/wiki/assets/js/65.033a91b9.js"><link rel="prefetch" href="/wiki/assets/js/66.9719c7fa.js"><link rel="prefetch" href="/wiki/assets/js/67.893c2611.js"><link rel="prefetch" href="/wiki/assets/js/68.74f907f1.js"><link rel="prefetch" href="/wiki/assets/js/69.6735228f.js"><link rel="prefetch" href="/wiki/assets/js/7.38f60696.js"><link rel="prefetch" href="/wiki/assets/js/70.f3ee6d5d.js"><link rel="prefetch" href="/wiki/assets/js/71.064608dc.js"><link rel="prefetch" href="/wiki/assets/js/72.5996ade9.js"><link rel="prefetch" href="/wiki/assets/js/73.6aca91a8.js"><link rel="prefetch" href="/wiki/assets/js/74.0226d8ec.js"><link rel="prefetch" href="/wiki/assets/js/75.e8101f60.js"><link rel="prefetch" href="/wiki/assets/js/76.0b3e2637.js"><link rel="prefetch" href="/wiki/assets/js/77.c36bac52.js"><link rel="prefetch" href="/wiki/assets/js/78.b756ea27.js"><link rel="prefetch" href="/wiki/assets/js/79.9565828a.js"><link rel="prefetch" href="/wiki/assets/js/8.3c06d632.js"><link rel="prefetch" href="/wiki/assets/js/80.e1746c75.js"><link rel="prefetch" href="/wiki/assets/js/81.e8284df5.js"><link rel="prefetch" href="/wiki/assets/js/82.1965d62e.js"><link rel="prefetch" href="/wiki/assets/js/83.3f8bb86b.js"><link rel="prefetch" href="/wiki/assets/js/84.9399e131.js"><link rel="prefetch" href="/wiki/assets/js/85.5a2d8775.js"><link rel="prefetch" href="/wiki/assets/js/86.5691b10a.js"><link rel="prefetch" href="/wiki/assets/js/87.72ebb890.js"><link rel="prefetch" href="/wiki/assets/js/88.50ea0cc9.js"><link rel="prefetch" href="/wiki/assets/js/89.f9e34d5a.js"><link rel="prefetch" href="/wiki/assets/js/9.b8f1b86b.js"><link rel="prefetch" href="/wiki/assets/js/90.863e0b43.js"><link rel="prefetch" href="/wiki/assets/js/91.e7202fa2.js"><link rel="prefetch" href="/wiki/assets/js/92.7e6ff4e8.js"><link rel="prefetch" href="/wiki/assets/js/93.3cfcd11f.js"><link rel="prefetch" href="/wiki/assets/js/94.07f755f2.js"><link rel="prefetch" href="/wiki/assets/js/95.0fdd6ec5.js"><link rel="prefetch" href="/wiki/assets/js/96.9e054884.js"><link rel="prefetch" href="/wiki/assets/js/97.fd0ef0a0.js"><link rel="prefetch" href="/wiki/assets/js/98.381ef364.js"><link rel="prefetch" href="/wiki/assets/js/99.94b076ba.js">
    <link rel="stylesheet" href="/wiki/assets/css/0.styles.30d8ad8c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki/" class="home-link router-link-active"><!----> <span class="site-name">TIL wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/pravusid/TIL" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/pravusid/TIL" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>방화벽 정책</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki/Linux/firewall.html#iptables" class="sidebar-link">iptables</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#명령어-설정" class="sidebar-link">명령어/설정</a></li></ul></li><li><a href="/wiki/Linux/firewall.html#centos" class="sidebar-link">CentOS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#설정" class="sidebar-link">설정</a></li><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#관리" class="sidebar-link">관리</a></li></ul></li><li><a href="/wiki/Linux/firewall.html#ubuntu" class="sidebar-link">Ubuntu</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#기본문법" class="sidebar-link">기본문법</a></li><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#심화-문법" class="sidebar-link">심화 문법</a></li><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#심화-예제" class="sidebar-link">심화 예제</a></li><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#로그" class="sidebar-link">로그</a></li><li class="sidebar-sub-header"><a href="/wiki/Linux/firewall.html#logged-event-용어에-관한-설명" class="sidebar-link">logged event 용어에 관한 설명</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="방화벽-정책"><a href="#방화벽-정책" class="header-anchor">#</a> 방화벽 정책</h1> <h2 id="iptables"><a href="#iptables" class="header-anchor">#</a> iptables</h2> <p><code>/etc/sysconfig/iptables</code></p> <p>설정이후 재시작: <code>service iptables restart</code></p> <h3 id="명령어-설정"><a href="#명령어-설정" class="header-anchor">#</a> 명령어/설정</h3> <ul><li><p>OPTION</p> <ul><li><code>-p</code>: protocol</li> <li><code>-s</code>: source</li> <li><code>-d</code>: destination</li> <li><code>-m</code>: match</li> <li><code>-j targetname [per-target-options]</code>: target</li></ul></li> <li><p>IP</p> <ul><li>특정 IP 허용/차단: <code>iptables -A INPUT -s &lt;ip주소&gt; -j &lt;ACCEPT/DROP&gt;</code></li> <li>다수의 IP 허용/차단: <code>iptables -A INPUT -s &lt;ip주소1,ip주소2,ip주소3...&gt; -j &lt;ACCEPT/DROP&gt;</code></li> <li>연속 범위 IP 허용/차단: <code>iptables -A INPUT -s &lt;192.168.1.0/24&gt; -j &lt;ACCEPT/DROP&gt;</code>: subnet mask 활용</li></ul></li> <li><p>PORT</p> <ul><li>특정 Port 허용/차단: <code>iptables -A INPUT -p tcp –dport &lt;포트&gt; -j &lt;ACCEPT/DROP&gt;</code></li> <li>연속 범위 Port 허용/차단: <code>iptables -A INPUT -p tcp –dport &lt;포트시작:포트끝&gt; -j &lt;ACCEPT/DROP&gt;</code></li></ul></li> <li><p>IP &amp; PORT</p> <ul><li>특정 IP와 Port 차단: <code>iptables -A INPUT -s &lt;ip주소&gt; -p tcp –dport &lt;포트&gt; -j DROP</code></li> <li>다수의 IP 및 포트 범위는 위와 같은 방식으로 적용</li></ul></li> <li><p>로그 설정: <code>iptables -I INPUT -s &lt;ip주소&gt; -p tcp –dport &lt;port&gt; -j LOG –log-prefix “[denied]”</code></p></li></ul> <h2 id="centos"><a href="#centos" class="header-anchor">#</a> CentOS</h2> <ul><li>centos7 이전 iptables 사용</li> <li>centos7 부터 firewall 사용</li></ul> <h3 id="설정"><a href="#설정" class="header-anchor">#</a> 설정</h3> <ul><li>설정 파일: <code>/etc/firewalld/zones/public.xml</code></li> <li>퍼블릭 포트 추가: <code>firewall-cmd --permanent --zone=public --add-port=8080/tcp</code></li> <li>퍼블릭 포트 제거: <code>firewall-cmd --permanent --zone=public --remove-port=8080/tcp</code></li> <li>임시 추가: 위의 명령에서 <code>--permanent</code> 제외</li> <li>ftp 서비스 추가: <code>firewall-cmd --add-service=ftp</code></li> <li>ftp 서비스 제거: <code>firewall-cmd --add-port=21/tcp</code></li> <li>방화벽 새로고침 (변경사항 적용): <code>firewall-cmd --reload</code></li></ul> <h3 id="관리"><a href="#관리" class="header-anchor">#</a> 관리</h3> <ul><li><p>방화벽 상태 확인: <code>firewall-cmd --state</code></p></li> <li><p>서비스 리스트: <code>firewall-cmd --get-service</code></p></li> <li><p>default zone 목록 : <code>firewall-cmd --get-default-zone</code></p></li> <li><p>active zone 목록: <code>firewall-cmd --get-active-zones</code></p></li> <li><p>사용가능한 서비스/포트 목록: <code>firewall-cmd --list-all</code></p></li> <li><p>public존의 사용가능한 서비스/포트 목록: <code>firewall-cmd --zone=public --list-all</code></p></li> <li><p>특정 존에 있는 서비스 리스트: <code>firewall-cmd --zone=public --list-services</code></p></li> <li><p>방화벽 daemon 켜고 끄기</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>systemctl start firewalld
systemctl <span class="token builtin class-name">enable</span> firewalld
systemctl stop firewalld
systemctl disable firewalld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h2 id="ubuntu"><a href="#ubuntu" class="header-anchor">#</a> Ubuntu</h2> <p>우분투의 기본 방화벽은 ufw이다. ufw의 gui버전인 Gufw를 사용할 수도 있다.</p> <p>설정파일은 <code>/etc/ufw/</code> 경로에서 확인할 수 있다.</p> <h3 id="기본문법"><a href="#기본문법" class="header-anchor">#</a> 기본문법</h3> <ul><li><p>활성화 / 비활성화</p> <ul><li>활성화: <code>sudo ufw enable</code></li> <li>비활성화: <code>sudo ufw disable</code></li></ul></li> <li><p>기본정책 확인(in-모두거부, out-모두허용): <code>sudo ufw show raw</code></p> <ul><li>기본정책으로 허용: <code>sudo ufw default allow</code></li> <li>기본정책으로 차단: <code>sudo ufw default deny</code></li></ul></li> <li><p>상태확인: <code>sudo ufw status verbose</code></p></li> <li><p>Allow / Deny</p> <ul><li><p>Allow: <code>sudo ufw allow &lt;port&gt;/&lt;optional: protocol&gt;</code></p> <ul><li>예제: To allow incoming tcp and udp packet on port 53: <code>sudo ufw allow 53</code></li> <li>예제: To allow incoming tcp packets on port 53: <code>sudo ufw allow 53/tcp</code></li> <li>예제: To allow incoming udp packets on port 53: <code>sudo ufw allow 53/udp</code></li></ul></li> <li><p>Deny: <code>sudo ufw deny &lt;port&gt;/&lt;optional: protocol&gt;</code></p> <ul><li>예제: To deny tcp and udp packets on port 53: <code>sudo ufw deny 53</code></li> <li>예제: To deny incoming tcp packets on port 53: <code>sudo ufw deny 53/tcp</code></li> <li>예제: To deny incoming udp packets on port 53: <code>sudo ufw deny 53/udp</code></li></ul></li></ul></li> <li><p>룰 삭제</p> <ul><li>ufw deny 80/tcp 룰을 삭제하려면: <code>sudo ufw delete deny 80/tcp</code></li></ul></li> <li><p>서비스: 서비스 이름을 방화벽에 등록할 수 있다 (서비스 목록: <code>/etc/services</code>)</p> <ul><li>Allow by Service Name: <code>sudo ufw allow &lt;service name&gt;</code> <ul><li>예제: to allow ssh by name: <code>sudo ufw allow ssh</code></li></ul></li> <li>Deny by Service Name: <code>sudo ufw deny &lt;service name&gt;</code> <ul><li>예제: to deny ssh by name: <code>sudo ufw deny ssh</code></li></ul></li></ul></li> <li><p>방화벽 상태확인: <code>sudo ufw status</code></p></li> <li><p>Logging</p> <ul><li>로깅 on: <code>sudo ufw logging on</code></li> <li>로깅 off: <code>sudo ufw logging off</code></li></ul></li></ul> <h3 id="심화-문법"><a href="#심화-문법" class="header-anchor">#</a> 심화 문법</h3> <ul><li><p>접근 허용</p> <ul><li><p>특정 IP 허용: <code>sudo ufw allow from &lt;ip address&gt;</code></p> <ul><li>예제:To allow packets from 207.46.232.182: <code>sudo ufw allow from 207.46.232.182</code></li></ul></li> <li><p>특정 subnet 허용</p> <ul><li>netmask를 사용한다: <code>sudo ufw allow from 192.168.1.0/24</code></li></ul></li> <li><p>특정 Port와 IP를 허용: <code>sudo ufw allow from &lt;target&gt; to &lt;destination&gt; port &lt;port number&gt;</code></p> <ul><li>예제: allow IP address 192.168.0.4 access to port 22 for all protocols: <code>sudo ufw allow from 192.168.0.4 to any port 22</code></li></ul></li> <li><p>특정 Port와 IP와 프로토콜 허용: <code>sudo ufw allow from &lt;target&gt; to &lt;destination&gt; port &lt;port number&gt; proto &lt;protocol name&gt;</code></p> <ul><li>예제: allow IP address 192.168.0.4 access to port 22 using TCP: <code>sudo ufw allow from 192.168.0.4 to any port 22 proto tcp</code></li></ul></li></ul></li> <li><p>핑 허용</p> <ul><li>기본적으로 UFW는 ping requests를 허용한다..</li> <li>핑 요청을 해제하기 위해서 <code>/etc/ufw/before.rules</code>의 다음 라인을 삭제해야 한다</li></ul> <div class="language-text line-numbers-mode"><pre class="language-text"><code># ok icmp codes
-A ufw-before-input -p icmp --icmp-type destination-unreachable -j ACCEPT
-A ufw-before-input -p icmp --icmp-type source-quench -j ACCEPT
-A ufw-before-input -p icmp --icmp-type time-exceeded -j ACCEPT
-A ufw-before-input -p icmp --icmp-type parameter-problem -j ACCEPT
-A ufw-before-input -p icmp --icmp-type echo-request -j ACCEPT

or change the &quot;ACCEPT&quot; to &quot;DROP&quot;

# ok icmp codes
-A ufw-before-input -p icmp --icmp-type destination-unreachable -j DROP
-A ufw-before-input -p icmp --icmp-type source-quench -j DROP
-A ufw-before-input -p icmp --icmp-type time-exceeded -j DROP
-A ufw-before-input -p icmp --icmp-type parameter-problem -j DROP
-A ufw-before-input -p icmp --icmp-type echo-request -j DROP
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>접근 거부</p> <ul><li><p>특정 IP 거부: <code>sudo ufw deny from &lt;ip address&gt;</code></p> <ul><li>예제:To block packets from 207.46.232.182: <code>sudo ufw deny from 207.46.232.182</code></li></ul></li> <li><p>특정 Port와 IP를 거부: <code>sudo ufw deny from &lt;ip address&gt; to &lt;protocol&gt; port &lt;port number&gt;</code></p> <ul><li>예제: deny ip address 192.168.0.1 access to port 22 for all protocols: <code>sudo ufw deny from 192.168.0.1 to any port 22</code></li></ul></li></ul></li> <li><p>status의 순서(룰의 id 번호)를 이용해서 수정할 수 있다</p> <ul><li>숫자와 함께 룰 목록 출력: <code>sudo ufw status numbered</code></li> <li>룰 삭제(번호): <code>sudo ufw delete 1</code></li> <li>룰 추가(번호): <code>sudo ufw insert 1 allow from &lt;ip address&gt;</code></li></ul></li></ul> <h3 id="심화-예제"><a href="#심화-예제" class="header-anchor">#</a> 심화 예제</h3> <p>192.168.0.1, 192.168.0.7으로 부터오는 22번 포트 요청을 막고싶지만, 다른 192.168.0.x 대역의 22번 포트 tcp 요청은 허용하려는 경우.</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> ufw deny from <span class="token number">192.168</span>.0.1 to any port <span class="token number">22</span>
<span class="token function">sudo</span> ufw deny from <span class="token number">192.168</span>.0.7 to any port <span class="token number">22</span>
<span class="token function">sudo</span> ufw allow from <span class="token number">192.168</span>.0.0/24 to any port <span class="token number">22</span> proto tcp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>세부사항의 룰을 우선 선언하고, 일반 룰은 나중에 선언해야 한다. 룰을 해석하면 이에 matching 하는 다른 룰은 해석하지 않기 때문이다.</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> ufw status

To                         Action  From
--                         ------  ----
<span class="token number">22</span>:tcp                     DENY    <span class="token number">192.168</span>.0.1
<span class="token number">22</span>:udp                     DENY    <span class="token number">192.168</span>.0.1
<span class="token number">22</span>:tcp                     DENY    <span class="token number">192.168</span>.0.7
<span class="token number">22</span>:udp                     DENY    <span class="token number">192.168</span>.0.7
<span class="token number">22</span>:tcp                     ALLOW   <span class="token number">192.168</span>.0.0/24
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>192.168.0.3 주소의 22번 포트요청을 추가로 막으려는 경우</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> ufw delete allow from <span class="token number">192.168</span>.0.0/24 to any port <span class="token number">22</span>
<span class="token function">sudo</span> ufw status

To                         Action  From
--                         ------  ----
<span class="token number">22</span>:tcp                     DENY    <span class="token number">192.168</span>.0.1
<span class="token number">22</span>:udp                     DENY    <span class="token number">192.168</span>.0.1
<span class="token number">22</span>:tcp                     DENY    <span class="token number">192.168</span>.0.7
<span class="token number">22</span>:udp                     DENY    <span class="token number">192.168</span>.0.7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>일반 룰을 우선 삭제하고 다시 세부룰을 추가한 뒤, 일반 룰을 다시 추가한다</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> ufw deny <span class="token number">192.168</span>.0.3 to any port <span class="token number">22</span>
<span class="token function">sudo</span> ufw allow <span class="token number">192.168</span>.0.0/24 to any port <span class="token number">22</span> proto tcp
<span class="token function">sudo</span> ufw status

To                         Action  From
--                         ------  ----
<span class="token number">22</span>:tcp                     DENY    <span class="token number">192.168</span>.0.1
<span class="token number">22</span>:udp                     DENY    <span class="token number">192.168</span>.0.1
<span class="token number">22</span>:tcp                     DENY    <span class="token number">192.168</span>.0.7
<span class="token number">22</span>:udp                     DENY    <span class="token number">192.168</span>.0.7
<span class="token number">22</span>:tcp                     DENY    <span class="token number">192.168</span>.0.3
<span class="token number">22</span>:udp                     DENY    <span class="token number">192.168</span>.0.3
<span class="token number">22</span>:tcp                     ALLOW   <span class="token number">192.168</span>.0.0/24
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="로그"><a href="#로그" class="header-anchor">#</a> 로그</h3> <h4 id="log-entries"><a href="#log-entries" class="header-anchor">#</a> Log Entries</h4> <p>Pseudo Log Entry</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>Feb  4 23:33:37 hostname kernel: [ 3529.289825] [UFW BLOCK] IN=eth0 OUT= MAC=00:11:22:33:44:55:66:77:88:99:aa:bb:cc:dd SRC=444.333.222.111 DST=111.222.333.444 LEN=103 TOS=0x00 PREC=0x00 TTL=52 ID=0 DF PROTO=UDP SPT=53 DPT=36427 LEN=83
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>Date: It's good practice to watch the dates and times. If things are out of order or blocks of time are missing then an attacker probably messed with your logs.</li> <li>Hostname: The server’s hostname</li> <li>Uptime: The time in seconds since boot.</li></ul> <h3 id="logged-event-용어에-관한-설명"><a href="#logged-event-용어에-관한-설명" class="header-anchor">#</a> logged event 용어에 관한 설명</h3> <ul><li>IN: If set, then the event was an incoming event.</li> <li>OUT: If set, then the event was an outgoing event.</li> <li>MAC: This provides a 14-byte combination of the Destination MAC, Source MAC, and EtherType fields, following the order found in the Ethernet II header. See Ethernet frame and EtherType for more information.</li> <li>SRC: This indicates the source IP, who sent the packet initially. Some IPs are routable over the internet, some will only communicate over a LAN, and some will only route back to the source computer. See IP address for more information.</li> <li>DST: This indicates the destination IP, who is meant to receive the packet. You can use whois.net or the cli whois to determine the owner of the IP address.</li> <li>LEN: This indicates the length of the packet.</li> <li>TOS: I believe this refers to the TOS field of the IPv4 header. See TCP Processing of the IPv4 Precedence Field for more information.</li> <li>PREC: I believe this refers to the Precedence field of the IPv4 header.</li> <li>TTL: This indicates the “Time to live” for the packet. Basically each packet will only bounce through the given number of routers before it dies and disappears. If it hasn’t found its destination before the TTL expires, then the packet will evaporate. This field keeps lost packets from clogging the internet forever. See Time to live for more information.</li> <li>ID: Not sure what this one is, but it's not really important for reading logs. It might be ufw’s internal ID system, it might be the operating system’s ID.</li> <li>PROTO: This indicates the protocol of the packet - TCP or UDP. See TCP and UDP Ports Explained for more information.</li> <li>SPT: This indicates the source. I believe this is the port, which the SRC IP sent the IP packet over. See List of TCP and UDP port numbers for more information.</li> <li>DPT: This indicates the destination port. I believe this is the port, which the SRC IP sent its IP packet to, expecting a service to be running on this port.</li> <li>WINDOW: This indicates the size of packet the sender is willing to receive.</li> <li>RES: This bit is reserved for future use &amp; is always set to 0. Basically it’s irrelevant for log reading purposes.</li> <li>SYN URGP: SYN indicates that this connection requires a three-way handshake, which is typical of TCP connections. URGP indicates whether the urgent pointer field is relevant. 0 means it's not. Doesn’t really matter for firewall log reading.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/wiki/assets/js/app.4788f4bf.js" defer></script><script src="/wiki/assets/js/2.4118eb96.js" defer></script><script src="/wiki/assets/js/137.0c8913c9.js" defer></script>
  </body>
</html>
