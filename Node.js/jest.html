<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jest | TIL wiki</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/wiki/assets/css/0.styles.28a8e502.css" as="style"><link rel="preload" href="/wiki/assets/js/app.c38ade27.js" as="script"><link rel="preload" href="/wiki/assets/js/2.05cc4ee4.js" as="script"><link rel="preload" href="/wiki/assets/js/186.04955f1e.js" as="script"><link rel="prefetch" href="/wiki/assets/js/10.ea88f78c.js"><link rel="prefetch" href="/wiki/assets/js/100.b59e0747.js"><link rel="prefetch" href="/wiki/assets/js/101.7d12c127.js"><link rel="prefetch" href="/wiki/assets/js/102.2bd84645.js"><link rel="prefetch" href="/wiki/assets/js/103.91774eb5.js"><link rel="prefetch" href="/wiki/assets/js/104.f359a91e.js"><link rel="prefetch" href="/wiki/assets/js/105.560fc89f.js"><link rel="prefetch" href="/wiki/assets/js/106.d2847b44.js"><link rel="prefetch" href="/wiki/assets/js/107.d9d31579.js"><link rel="prefetch" href="/wiki/assets/js/108.c3ba82ce.js"><link rel="prefetch" href="/wiki/assets/js/109.d99442f9.js"><link rel="prefetch" href="/wiki/assets/js/11.90cbe306.js"><link rel="prefetch" href="/wiki/assets/js/110.604f5b3b.js"><link rel="prefetch" href="/wiki/assets/js/111.13b52579.js"><link rel="prefetch" href="/wiki/assets/js/112.b9503585.js"><link rel="prefetch" href="/wiki/assets/js/113.6b1d8ed4.js"><link rel="prefetch" href="/wiki/assets/js/114.ba13f782.js"><link rel="prefetch" href="/wiki/assets/js/115.9867953c.js"><link rel="prefetch" href="/wiki/assets/js/116.9dbc04d2.js"><link rel="prefetch" href="/wiki/assets/js/117.214e0120.js"><link rel="prefetch" href="/wiki/assets/js/118.1626357b.js"><link rel="prefetch" href="/wiki/assets/js/119.6546e0ad.js"><link rel="prefetch" href="/wiki/assets/js/12.503cfa25.js"><link rel="prefetch" href="/wiki/assets/js/120.dd8c3122.js"><link rel="prefetch" href="/wiki/assets/js/121.f2620dba.js"><link rel="prefetch" href="/wiki/assets/js/122.3c03aef4.js"><link rel="prefetch" href="/wiki/assets/js/123.2dcec0b5.js"><link rel="prefetch" href="/wiki/assets/js/124.5f620733.js"><link rel="prefetch" href="/wiki/assets/js/125.f7cfc35c.js"><link rel="prefetch" href="/wiki/assets/js/126.9fd33b6d.js"><link rel="prefetch" href="/wiki/assets/js/127.2ecc7903.js"><link rel="prefetch" href="/wiki/assets/js/128.e9cc18da.js"><link rel="prefetch" href="/wiki/assets/js/129.da6d3b7d.js"><link rel="prefetch" href="/wiki/assets/js/13.0bba1821.js"><link rel="prefetch" href="/wiki/assets/js/130.3512e7b8.js"><link rel="prefetch" href="/wiki/assets/js/131.0e9533fb.js"><link rel="prefetch" href="/wiki/assets/js/132.7a24310b.js"><link rel="prefetch" href="/wiki/assets/js/133.824a68ef.js"><link rel="prefetch" href="/wiki/assets/js/134.f4e1cc3f.js"><link rel="prefetch" href="/wiki/assets/js/135.c8990d02.js"><link rel="prefetch" href="/wiki/assets/js/136.c51ae28a.js"><link rel="prefetch" href="/wiki/assets/js/137.1e95ee51.js"><link rel="prefetch" href="/wiki/assets/js/138.7cb6ee37.js"><link rel="prefetch" href="/wiki/assets/js/139.acd98a5d.js"><link rel="prefetch" href="/wiki/assets/js/14.c5dc23f3.js"><link rel="prefetch" href="/wiki/assets/js/140.3af1d9ca.js"><link rel="prefetch" href="/wiki/assets/js/141.0ffe07e4.js"><link rel="prefetch" href="/wiki/assets/js/142.f3f15d44.js"><link rel="prefetch" href="/wiki/assets/js/143.f951cf2f.js"><link rel="prefetch" href="/wiki/assets/js/144.763923a8.js"><link rel="prefetch" href="/wiki/assets/js/145.04a7a018.js"><link rel="prefetch" href="/wiki/assets/js/146.59422e63.js"><link rel="prefetch" href="/wiki/assets/js/147.d318c059.js"><link rel="prefetch" href="/wiki/assets/js/148.4eaaef82.js"><link rel="prefetch" href="/wiki/assets/js/149.967e7725.js"><link rel="prefetch" href="/wiki/assets/js/15.592b3cc9.js"><link rel="prefetch" href="/wiki/assets/js/150.22850bc7.js"><link rel="prefetch" href="/wiki/assets/js/151.f88fa2c1.js"><link rel="prefetch" href="/wiki/assets/js/152.ac7f13d1.js"><link rel="prefetch" href="/wiki/assets/js/153.5d7cd740.js"><link rel="prefetch" href="/wiki/assets/js/154.bc4c4020.js"><link rel="prefetch" href="/wiki/assets/js/155.119d01fd.js"><link rel="prefetch" href="/wiki/assets/js/156.d65ca4ed.js"><link rel="prefetch" href="/wiki/assets/js/157.3a128ee8.js"><link rel="prefetch" href="/wiki/assets/js/158.652a7ed9.js"><link rel="prefetch" href="/wiki/assets/js/159.762855f5.js"><link rel="prefetch" href="/wiki/assets/js/16.153fa8d1.js"><link rel="prefetch" href="/wiki/assets/js/160.2cd88765.js"><link rel="prefetch" href="/wiki/assets/js/161.f0817c33.js"><link rel="prefetch" href="/wiki/assets/js/162.f0738193.js"><link rel="prefetch" href="/wiki/assets/js/163.fc546483.js"><link rel="prefetch" href="/wiki/assets/js/164.2ad452d2.js"><link rel="prefetch" href="/wiki/assets/js/165.ed9b404e.js"><link rel="prefetch" href="/wiki/assets/js/166.ec8c52fe.js"><link rel="prefetch" href="/wiki/assets/js/167.1c91961f.js"><link rel="prefetch" href="/wiki/assets/js/168.f37a0836.js"><link rel="prefetch" href="/wiki/assets/js/169.e94a214b.js"><link rel="prefetch" href="/wiki/assets/js/17.af681efa.js"><link rel="prefetch" href="/wiki/assets/js/170.8c9d35dd.js"><link rel="prefetch" href="/wiki/assets/js/171.473edea9.js"><link rel="prefetch" href="/wiki/assets/js/172.5e809189.js"><link rel="prefetch" href="/wiki/assets/js/173.c2e71bcb.js"><link rel="prefetch" href="/wiki/assets/js/174.a71711bc.js"><link rel="prefetch" href="/wiki/assets/js/175.f79758c0.js"><link rel="prefetch" href="/wiki/assets/js/176.f879d42a.js"><link rel="prefetch" href="/wiki/assets/js/177.62e3b4f7.js"><link rel="prefetch" href="/wiki/assets/js/178.3c27f3a3.js"><link rel="prefetch" href="/wiki/assets/js/179.8248efda.js"><link rel="prefetch" href="/wiki/assets/js/18.0f152aa8.js"><link rel="prefetch" href="/wiki/assets/js/180.6420066f.js"><link rel="prefetch" href="/wiki/assets/js/181.0b03b281.js"><link rel="prefetch" href="/wiki/assets/js/182.ed8e9946.js"><link rel="prefetch" href="/wiki/assets/js/183.c027fdfa.js"><link rel="prefetch" href="/wiki/assets/js/184.ccaa72d8.js"><link rel="prefetch" href="/wiki/assets/js/185.4227f1c5.js"><link rel="prefetch" href="/wiki/assets/js/187.ad2eea52.js"><link rel="prefetch" href="/wiki/assets/js/188.562625d9.js"><link rel="prefetch" href="/wiki/assets/js/189.928b0fd0.js"><link rel="prefetch" href="/wiki/assets/js/19.2e048670.js"><link rel="prefetch" href="/wiki/assets/js/190.802f6cf4.js"><link rel="prefetch" href="/wiki/assets/js/191.6273dbd8.js"><link rel="prefetch" href="/wiki/assets/js/192.15cb6424.js"><link rel="prefetch" href="/wiki/assets/js/193.c004742f.js"><link rel="prefetch" href="/wiki/assets/js/194.ad2f82c4.js"><link rel="prefetch" href="/wiki/assets/js/195.903f004b.js"><link rel="prefetch" href="/wiki/assets/js/196.1c40718d.js"><link rel="prefetch" href="/wiki/assets/js/197.9e5f19ae.js"><link rel="prefetch" href="/wiki/assets/js/198.4c73b747.js"><link rel="prefetch" href="/wiki/assets/js/199.05b34ff4.js"><link rel="prefetch" href="/wiki/assets/js/20.2408e50d.js"><link rel="prefetch" href="/wiki/assets/js/200.482f2d03.js"><link rel="prefetch" href="/wiki/assets/js/201.44e21ef1.js"><link rel="prefetch" href="/wiki/assets/js/202.db31dc33.js"><link rel="prefetch" href="/wiki/assets/js/203.11eaa14c.js"><link rel="prefetch" href="/wiki/assets/js/204.d54bbea3.js"><link rel="prefetch" href="/wiki/assets/js/205.a50c9da3.js"><link rel="prefetch" href="/wiki/assets/js/206.fe836b0c.js"><link rel="prefetch" href="/wiki/assets/js/207.4d06fb7f.js"><link rel="prefetch" href="/wiki/assets/js/208.2432dc69.js"><link rel="prefetch" href="/wiki/assets/js/209.4fba406d.js"><link rel="prefetch" href="/wiki/assets/js/21.b17f0dbe.js"><link rel="prefetch" href="/wiki/assets/js/210.536ed4d0.js"><link rel="prefetch" href="/wiki/assets/js/211.7cb02534.js"><link rel="prefetch" href="/wiki/assets/js/212.a4ee0875.js"><link rel="prefetch" href="/wiki/assets/js/213.c0046e25.js"><link rel="prefetch" href="/wiki/assets/js/214.b735bf51.js"><link rel="prefetch" href="/wiki/assets/js/215.0aed650b.js"><link rel="prefetch" href="/wiki/assets/js/216.66954caf.js"><link rel="prefetch" href="/wiki/assets/js/217.86a6c6ad.js"><link rel="prefetch" href="/wiki/assets/js/218.3842d2b0.js"><link rel="prefetch" href="/wiki/assets/js/219.74c872cb.js"><link rel="prefetch" href="/wiki/assets/js/22.4198f632.js"><link rel="prefetch" href="/wiki/assets/js/220.336470e7.js"><link rel="prefetch" href="/wiki/assets/js/221.728b811c.js"><link rel="prefetch" href="/wiki/assets/js/222.418d5f6d.js"><link rel="prefetch" href="/wiki/assets/js/223.be527bf4.js"><link rel="prefetch" href="/wiki/assets/js/224.af35aa7a.js"><link rel="prefetch" href="/wiki/assets/js/225.2f87302b.js"><link rel="prefetch" href="/wiki/assets/js/226.f9c6ee12.js"><link rel="prefetch" href="/wiki/assets/js/227.1e8771e2.js"><link rel="prefetch" href="/wiki/assets/js/228.96ac988e.js"><link rel="prefetch" href="/wiki/assets/js/229.17070e39.js"><link rel="prefetch" href="/wiki/assets/js/23.48ddc56f.js"><link rel="prefetch" href="/wiki/assets/js/230.f512a464.js"><link rel="prefetch" href="/wiki/assets/js/231.1e7bedc7.js"><link rel="prefetch" href="/wiki/assets/js/232.b1f61917.js"><link rel="prefetch" href="/wiki/assets/js/233.3a2b3353.js"><link rel="prefetch" href="/wiki/assets/js/234.b5d9e997.js"><link rel="prefetch" href="/wiki/assets/js/235.e5f33fe2.js"><link rel="prefetch" href="/wiki/assets/js/236.106fa2cc.js"><link rel="prefetch" href="/wiki/assets/js/237.7b6402cc.js"><link rel="prefetch" href="/wiki/assets/js/238.df791b9d.js"><link rel="prefetch" href="/wiki/assets/js/239.7495d83c.js"><link rel="prefetch" href="/wiki/assets/js/24.fa3396f0.js"><link rel="prefetch" href="/wiki/assets/js/240.d30ac590.js"><link rel="prefetch" href="/wiki/assets/js/241.c82764d9.js"><link rel="prefetch" href="/wiki/assets/js/242.e0e1bc67.js"><link rel="prefetch" href="/wiki/assets/js/243.d92bf954.js"><link rel="prefetch" href="/wiki/assets/js/244.876eadc4.js"><link rel="prefetch" href="/wiki/assets/js/245.078899ca.js"><link rel="prefetch" href="/wiki/assets/js/246.07953ba0.js"><link rel="prefetch" href="/wiki/assets/js/247.814d961d.js"><link rel="prefetch" href="/wiki/assets/js/248.45eea047.js"><link rel="prefetch" href="/wiki/assets/js/249.c851f1db.js"><link rel="prefetch" href="/wiki/assets/js/25.abe3d93c.js"><link rel="prefetch" href="/wiki/assets/js/250.3782667c.js"><link rel="prefetch" href="/wiki/assets/js/251.31121a91.js"><link rel="prefetch" href="/wiki/assets/js/252.3964fc49.js"><link rel="prefetch" href="/wiki/assets/js/253.26a33b52.js"><link rel="prefetch" href="/wiki/assets/js/254.289c29a3.js"><link rel="prefetch" href="/wiki/assets/js/255.2daec89b.js"><link rel="prefetch" href="/wiki/assets/js/256.14f9df0c.js"><link rel="prefetch" href="/wiki/assets/js/257.5f180ccf.js"><link rel="prefetch" href="/wiki/assets/js/258.9404468d.js"><link rel="prefetch" href="/wiki/assets/js/259.98508910.js"><link rel="prefetch" href="/wiki/assets/js/26.aa0d7454.js"><link rel="prefetch" href="/wiki/assets/js/260.2c089ed2.js"><link rel="prefetch" href="/wiki/assets/js/261.d9a0131a.js"><link rel="prefetch" href="/wiki/assets/js/262.e1980792.js"><link rel="prefetch" href="/wiki/assets/js/263.53533675.js"><link rel="prefetch" href="/wiki/assets/js/264.fdaf953e.js"><link rel="prefetch" href="/wiki/assets/js/265.49f829a0.js"><link rel="prefetch" href="/wiki/assets/js/266.2c67658d.js"><link rel="prefetch" href="/wiki/assets/js/267.7baa911a.js"><link rel="prefetch" href="/wiki/assets/js/268.ecdea752.js"><link rel="prefetch" href="/wiki/assets/js/269.757ef953.js"><link rel="prefetch" href="/wiki/assets/js/27.f208d228.js"><link rel="prefetch" href="/wiki/assets/js/270.20d7039c.js"><link rel="prefetch" href="/wiki/assets/js/271.327477de.js"><link rel="prefetch" href="/wiki/assets/js/272.7f400922.js"><link rel="prefetch" href="/wiki/assets/js/273.92edd3f9.js"><link rel="prefetch" href="/wiki/assets/js/274.a5bdd6a5.js"><link rel="prefetch" href="/wiki/assets/js/275.c44ff430.js"><link rel="prefetch" href="/wiki/assets/js/276.849ee87e.js"><link rel="prefetch" href="/wiki/assets/js/277.03bd332e.js"><link rel="prefetch" href="/wiki/assets/js/278.73581d9f.js"><link rel="prefetch" href="/wiki/assets/js/279.717fec41.js"><link rel="prefetch" href="/wiki/assets/js/28.bad3b44b.js"><link rel="prefetch" href="/wiki/assets/js/280.748233d7.js"><link rel="prefetch" href="/wiki/assets/js/281.5c88f921.js"><link rel="prefetch" href="/wiki/assets/js/282.4b74cb65.js"><link rel="prefetch" href="/wiki/assets/js/283.6d0c8187.js"><link rel="prefetch" href="/wiki/assets/js/284.5f60e827.js"><link rel="prefetch" href="/wiki/assets/js/285.dbe418aa.js"><link rel="prefetch" href="/wiki/assets/js/286.b3a2a8d8.js"><link rel="prefetch" href="/wiki/assets/js/287.5d4934c6.js"><link rel="prefetch" href="/wiki/assets/js/288.d7b09782.js"><link rel="prefetch" href="/wiki/assets/js/289.c5b8ae73.js"><link rel="prefetch" href="/wiki/assets/js/29.66779520.js"><link rel="prefetch" href="/wiki/assets/js/290.071310a8.js"><link rel="prefetch" href="/wiki/assets/js/291.e9dbca75.js"><link rel="prefetch" href="/wiki/assets/js/292.ffc2b63f.js"><link rel="prefetch" href="/wiki/assets/js/293.85d45c2b.js"><link rel="prefetch" href="/wiki/assets/js/294.6d27f902.js"><link rel="prefetch" href="/wiki/assets/js/3.088a1fd8.js"><link rel="prefetch" href="/wiki/assets/js/30.adfb8799.js"><link rel="prefetch" href="/wiki/assets/js/31.710945ba.js"><link rel="prefetch" href="/wiki/assets/js/32.ae4c36e6.js"><link rel="prefetch" href="/wiki/assets/js/33.10963df3.js"><link rel="prefetch" href="/wiki/assets/js/34.e7d74b83.js"><link rel="prefetch" href="/wiki/assets/js/35.474af6fc.js"><link rel="prefetch" href="/wiki/assets/js/36.974a7df0.js"><link rel="prefetch" href="/wiki/assets/js/37.6c8ef8ea.js"><link rel="prefetch" href="/wiki/assets/js/38.d2d72597.js"><link rel="prefetch" href="/wiki/assets/js/39.5655ee2e.js"><link rel="prefetch" href="/wiki/assets/js/4.70e730be.js"><link rel="prefetch" href="/wiki/assets/js/40.86ed65c7.js"><link rel="prefetch" href="/wiki/assets/js/41.f97571b2.js"><link rel="prefetch" href="/wiki/assets/js/42.aeb7e742.js"><link rel="prefetch" href="/wiki/assets/js/43.4a9657a0.js"><link rel="prefetch" href="/wiki/assets/js/44.3ded2766.js"><link rel="prefetch" href="/wiki/assets/js/45.b84572d5.js"><link rel="prefetch" href="/wiki/assets/js/46.08c1a6ef.js"><link rel="prefetch" href="/wiki/assets/js/47.2daecafa.js"><link rel="prefetch" href="/wiki/assets/js/48.cc5614ec.js"><link rel="prefetch" href="/wiki/assets/js/49.b52dd5d4.js"><link rel="prefetch" href="/wiki/assets/js/5.611833a9.js"><link rel="prefetch" href="/wiki/assets/js/50.90314504.js"><link rel="prefetch" href="/wiki/assets/js/51.d8bcd6b8.js"><link rel="prefetch" href="/wiki/assets/js/52.5603adc6.js"><link rel="prefetch" href="/wiki/assets/js/53.1c2cfb4d.js"><link rel="prefetch" href="/wiki/assets/js/54.69024b12.js"><link rel="prefetch" href="/wiki/assets/js/55.21d8ea7d.js"><link rel="prefetch" href="/wiki/assets/js/56.c582ce3f.js"><link rel="prefetch" href="/wiki/assets/js/57.136b0a6e.js"><link rel="prefetch" href="/wiki/assets/js/58.932cc397.js"><link rel="prefetch" href="/wiki/assets/js/59.6240b708.js"><link rel="prefetch" href="/wiki/assets/js/6.45f8b0b3.js"><link rel="prefetch" href="/wiki/assets/js/60.dee11cbd.js"><link rel="prefetch" href="/wiki/assets/js/61.9e041e23.js"><link rel="prefetch" href="/wiki/assets/js/62.045f27d0.js"><link rel="prefetch" href="/wiki/assets/js/63.fcc4643c.js"><link rel="prefetch" href="/wiki/assets/js/64.402961a6.js"><link rel="prefetch" href="/wiki/assets/js/65.40dfcd16.js"><link rel="prefetch" href="/wiki/assets/js/66.517d1df0.js"><link rel="prefetch" href="/wiki/assets/js/67.0f36010a.js"><link rel="prefetch" href="/wiki/assets/js/68.945fc7e8.js"><link rel="prefetch" href="/wiki/assets/js/69.696f6fe6.js"><link rel="prefetch" href="/wiki/assets/js/7.b48a85c8.js"><link rel="prefetch" href="/wiki/assets/js/70.1bffff80.js"><link rel="prefetch" href="/wiki/assets/js/71.be4a0826.js"><link rel="prefetch" href="/wiki/assets/js/72.339537b2.js"><link rel="prefetch" href="/wiki/assets/js/73.986fd4a7.js"><link rel="prefetch" href="/wiki/assets/js/74.f34e6ad7.js"><link rel="prefetch" href="/wiki/assets/js/75.f0e2631b.js"><link rel="prefetch" href="/wiki/assets/js/76.55aad931.js"><link rel="prefetch" href="/wiki/assets/js/77.0a9e88d4.js"><link rel="prefetch" href="/wiki/assets/js/78.7633297a.js"><link rel="prefetch" href="/wiki/assets/js/79.1456692d.js"><link rel="prefetch" href="/wiki/assets/js/8.ed910aa6.js"><link rel="prefetch" href="/wiki/assets/js/80.e5ba04c0.js"><link rel="prefetch" href="/wiki/assets/js/81.29875264.js"><link rel="prefetch" href="/wiki/assets/js/82.5e98977a.js"><link rel="prefetch" href="/wiki/assets/js/83.a9e289a9.js"><link rel="prefetch" href="/wiki/assets/js/84.214f2913.js"><link rel="prefetch" href="/wiki/assets/js/85.a50f9b57.js"><link rel="prefetch" href="/wiki/assets/js/86.486709a6.js"><link rel="prefetch" href="/wiki/assets/js/87.af59efc5.js"><link rel="prefetch" href="/wiki/assets/js/88.86d6d36d.js"><link rel="prefetch" href="/wiki/assets/js/89.f04d4f29.js"><link rel="prefetch" href="/wiki/assets/js/9.ddf634b9.js"><link rel="prefetch" href="/wiki/assets/js/90.c0a751c4.js"><link rel="prefetch" href="/wiki/assets/js/91.1c9d51ea.js"><link rel="prefetch" href="/wiki/assets/js/92.70a014b5.js"><link rel="prefetch" href="/wiki/assets/js/93.451d0ca7.js"><link rel="prefetch" href="/wiki/assets/js/94.a389f329.js"><link rel="prefetch" href="/wiki/assets/js/95.e9f690e2.js"><link rel="prefetch" href="/wiki/assets/js/96.218b2a7f.js"><link rel="prefetch" href="/wiki/assets/js/97.fb776daa.js"><link rel="prefetch" href="/wiki/assets/js/98.b7ebf734.js"><link rel="prefetch" href="/wiki/assets/js/99.b8f3c796.js">
    <link rel="stylesheet" href="/wiki/assets/css/0.styles.28a8e502.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki/" class="home-link router-link-active"><!----> <span class="site-name">TIL wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/pravusid/TIL" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/pravusid/TIL" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Jest</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki/Node.js/jest.html#기존의-javascript-test-stack" class="sidebar-link">기존의 JavaScript test stack</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wiki/Node.js/jest.html#실행환경-및-순서" class="sidebar-link">실행환경 및 순서</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wiki/Node.js/jest.html#node-env" class="sidebar-link">NODE_ENV</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wiki/Node.js/jest.html#jest설정-typescript기준" class="sidebar-link">jest설정 (TypeScript기준)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#tsconfig-별도-적용" class="sidebar-link">tsconfig 별도 적용</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#isolated-modules" class="sidebar-link">Isolated Modules</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#ts-jest-alternative" class="sidebar-link">ts-jest alternative</a></li></ul></li><li><a href="/wiki/Node.js/jest.html#실행" class="sidebar-link">실행</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wiki/Node.js/jest.html#기본-문법" class="sidebar-link">기본 문법</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#test-case" class="sidebar-link">Test Case</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#matcher" class="sidebar-link">matcher</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#teardown" class="sidebar-link">teardown</a></li></ul></li><li><a href="/wiki/Node.js/jest.html#test-environment" class="sidebar-link">Test Environment</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wiki/Node.js/jest.html#mocking" class="sidebar-link">Mocking</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#생성" class="sidebar-link">생성</a></li></ul></li><li><a href="/wiki/Node.js/jest.html#mocking-testing-예제" class="sidebar-link">Mocking &amp; Testing 예제</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#mocking-function" class="sidebar-link">mocking function</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#mocking-prototype" class="sidebar-link">mocking prototype</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#mocking-module-with-type" class="sidebar-link">mocking module with type</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#mocking-module-with-modulefactory" class="sidebar-link">mocking module with moduleFactory</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#ts-jest-mocked-helper" class="sidebar-link">ts-jest mocked helper</a></li><li class="sidebar-sub-header"><a href="/wiki/Node.js/jest.html#mock-date" class="sidebar-link">Mock Date</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jest"><a href="#jest" class="header-anchor">#</a> Jest</h1> <p><a href="https://jestjs.io/docs/en/getting-started.html" target="_blank" rel="noopener noreferrer">https://jestjs.io/docs/en/getting-started.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Facebook 에서 주도하는 자바스크립트 테스트 툴 (React와 함께 성장)</p> <h2 id="기존의-javascript-test-stack"><a href="#기존의-javascript-test-stack" class="header-anchor">#</a> 기존의 JavaScript test stack</h2> <ul><li>test runner : Mocha</li> <li>assertion(문법) : Chai</li> <li>mocking : Sinon</li> <li>coverage : Istanbul</li></ul> <h2 id="실행환경-및-순서"><a href="#실행환경-및-순서" class="header-anchor">#</a> 실행환경 및 순서</h2> <ul><li><a href="https://jestjs.io/docs/en/architecture" target="_blank" rel="noopener noreferrer">https://jestjs.io/docs/en/architecture<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/facebook/jest/issues/6957" target="_blank" rel="noopener noreferrer">https://github.com/facebook/jest/issues/6957<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>각 테스트 파일은 기본적으로 병렬로 실행되고 독립적인 런타임 환경을 가짐</p> <ul><li><a href="https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-core/src/runJest.ts#L140" target="_blank" rel="noopener noreferrer">https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-core/src/runJest.ts#L140<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-core/src/TestScheduler.ts#L92" target="_blank" rel="noopener noreferrer">https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-core/src/TestScheduler.ts#L92<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-runner/src/index.ts#L53" target="_blank" rel="noopener noreferrer">https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-runner/src/index.ts#L53<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-runner/src/runTest.ts#L385" target="_blank" rel="noopener noreferrer">https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-runner/src/runTest.ts#L385<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-runtime/src/index.ts#L164" target="_blank" rel="noopener noreferrer">https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-runtime/src/index.ts#L164<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote><p><a href="https://jestjs.io/docs/en/cli#--runinband" target="_blank" rel="noopener noreferrer"><code>--runInBand</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 옵션으로 순차실행할 수 있음 (디버그 용도로 적합)</p></blockquote> <p>각 테스트 파일 내에서는</p> <ul><li>테스트를 실행하기 전 모든 <code>describe</code> 핸들러를 실행한다</li> <li>각 테스트가 셋업-실행-완료-정리 되기를 기다리면서 모든 테스트(<code>test</code>, <code>it</code>)를 순차 실행한다 (비동기 함수도 마찬가지임)</li></ul> <blockquote><p><a href="https://jestjs.io/docs/en/setup-teardown.html#order-of-execution-of-describe-and-test-blocks" target="_blank" rel="noopener noreferrer">https://jestjs.io/docs/en/setup-teardown.html#order-of-execution-of-describe-and-test-blocks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li><a href="https://github.com/facebook/jest/blob/master/packages/jest-circus/src/run.ts" target="_blank" rel="noopener noreferrer">https://github.com/facebook/jest/blob/master/packages/jest-circus/src/run.ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/facebook/jest/blob/master/packages/jest-circus/src/eventHandler.ts" target="_blank" rel="noopener noreferrer">https://github.com/facebook/jest/blob/master/packages/jest-circus/src/eventHandler.ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="node-env"><a href="#node-env" class="header-anchor">#</a> NODE_ENV</h2> <p>jest 기본 <code>NODE_ENV</code>는 <code>test</code>임</p> <blockquote><p><a href="https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-cli/bin/jest.js#L12-L14" target="_blank" rel="noopener noreferrer">https://github.com/jestjs/jest/blob/21cce70205025decc778f4aac2ec76051f589fd7/packages/jest-cli/bin/jest.js#L12-L14<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="jest설정-typescript기준"><a href="#jest설정-typescript기준" class="header-anchor">#</a> jest설정 (TypeScript기준)</h2> <ul><li><a href="https://jest-bot.github.io/jest/docs/configuration.html" target="_blank" rel="noopener noreferrer">https://jest-bot.github.io/jest/docs/configuration.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://jestjs.io/docs/en/configuration" target="_blank" rel="noopener noreferrer">https://jestjs.io/docs/en/configuration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://kulshekhar.github.io/ts-jest/docs/getting-started/options" target="_blank" rel="noopener noreferrer">https://kulshekhar.github.io/ts-jest/docs/getting-started/options<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><code>npm i -D @types/jest jest ts-jest</code></p> <p><code>packages.json</code></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test:watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest --watch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test:cov&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest --coverage&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>jest.config.js</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/** @type {import('ts-jest/dist/types').InitialOptionsTsJest} */</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  globalSetup<span class="token operator">:</span> <span class="token string">'&lt;rootDir&gt;/src/__tests__/global-setup.ts'</span><span class="token punctuation">,</span> <span class="token comment">// triggered once before all test suites</span>
  globalTeardown<span class="token operator">:</span> <span class="token string">'&lt;rootDir&gt;/src/__tests__/global-teardown.ts'</span><span class="token punctuation">,</span> <span class="token comment">// triggered once after all test suites</span>
  setupFiles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'dotenv/config'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// run once per test file</span>
  setupFilesAfterEnv<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'&lt;rootDir&gt;/src/__tests__/global.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// run once per test file</span>
  moduleFileExtensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'jsx'</span><span class="token punctuation">,</span> <span class="token string">'json'</span><span class="token punctuation">,</span> <span class="token string">'ts'</span><span class="token punctuation">,</span> <span class="token string">'tsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  testRegex<span class="token operator">:</span> <span class="token string">'^.+\\.spec\\.(js|jsx|ts|tsx)$'</span><span class="token punctuation">,</span>
  transform<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'^.+\\.(ts|tsx)$'</span><span class="token operator">:</span> <span class="token string">'ts-jest'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  coverageDirectory<span class="token operator">:</span> <span class="token string">'coverage'</span><span class="token punctuation">,</span>
  collectCoverageFrom<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/**/*.{js,jsx,ts,tsx}'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  testEnvironment<span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>setup|teardown.js</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="tsconfig-별도-적용"><a href="#tsconfig-별도-적용" class="header-anchor">#</a> tsconfig 별도 적용</h3> <p><code>jest.config.js</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  globals<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'ts-jest'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      tsconfig<span class="token operator">:</span> <span class="token string">'tsconfig.spec.json'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>tsconfig.spec.json</code></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./tsconfig.base.json&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;jest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;strict&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/**/*.spec.*&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.js&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="isolated-modules"><a href="#isolated-modules" class="header-anchor">#</a> Isolated Modules</h3> <ul><li><a href="https://www.typescriptlang.org/tsconfig#isolatedModules" target="_blank" rel="noopener noreferrer">https://www.typescriptlang.org/tsconfig#isolatedModules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://kulshekhar.github.io/ts-jest/docs/getting-started/options/isolatedModules" target="_blank" rel="noopener noreferrer">https://kulshekhar.github.io/ts-jest/docs/getting-started/options/isolatedModules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/kulshekhar/ts-jest/issues/259" target="_blank" rel="noopener noreferrer">https://github.com/kulshekhar/ts-jest/issues/259<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/kulshekhar/ts-jest/issues/1115" target="_blank" rel="noopener noreferrer">https://github.com/kulshekhar/ts-jest/issues/1115<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>기본적으로 <code>ts-jest</code>는 full type-checking 기능이 활성화된 프로젝트 context의 타입스크립트 컴파일러를 사용한다.</p> <p>그러나 타입스크립트의 'isolated module' 기능으로 각 파일을 별도로 컴파일 할 수 있다.
이 경우 type-checking 및 <code>const</code>, <code>enum</code>, <code>namespace</code> 등의 일부 기능을 활용할 수 없으나 캐시가 없는 환경에서 더 빠르게 테스트를 실행할 수 있다.</p> <p><code>jest.config.js</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  globals<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'ts-jest'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      isolatedModules<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>참고 (ts-loader case): <a href="https://github.com/TypeStrong/ts-loader#transpileonly" target="_blank" rel="noopener noreferrer">https://github.com/TypeStrong/ts-loader#transpileonly<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="ts-jest-alternative"><a href="#ts-jest-alternative" class="header-anchor">#</a> ts-jest alternative</h3> <ul><li><a href="https://github.com/aelbore/esbuild-jest" target="_blank" rel="noopener noreferrer">https://github.com/aelbore/esbuild-jest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/swc-project/jest" target="_blank" rel="noopener noreferrer">https://github.com/swc-project/jest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="실행"><a href="#실행" class="header-anchor">#</a> 실행</h2> <p>유닛 테스트를 위한 파일명이 <code>___.spec.js/ts</code>로 끝나게 한다</p> <ul><li>전체 실행: <code>jest</code></li> <li>코드 변경시 테스트 실행: <code>jest --watch</code></li> <li>부분 실행 <code>--testNamePattern(-t) '&lt;regexp&gt;'</code></li> <li>부분 실행: <code>--watch '&lt;regexp&gt;'</code></li></ul> <h2 id="기본-문법"><a href="#기본-문법" class="header-anchor">#</a> 기본 문법</h2> <h3 id="test-case"><a href="#test-case" class="header-anchor">#</a> Test Case</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'my beverage'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'is delicious'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>myBeverage<span class="token punctuation">.</span>delicious<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'is not sour'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>myBeverage<span class="token punctuation">.</span>sour<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeFalsy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><p><code>describe</code>: 테스트 묶음</p> <ul><li><code>describe.each(table)(name, fn, timeout)</code></li> <li><code>describe.only(name, fn)</code></li> <li><code>describe.only.each(table)(name, fn)</code></li> <li><code>describe.skip(name, fn)</code></li> <li><code>describe.skip.each(table)(name, fn)</code></li></ul></li> <li><p><code>test</code>: 개별 test case</p> <ul><li><code>test(name, fn, timeout)</code></li> <li><code>test.each(table)(name, fn, timeout)</code></li> <li><code>test.only(name, fn, timeout)</code></li> <li><code>test.only.each(table)(name, fn)</code></li> <li><code>test.skip(name, fn)</code></li> <li><code>test.skip.each(table)(name, fn)</code></li></ul></li> <li><p><code>it</code>: test의 alias (BDD 문법)</p></li></ul> <h3 id="matcher"><a href="#matcher" class="header-anchor">#</a> matcher</h3> <ul><li><p><code>expect({object})</code></p></li> <li><p><code>toBe({object})</code>: 타입과 값 검사</p></li> <li><p><code>toEqual({object})</code>: 값 검사</p></li> <li><p><code>toBeNull()</code>: null임을 검사</p></li> <li><p><code>toBeUndefined()</code>: undefined임을 검사</p></li> <li><p><code>toThrow({Error})</code>: Error가 발생하는지 확인한다</p></li> <li><p>...</p></li> <li><p><code>not</code>: 위의 matcher의 부정형</p> <ul><li><code>not.toBeNull()</code>: null이 아님을 검사</li> <li>...</li></ul></li></ul> <h3 id="teardown"><a href="#teardown" class="header-anchor">#</a> teardown</h3> <h4 id="여러-테스트를-위한-반복적-setup"><a href="#여러-테스트를-위한-반복적-setup" class="header-anchor">#</a> 여러 테스트를 위한 반복적 setup</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">initializeCityDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">clearCityDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'city database has Vienna'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">isCity</span><span class="token punctuation">(</span><span class="token string">'Vienna'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'city database has San Juan'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">isCity</span><span class="token punctuation">(</span><span class="token string">'San Juan'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>setup들은 테스트와 마찬가지로 비동기를 코드를 다룬다.
만약 <code>initializeCityDatabase()</code>가 promise를 반환할 때 다음처럼 쓰면 setup은 비동기 코드를 처리해준다.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">initializeCityDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_1회성-setup"><a href="#_1회성-setup" class="header-anchor">#</a> 1회성 setup</h4> <p>만약 파일의 시작에서 한 번의 setup만 필요하다면 다음처럼 기술하면 된다.
마찬가지로 비동기를 처리하려면 promise를 반환하면 setup 메소드가 처리해준다.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">initializeCityDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">clearCityDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'city database has Vienna'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">isCity</span><span class="token punctuation">(</span><span class="token string">'Vienna'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'city database has San Juan'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">isCity</span><span class="token punctuation">(</span><span class="token string">'San Juan'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="scoping"><a href="#scoping" class="header-anchor">#</a> scoping</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1 - beforeAll'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1 - afterAll'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1 - beforeEach'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1 - afterEach'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1 - test'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Scoped / Nested block'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2 - beforeAll'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2 - afterAll'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2 - beforeEach'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2 - afterEach'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2 - test'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1 - beforeAll</span>
<span class="token comment">// 1 - beforeEach</span>
<span class="token comment">// 1 - test</span>
<span class="token comment">// 1 - afterEach</span>
<span class="token comment">// 2 - beforeAll</span>
<span class="token comment">// 1 - beforeEach</span>
<span class="token comment">// 2 - beforeEach</span>
<span class="token comment">// 2 - test</span>
<span class="token comment">// 2 - afterEach</span>
<span class="token comment">// 1 - afterEach</span>
<span class="token comment">// 2 - afterAll</span>
<span class="token comment">// 1 - afterAll</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="test-environment"><a href="#test-environment" class="header-anchor">#</a> Test Environment</h2> <p><a href="https://jestjs.io/docs/en/configuration#testenvironment-string" target="_blank" rel="noopener noreferrer">https://jestjs.io/docs/en/configuration#testenvironment-string<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>testEnvironment: &quot;./testEnvironment&quot;</code> for the file testEnvironment.js</p> <h2 id="mocking"><a href="#mocking" class="header-anchor">#</a> Mocking</h2> <h3 id="생성"><a href="#생성" class="header-anchor">#</a> 생성</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> mock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p><code>mockFn.getMockName()</code>: get mockname</p></li> <li><p><code>mockFn.mockName(value)</code>: set mockname</p></li> <li><p><code>mockFn.mock.calls</code>: mock 함수가 호출될 때 마다 인자들이 배열로 누적됨</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'arg1'</span><span class="token punctuation">,</span> <span class="token string">'arg2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'arg3'</span><span class="token punctuation">,</span> <span class="token string">'arg4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><code>mockFn.mock.results</code>: 호출의 결과 object들이 배열로 누적됨</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    isThrow<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'result1'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    isThrow<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">/* Error instance */</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    isThrow<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'result2'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li> <li><p><code>mockFn.mock.instances</code>: <code>new jest.fn()</code>으로 인스턴스화된 mock function의 배열</p></li> <li><p><code>mockFn.mockClear()</code>: mockFn.mock을 초기화</p></li> <li><p><code>mockFn.mockReset()</code>: clear의 기능 + mock return value or implementation 삭제</p></li> <li><p><code>mockFn.mockRestore()</code>: jest.spyOn으로 생성된 스파이객체를 초기상태(non-mocked implementation)로 되돌림</p></li> <li><p><code>mockFn.mockImplementation(fn)</code>: mock에게 함수구현을 부여한다. 클래스 생성자로 사용될 수도 있다.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> mockFn <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">scalar</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">42</span> <span class="token operator">+</span> scalar<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or: jest.fn(scalar =&gt; 42 + scalar);</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token function">mockFn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

a <span class="token operator">===</span> <span class="token number">42</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
b <span class="token operator">===</span> <span class="token number">43</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

mockFn<span class="token punctuation">.</span>mock<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
mockFn<span class="token punctuation">.</span>mock<span class="token punctuation">.</span>calls<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p><code>mockFn.mockImplementationOnce(fn)</code>: 위와 같지만, mock이 한번 호출될 때 까지만 작동한다</p></li> <li><p><code>mockFn.mockReturnThis()</code>: this를 반환하는 mock 함수를 생성한다</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><code>mockFn.mockReturnValue(value)</code>: 입력해둔 값을 반환하는 mock 함수를 생성한다</p></li> <li><p><code>mockFn.mockReturnValueOnce(value)</code>: 위와 같지만 mock이 한번 호출될 때 까지만 작동한다.</p></li> <li><p><code>mockFn.mockResolvedValue(value)</code>: Promise.resolve로 wrapping된 값을 반환한다</p></li> <li><p><code>mockFn.mockResolvedValueOnce(value)</code>: 위의 행동을 한번만 수행한다</p></li> <li><p><code>mockFn.mockRejectedValue(value)</code>: Promise.reject로 wrapping된 값을 반환한다</p></li> <li><p><code>mockFn.mockRejectedValueOnce(value)</code>: 위의 행동을 한번만 수행한다</p></li></ul> <h2 id="mocking-testing-예제"><a href="#mocking-testing-예제" class="header-anchor">#</a> Mocking &amp; Testing 예제</h2> <h3 id="mocking-function"><a href="#mocking-function" class="header-anchor">#</a> mocking function</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getRepository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> UserDto <span class="token keyword">from</span> <span class="token string">'../user/user.dto'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> AuthenticationService <span class="token keyword">from</span> <span class="token string">'./authentication.service'</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span>getRepository <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'should not throw an error'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> userData<span class="token operator">:</span> UserDto <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'Hong Gildong'</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> <span class="token string">'gdhong@chosun.com'</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">'somepassword'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  getRepository<span class="token punctuation">.</span><span class="token function">mockReturnValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">findOne</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">create</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>userData<span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">save</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> authenticationService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthenticationService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">expect</span><span class="token punctuation">(</span>authenticationService<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>userData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>resolves<span class="token punctuation">.</span><span class="token function">toBeDefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="mocking-prototype"><a href="#mocking-prototype" class="header-anchor">#</a> mocking prototype</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Users <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./users'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Http <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./common/http'</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'should get receive an error'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Users</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Http<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>get <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Something weird happened'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> error<span class="token operator">:</span> Error <span class="token operator">=</span> <span class="token keyword">await</span> instance<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">expect</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeInstanceOf</span><span class="token punctuation">(</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'Something weird happened'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="mocking-module-with-type"><a href="#mocking-module-with-type" class="header-anchor">#</a> mocking module with type</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AnalyticsApi <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../api/src'</span><span class="token punctuation">;</span>
jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'../../api/src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>AnalyticsApi <span class="token keyword">as</span> jest<span class="token punctuation">.</span>Mock<span class="token operator">&lt;</span>AnalyticsApi<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      listPolicies<span class="token operator">:</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockResolvedValue</span><span class="token punctuation">(</span><span class="token string">'promiseValue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>AnalyticsApi <span class="token keyword">as</span> jest<span class="token punctuation">.</span>Mock<span class="token operator">&lt;</span>AnalyticsApi<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockClear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="mocking-module-with-modulefactory"><a href="#mocking-module-with-modulefactory" class="header-anchor">#</a> mocking module with moduleFactory</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// tester.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> resolveWhenever <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./testable'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useResoveWhenever</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolveWhenever</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'now'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// tester.test.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useResoveWhenever <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./tester'</span><span class="token punctuation">;</span>
jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'./testable'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">resolveWhenever</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">then</span><span class="token operator">:</span> <span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'logs after resolve'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> logSpy <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span><span class="token builtin">console</span><span class="token punctuation">,</span> <span class="token string">'log'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useResoveWhenever</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>logSpy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="ts-jest-mocked-helper"><a href="#ts-jest-mocked-helper" class="header-anchor">#</a> ts-jest <code>mocked</code> helper</h3> <p><a href="https://kulshekhar.github.io/ts-jest/user/test-helpers" target="_blank" rel="noopener noreferrer">https://kulshekhar.github.io/ts-jest/user/test-helpers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// foo.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token punctuation">{</span>
    b<span class="token operator">:</span> <span class="token punctuation">{</span>
      c<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">hello</span><span class="token operator">:</span> <span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// foo.spec.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mocked <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ts-jest/utils'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo'</span><span class="token punctuation">;</span>
jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'./foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// here the whole foo var is mocked deeply</span>
<span class="token keyword">const</span> mockedFoo <span class="token operator">=</span> <span class="token function">mocked</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'deep'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// there will be no TS error here, and you'll have completion in modern IDEs</span>
  mockedFoo<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">'me'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// same here</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>mockedFoo<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c<span class="token punctuation">.</span>hello<span class="token punctuation">.</span>mock<span class="token punctuation">.</span>calls<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'direct'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  foo<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// here only foo.name is mocked (or its methods if it's an object)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">mocked</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>mock<span class="token punctuation">.</span>calls<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="mock-date"><a href="#mock-date" class="header-anchor">#</a> Mock Date</h3> <blockquote><p>Date 모의객체 적용은 global을 조작하는 것이므로 동일 실행환경의 다른 테스트케이스에 영향을 줄 수 있다.
다만 분리된 파일의 테스트는 별도 실행환경으로 작동하므로 전역 객체 조작이 영향을 주지 않는다. <a href="#%EC%8B%A4%ED%96%89%ED%99%98%EA%B2%BD-%EB%B0%8F-%EC%88%9C%EC%84%9C">실행환경 참고</a></p></blockquote> <p><code>moment</code>, <code>dayjs</code> 라이브러리 mocking을 위해서는 <code>Date.now</code> 값만 변경해도 된다</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Date<span class="token punctuation">.</span>now <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2020-10-25T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
Date<span class="token punctuation">.</span>now <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockReturnValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2020-10-25T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>Date<span class="token punctuation">,</span> <span class="token string">'now'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mockImplementation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2020-10-25T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Date 객체를 mocking 하기 위해서는 다음 라이브러리를 고려해 볼 수 있다</p> <p><a href="https://github.com/boblauer/MockDate" target="_blank" rel="noopener noreferrer">https://github.com/boblauer/MockDate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/wiki/assets/js/app.c38ade27.js" defer></script><script src="/wiki/assets/js/2.05cc4ee4.js" defer></script><script src="/wiki/assets/js/186.04955f1e.js" defer></script>
  </body>
</html>
