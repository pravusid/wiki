(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{384:function(t,s,a){"use strict";a.r(s);var n=a(28),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"aws-kms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#aws-kms"}},[t._v("#")]),t._v(" AWS KMS")]),t._v(" "),a("p",[t._v("AWS Key Management System")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://docs.aws.amazon.com/ko_kr/kms/latest/developerguide/overview.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.aws.amazon.com/ko_kr/kms/latest/developerguide/overview.html"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("암호화키 관리 서비스")]),t._v(" "),a("ul",[a("li",[t._v("사용자가 접근할 수 없는 관리형 키로 AWS의 다양한 서비스 (RDS, DynamoDB ...) 암호화를 자동실행할 수 있음")]),t._v(" "),a("li",[t._v("사용자가 관리하는 키(CMK)로 직접 암/복호화를 수행할 수 있음")])]),t._v(" "),a("h2",{attrs:{id:"kms-키-계층구조"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kms-키-계층구조"}},[t._v("#")]),t._v(" KMS 키 계층구조")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("CMK (Client Master Key)")]),t._v(" "),a("ul",[a("li",[t._v("HSM(Hardware Security Module): 평문 CMK생성 -> 도메인키로 암호화")]),t._v(" "),a("li",[t._v("KMS Host(스토리지): 암호화 CMK 저장")])])]),t._v(" "),a("li",[a("p",[t._v("DataKey")]),t._v(" "),a("ul",[a("li",[t._v("HSM: 평문 데이터키 생성 -> 평문 CMK로 암호화")]),t._v(" "),a("li",[t._v("클라이언트: 평문 데이터키 + 암호화 데이터키 수신")])])]),t._v(" "),a("li",[a("p",[t._v("직접 KMS 암복호화")]),t._v(" "),a("ul",[a("li",[t._v("HSM에서 암복호화 수행")]),t._v(" "),a("li",[t._v("원본 데이터는 4KB로 제한됨")])])])]),t._v(" "),a("h2",{attrs:{id:"대칭-datakey-암복호화"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#대칭-datakey-암복호화"}},[t._v("#")]),t._v(" 대칭 DataKey 암복호화")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("GenerateDataKey")]),t._v(": 평문 및 암호화 DataKey 생성")]),t._v(" "),a("ul",[a("li",[t._v("평문키: 데이터 암호화에 사용 후 폐기")]),t._v(" "),a("li",[t._v("암호화키: 복호화를 위해서 암호화 된 데이터와 함께 보관")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Decrypt")]),t._v(": 암호화 데이터키 복호화 -> 평문 데이터키")])])]),t._v(" "),a("h2",{attrs:{id:"비대칭-datakey-암복호화"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#비대칭-datakey-암복호화"}},[t._v("#")]),t._v(" 비대칭 DataKey 암복호화")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("GenerateDateKeyPair")]),t._v(": 암호화 비밀키, 비밀키, 공개키 생성")]),t._v(" "),a("li",[a("code",[t._v("Decrypt")]),t._v(": 암호화 비밀키 복호화 -> 평문 비밀키")])]),t._v(" "),a("h2",{attrs:{id:"직접-kms-암복호화"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#직접-kms-암복호화"}},[t._v("#")]),t._v(" 직접 KMS 암복호화")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Encrypt")]),t._v(": 평문 암호화 요청")]),t._v(" "),a("li",[a("code",[t._v("Decrypt")]),t._v(": 암호문 복호화 요청")])]),t._v(" "),a("h2",{attrs:{id:"예제"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#예제"}},[t._v("#")]),t._v(" 예제")]),t._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'데이터키 생성 후 복호화'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" awsKms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateDataKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" KeyId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" awsKmsKeyId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" KeySpec"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AES_256'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" plainText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Plaintext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hex'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DEBUG: key plain'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plainText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plainText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// DEBUG: key plain 64 f17fd6182d4a424e3a1fd521f91ccd3e4cb046147e39618a59cd74e6f2c2934e")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cipherText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CiphertextBlob"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'base64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DEBUG: key cipher'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cipherText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cipherText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// DEBUG: key cipher 248 AQIDAHibNNbamTy5G37jNxgsywbPN1PEVfY0WLKWJPEGqaUsHQGyg8meJHuzz2/0TcL79E5UAAAAfiB8BgkqhkiG9w0BBwagbzBtAgEAMGgGCSqGSIb3DQEHATAeBglghkgBZQMEAS4wEQQMx+6hAzlAaXI/z9z5AgEQgDtJgHdda/U8Zr0/4FjJADt2biqDzaqP2UBX8BfKos9TcpxdDew1/e3W6vU9gWi64O/0NNoP85xa7rjS1w==")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" decrypted "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" awsKms\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("decrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" KeyId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" awsKmsKeyId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CiphertextBlob"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cipherText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'base64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" decryptedText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" decrypted"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Plaintext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hex'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DEBUG: decrypted'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" decryptedText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// DEBUG: decrypted f17fd6182d4a424e3a1fd521f91ccd3e4cb046147e39618a59cd74e6f2c2934e")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("plainText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toEqual")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("decryptedText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);