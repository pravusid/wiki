(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{388:function(t,e,a){"use strict";a.r(e);var s=a(17),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"tls-certificate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tls-certificate"}},[t._v("#")]),t._v(" TLS Certificate")]),t._v(" "),a("h2",{attrs:{id:"root-ca-certificate-authorities"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#root-ca-certificate-authorities"}},[t._v("#")]),t._v(" Root CA(certificate authorities)")]),t._v(" "),a("p",[t._v("최상위 인증기관")]),t._v(" "),a("h2",{attrs:{id:"intermediate-certificate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intermediate-certificate"}},[t._v("#")]),t._v(" Intermediate certificate")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Chain_of_trust",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://en.wikipedia.org/wiki/Chain_of_trust"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("Root CA는 이름 그대로 인증서 신뢰 관계의 원점(Trust anchor)이기 때문에 Root CA가 훼손될 경우 신뢰 구조 전체가 무너지게 됩니다.\n따라서 네트워크에서 분리된(Air Gapped 또는 오프라인) 환경에서 안전하게 관리되어야 합니다(이런 부분이 잘 관리되고 있는지 검증받아야 CA가 될 수 있기도 합니다).\n이렇게 Root CA는 중간 CA를 발급(서명)하는 경우에만 제한적으로 사용되고,\nRoot CA를 이용해 발급한 중간 CA만 시스템 상에 온라인으로 두고 Leaf 인증서 발급(서명)에 사용하는 위와 같은 구조가 되는 것입니다.")])]),t._v(" "),a("p",[t._v("from: "),a("a",{attrs:{href:"https://engineering.linecorp.com/ko/blog/best-practices-to-secure-your-ssl-tls/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://engineering.linecorp.com/ko/blog/best-practices-to-secure-your-ssl-tls/"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Root CA의 경우 브라우저나 기본 KeyStore에 포함되어 있다.\n하지만 Intermediate Certificate는 포함되지 않을 수 있으므로 TLS 제공자의 서버에서 제공해야 한다.")]),t._v(" "),a("h2",{attrs:{id:"domain-certificate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#domain-certificate"}},[t._v("#")]),t._v(" Domain certificate")]),t._v(" "),a("blockquote",[a("p",[t._v("CA로 부터 인증을 받을 수 있다")])]),t._v(" "),a("p",[t._v("예를 들어, Let’s Encrypt 경우 인증을 받으면 다음 파일들이 생성된다")]),t._v(" "),a("ul",[a("li",[t._v("privkey.pem: 도메인 인증서의 개인키")]),t._v(" "),a("li",[t._v("cert.pem: 서명된 도메인 인증서")])]),t._v(" "),a("p",[t._v("CA 정보를 담은 파일도 함께 생성된다")]),t._v(" "),a("ul",[a("li",[t._v("chain.pem: Let’s Encrypt의 중간 인증서(intermediate certificate)")]),t._v(" "),a("li",[t._v("fullchain.pem: "),a("code",[t._v("cert + chain")])])]),t._v(" "),a("h2",{attrs:{id:"self-signed-certificate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#self-signed-certificate"}},[t._v("#")]),t._v(" Self-signed Certificate")]),t._v(" "),a("p",[t._v("OpenSSL을 사용하여 Self Signed Certificate를 생성할 수 있다.")]),t._v(" "),a("h3",{attrs:{id:"root-ca"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#root-ca"}},[t._v("#")]),t._v(" Root CA")]),t._v(" "),a("p",[t._v("Root CA의 개인키를 생성한다: "),a("code",[t._v("openssl genrsa -aes256 -out root-ca.key 2048")])]),t._v(" "),a("p",[t._v("CSR로 Root CA 인증서 생성: "),a("code",[t._v("openssl req -x509 -new -nodes -key root-ca.key -sha256 -days 1825 -out root-ca.crt")])]),t._v(" "),a("p",[t._v("대화형으로 진행됨")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("Enter pass phrase "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" myCA.key:\n-----\nCountry Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" letter code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nState or Province Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("full name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nLocality Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, city"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOrganization Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, company"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOrganizational Unit Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eg, section"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCommon Name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e.g. server FQDN or YOUR name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nEmail Address\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"ca-signed-cert-for-my-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ca-signed-cert-for-my-server"}},[t._v("#")]),t._v(" CA-signed Cert for My Server")]),t._v(" "),a("p",[t._v("서버 비밀키 생성: "),a("code",[t._v("openssl genrsa -out myserver.key 2048")])]),t._v(" "),a("p",[t._v("CSR 생성(대화형으로 진행됨): "),a("code",[t._v("openssl req -new -key myserver.key -out myserver.csr")])]),t._v(" "),a("p",[t._v("CSR 검증: "),a("code",[t._v("openssl req -in myserver.csr -noout -text")])]),t._v(" "),a("h4",{attrs:{id:"서버-인증서-생성-fdqn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#서버-인증서-생성-fdqn"}},[t._v("#")]),t._v(" 서버 인증서 생성: FDQN")]),t._v(" "),a("p",[t._v("Fully Qualified Domain Name (FDQN): 기존의 고유이름 방식 ("),a("code",[t._v("[hostname].[domain].[tld]")]),t._v(")")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("openssl x509 -req -in myserver.csr -CA root-ca.crt -CAkey root-ca.key -CAcreateserial "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -out myserver.crt -days "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1825")]),t._v(" -sha256\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h4",{attrs:{id:"서버-인증서-생성-san"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#서버-인증서-생성-san"}},[t._v("#")]),t._v(" 서버 인증서 생성: SAN")]),t._v(" "),a("p",[t._v("Subject Alternative Name (SAN): 멀티 도메인 인증을 위한 방식")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("openssl x509 -req -in myserver.csr -CA root-ca.crt -CAkey root-ca.key -CAcreateserial "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -extfile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("printf")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"subjectAltName=DNS:example.com,DNS:example.net,IP:10.0.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -out myserver.crt -days "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1825")]),t._v(" -sha256\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"검증"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#검증"}},[t._v("#")]),t._v(" 검증")]),t._v(" "),a("p",[a("code",[t._v("openssl x509 -in myserver.crt -text -noout")])]),t._v(" "),a("h3",{attrs:{id:"통신"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#통신"}},[t._v("#")]),t._v(" 통신")]),t._v(" "),a("p",[t._v("자체서명 인증서 과정에서 다음파일들이 생성된다")]),t._v(" "),a("ul",[a("li",[t._v("root CA 비밀키")]),t._v(" "),a("li",[t._v("root CA 인증서")]),t._v(" "),a("li",[t._v("서버 개인키")]),t._v(" "),a("li",[t._v("서버 인증서")])]),t._v(" "),a("p",[t._v("서버에서는 다음 파일을 가지고 클라이언트 요청을 받는다")]),t._v(" "),a("ul",[a("li",[t._v("서버 개인키")]),t._v(" "),a("li",[t._v("서버 인증서")])]),t._v(" "),a("blockquote",[a("p",[t._v("자체 서명은 사설 root CA 직접 서명이므로 인증서 chain은 필요없다")])]),t._v(" "),a("p",[t._v("클라이언트는 다음 파일을 가지고 자체서명 인증서를 사용하는 서버에 요청한다")]),t._v(" "),a("ul",[a("li",[t._v("root CA 인증서")])]),t._v(" "),a("p",[t._v("또는 클라이언트에서 "),a("code",[t._v("rejectUnauthorized = false")]),t._v("를 사용할 수도 있다 (인증서 검증하지 않음)")]),t._v(" "),a("h2",{attrs:{id:"two-way-ssl-communication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#two-way-ssl-communication"}},[t._v("#")]),t._v(" Two-way SSL communication")]),t._v(" "),a("p",[t._v("클라이언트 인증이라고도 불린다")]),t._v(" "),a("ul",[a("li",[t._v("클라이언트의 인증서와 서버의 인증서를 각각 생성")]),t._v(" "),a("li",[t._v("클라이언트와 서버 각각에서 신뢰할 수 있는 CA에 상호의 인증서를 추가")]),t._v(" "),a("li",[t._v("양쪽 모두가 신뢰할 수 있는 상황이 아니면 연결을 거부")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.ibm.com/support/knowledgecenter/SSRMWJ_7.0.1.13/com.ibm.isim.doc/securing/cpt/cpt_ic_security_ssl_scenario.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.ibm.com/support/knowledgecenter/SSRMWJ_7.0.1.13/com.ibm.isim.doc/securing/cpt/cpt_ic_security_ssl_scenario.html"),a("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);