(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{393:function(t,e,r){"use strict";r.r(e);var a=r(28),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"mono-repository-monorepo"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mono-repository-monorepo"}},[t._v("#")]),t._v(" Mono Repository (monorepo)")]),t._v(" "),r("p",[t._v("Mono Repository(이하 monorepo)는 관련 패키지들을 단일 저장소에서 함께 관리하는 방법론이다")]),t._v(" "),r("h2",{attrs:{id:"articles-examples"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#articles-examples"}},[t._v("#")]),t._v(" articles, examples")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("overview")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://monorepo.tools/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://monorepo.tools/"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://d2.naver.com/helloworld/0923884",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://d2.naver.com/helloworld/0923884"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://d2.naver.com/helloworld/7553804",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://d2.naver.com/helloworld/7553804"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("p",[t._v("Nx")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/ddd-by-examples/library-nestjs",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/ddd-by-examples/library-nestjs"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("p",[t._v("Turborepo")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://engineering.linecorp.com/ko/blog/monorepo-with-turborepo",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://engineering.linecorp.com/ko/blog/monorepo-with-turborepo"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("p",[t._v("Rush")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://medium.com/mildang/rush%EB%A1%9C-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C-%EB%AA%A8%EB%85%B8%EB%A0%88%ED%8F%AC-%EB%8F%84%EC%9E%85%EA%B8%B0-5da0c5bc9b30",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://medium.com/mildang/rush로-프론트엔드-모노레포-도입기-5da0c5bc9b30"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://dev.to/kkazala/series/17133",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://dev.to/kkazala/series/17133"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("p",[t._v("Lerna")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://medium.com/jung-han/lerna-%EB%A1%9C-%EB%AA%A8%EB%85%B8%EB%A0%88%ED%8F%AC-%ED%95%B4%EB%B3%B4%EB%9F%AC%EB%82%98-34c8e008106a",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://medium.com/jung-han/lerna-로-모노레포-해보러나-34c8e008106a"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("p",[t._v("Sharing TypeScript with Nx and Turborepo")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://javascript.plainenglish.io/d8d54b805e46",target:"_blank",rel:"noopener noreferrer"}},[t._v("Part 1: An Introduction to Monorepos"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://javascript.plainenglish.io/347bf3194181",target:"_blank",rel:"noopener noreferrer"}},[t._v("Part 2: Creating a Monorepo"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://javascript.plainenglish.io/2e4608701964",target:"_blank",rel:"noopener noreferrer"}},[t._v("Part 3: Configuring a Monorepo"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://javascript.plainenglish.io/a48adc99823e",target:"_blank",rel:"noopener noreferrer"}},[t._v("Part 4: Managing a Monorepo"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[r("p",[t._v("Pnpm and Nx monorepo")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.javierbrea.com/blog/pnpm-nx-monorepo-01/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.javierbrea.com/blog/pnpm-nx-monorepo-01/"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.javierbrea.com/blog/pnpm-nx-monorepo-02/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.javierbrea.com/blog/pnpm-nx-monorepo-02/"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.javierbrea.com/blog/pnpm-nx-monorepo-03/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.javierbrea.com/blog/pnpm-nx-monorepo-03/"),r("OutboundLink")],1)])])])]),t._v(" "),r("h2",{attrs:{id:"vids"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vids"}},[t._v("#")]),t._v(" vids")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.youtube.com/watch?v=Bycg5w5qXfE",target:"_blank",rel:"noopener noreferrer"}},[t._v("우리는 하나다! 모노레포 with pnpm"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.youtube.com/watch?v=Ix9gxqKOatY",target:"_blank",rel:"noopener noreferrer"}},[t._v("일백개 패키지 모노레포 우아하게 운영하기"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.youtube.com/watch?v=CsbBuE_MF2U",target:"_blank",rel:"noopener noreferrer"}},[t._v("모노레포 마이크로 아키텍처를 지향하며"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.youtube.com/watch?v=CCo7T3m6LLM",target:"_blank",rel:"noopener noreferrer"}},[t._v("모노레포 희망편 (Feat.Polylith)"),r("OutboundLink")],1)])]),t._v(" "),r("h2",{attrs:{id:"monorepo-features"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#monorepo-features"}},[t._v("#")]),t._v(" monorepo features")]),t._v(" "),r("p",[t._v("mororepo 툴이 수행하는 주요기능은 다음과 같다")]),t._v(" "),r("ul",[r("li",[t._v("배포 관리 (publish)")]),t._v(" "),r("li",[t._v("스크립트 실행 (run)")]),t._v(" "),r("li",[t._v("의존성 관리 (root 레벨에서 monorepo 전체 의존성을 관리하는 경우)")]),t._v(" "),r("li",[r("s",[t._v("버전 관리 (version)")]),t._v(" (툴별로 지원여부가 다르다)")])]),t._v(" "),r("h2",{attrs:{id:"version-managers"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#version-managers"}},[t._v("#")]),t._v(" Version Managers")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/changesets/changesets",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/changesets/changesets"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://nx.dev/recipes/adopting-nx/lerna-and-nx#version-management-&-publishing",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://nx.dev/recipes/adopting-nx/lerna-and-nx#version-management-&-publishing"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://turbo.build/repo/docs/handbook/publishing-packages/versioning-and-publishing",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://turbo.build/repo/docs/handbook/publishing-packages/versioning-and-publishing"),r("OutboundLink")],1)])]),t._v(" "),r("h2",{attrs:{id:"package-managers"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#package-managers"}},[t._v("#")]),t._v(" Package Managers")]),t._v(" "),r("p",[t._v("주요 패키지매니저(npm, pnpm, yarn)들은 워크스페이스 기능을 지원한다.\n워크스페이스 옵션을 지정하면 지정한 경로의 패키지를 우선 참조하여, 패키지를 설치했을 때 "),r("code",[t._v("node_moudles")]),t._v("에 패키지 링크를 생성한다.")]),t._v(" "),r("p",[t._v("각 패키지에서 다른 패키지를 참조할 때 "),r("code",[t._v('"*"')]),t._v("(모든버전)으로 지정한다. (pnpm은 "),r("code",[t._v('"workspace:*"')]),t._v(")")]),t._v(" "),r("div",{staticClass:"language-json line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dependencies"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"other-package"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br")])]),r("p",[t._v("패키지매니저에서 별도 옵션을 사용하지 않는다면 루트 디렉토리의 "),r("code",[t._v("node_modules")]),t._v("에 전체 의존성이 관리되고\n하위 패키지의 공통 의존성, 프로젝트 패키지간 참조등은 심볼릭 링크로 처리된다.")]),t._v(" "),r("h3",{attrs:{id:"pnpm-workspace"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pnpm-workspace"}},[t._v("#")]),t._v(" pnpm workspace")]),t._v(" "),r("p",[t._v("[[npm#pnpm]]")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://pnpm.io/workspaces",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://pnpm.io/workspaces"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("a",{attrs:{href:"https://pnpm.io/pnpm-workspace_yaml",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("pnpm-workspace.yaml")]),r("OutboundLink")],1)]),t._v(" "),r("h4",{attrs:{id:"pnpm-workspace-deployment"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pnpm-workspace-deployment"}},[t._v("#")]),t._v(" pnpm workspace deployment")]),t._v(" "),r("p",[t._v("pnpm에서는 다음 옵션을 고려해볼 수 있다")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://pnpm.io/cli/deploy",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://pnpm.io/cli/deploy"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://pnpm.io/npmrc#shared-workspace-lockfile",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://pnpm.io/npmrc#shared-workspace-lockfile"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("code",[t._v("pnpm install --filter")]),t._v(" - 참고 ("),r("a",{attrs:{href:"https://yarnpkg.com/features/workspaces#focused-installs",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://yarnpkg.com/features/workspaces#focused-installs"),r("OutboundLink")],1),t._v(")")])]),t._v(" "),r("p",[t._v("관련 문서")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/pnpm/pnpm/issues/2198",target:"_blank",rel:"noopener noreferrer"}},[t._v("Bundling up project for deployment"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/pnpm/pnpm/issues/4378",target:"_blank",rel:"noopener noreferrer"}},[t._v("A deploy command"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/vercel/next.js/issues/45258",target:"_blank",rel:"noopener noreferrer"}},[t._v("NextJS 13 (latest) package not working in monorepos"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/pnpm/pnpm/issues/4493",target:"_blank",rel:"noopener noreferrer"}},[t._v("Allow pnpm install --filter to install dependencies of workspace dependencies"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/pnpm/pnpm/issues/5179",target:"_blank",rel:"noopener noreferrer"}},[t._v('In a monorepo: pnpm install --filter "package..." doesn\'t install root directory packages'),r("OutboundLink")],1)])]),t._v(" "),r("h3",{attrs:{id:"npm-workspace"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#npm-workspace"}},[t._v("#")]),t._v(" npm workspace")]),t._v(" "),r("p",[t._v("[[npm#npm]]")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://docs.npmjs.com/cli/v10/using-npm/workspaces",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.npmjs.com/cli/v10/using-npm/workspaces"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("a",{attrs:{href:"https://docs.npmjs.com/cli/v10/configuring-npm/package-json#workspaces",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("package-json")]),r("OutboundLink")],1)]),t._v(" "),r("h2",{attrs:{id:"monorepo-deployment"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#monorepo-deployment"}},[t._v("#")]),t._v(" monorepo deployment")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("패키지 게시")]),t._v(" "),r("ul",[r("li",[t._v("lockfile을 사용하지 않으므로 빌드 결과물과 "),r("code",[t._v("package.json")]),t._v("을 배포하면 된다")]),t._v(" "),r("li",[t._v("참고: [[npm#npm package publishing & lockfile]]")])])]),t._v(" "),r("li",[r("p",[t._v("웹 프론트엔드 프로젝트")]),t._v(" "),r("ul",[r("li",[t._v("번들러를 사용하므로 빌드 결과물을 배포하면 된다")])])]),t._v(" "),r("li",[r("p",[t._v("웹 백엔드 프로젝트")]),t._v(" "),r("ul",[r("li",[t._v("번들러를 사용했을 때 파일기반 기능(auto loader, file scan)이 정상작동하지 않을 수 있어 주로 "),r("code",[t._v("node_modules")]),t._v("를 함께 배포하게 된다 (docker 배포 역시 마찬가지)")]),t._v(" "),r("li",[t._v("배포하려는 패키지의 의존성만 선택해서 포함하기 어려울 수 있다 (패키지매니저가 기능을 제공해야 한다)")]),t._v(" "),r("li",[t._v("참고: "),r("a",{attrs:{href:"#pnpm-workspace-deployment"}},[t._v("pnpm workspace deployment")]),t._v(", "),r("a",{attrs:{href:"#symlinks-in-node_modules"}},[t._v("symlinks-in-node_modules")])])])])]),t._v(" "),r("h2",{attrs:{id:"nx"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#nx"}},[t._v("#")]),t._v(" Nx")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://nx.dev/getting-started/intro",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://nx.dev/getting-started/intro"),r("OutboundLink")],1)]),t._v(" "),r("h3",{attrs:{id:"nx-quickstart"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#nx-quickstart"}},[t._v("#")]),t._v(" Nx Quickstart")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://turbo.build/repo/docs/getting-started/create-new#quickstart",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://turbo.build/repo/docs/getting-started/create-new#quickstart"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/nrwl/nx-examples",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/nrwl/nx-examples"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/nrwl/nx-recipes",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/nrwl/nx-recipes"),r("OutboundLink")],1)])]),t._v(" "),r("div",{staticClass:"language-sh line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[t._v("npx create-nx-workspace --pm "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("h3",{attrs:{id:"nx-configuration"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#nx-configuration"}},[t._v("#")]),t._v(" Nx Configuration")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://nx.dev/reference/nx-json",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("nx.json")]),r("OutboundLink")],1)]),t._v(" "),r("h2",{attrs:{id:"turborepo"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#turborepo"}},[t._v("#")]),t._v(" Turborepo")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://turbo.build/repo/docs",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://turbo.build/repo/docs"),r("OutboundLink")],1)]),t._v(" "),r("h3",{attrs:{id:"turborepo-quckstart"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#turborepo-quckstart"}},[t._v("#")]),t._v(" Turborepo Quckstart")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://turbo.build/repo/docs/getting-started/create-new#quickstart",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://turbo.build/repo/docs/getting-started/create-new#quickstart"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://turbo.build/repo/docs/getting-started/from-example",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://turbo.build/repo/docs/getting-started/from-example"),r("OutboundLink")],1)])]),t._v(" "),r("div",{staticClass:"language-sh line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[t._v("npx create-turbo@latest\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("h3",{attrs:{id:"turborepo-configuration"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#turborepo-configuration"}},[t._v("#")]),t._v(" Turborepo Configuration")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://turbo.build/repo/docs/reference/configuration",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("turbo.json")]),r("OutboundLink")],1)]),t._v(" "),r("h2",{attrs:{id:"lerna"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lerna"}},[t._v("#")]),t._v(" lerna")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/lerna/lerna",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/lerna/lerna"),r("OutboundLink")],1)]),t._v(" "),r("blockquote",[r("p",[t._v("monorepo 내의 node_modules 중복이 많아질 수록 lerna의 성능이 좋지 않다")]),t._v(" "),r("p",[t._v("-- "),r("a",{attrs:{href:"https://doppelmutzi.github.io/monorepo-lerna-yarn-workspaces/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://doppelmutzi.github.io/monorepo-lerna-yarn-workspaces/"),r("OutboundLink")],1)])]),t._v(" "),r("p",[t._v("주요 명령어는 다음과 같다")]),t._v(" "),r("h3",{attrs:{id:"init"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#init"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://github.com/lerna/lerna/tree/main/commands/init#readme",target:"_blank",rel:"noopener noreferrer"}},[t._v("init"),r("OutboundLink")],1)]),t._v(" "),r("blockquote",[r("p",[t._v("Create a new Lerna repo or upgrade an existing repo to the current version of Lerna")])]),t._v(" "),r("h3",{attrs:{id:"bootstrap"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#bootstrap"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://github.com/lerna/lerna/tree/main/commands/bootstrap#readme",target:"_blank",rel:"noopener noreferrer"}},[t._v("bootstrap"),r("OutboundLink")],1)]),t._v(" "),r("blockquote",[r("p",[t._v("Bootstrap the packages in the current Lerna repo. Installs all of their dependencies and links any cross-dependencies.")])]),t._v(" "),r("h3",{attrs:{id:"version"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#version"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://github.com/lerna/lerna/tree/main/commands/version#readme",target:"_blank",rel:"noopener noreferrer"}},[t._v("version"),r("OutboundLink")],1)]),t._v(" "),r("blockquote",[r("p",[t._v("Bump version of packages changed since the last release.\nIdentifies packages that have been updated since the previous tagged release")])]),t._v(" "),r("h3",{attrs:{id:"publish"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#publish"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://github.com/lerna/lerna/tree/main/commands/publish#readme",target:"_blank",rel:"noopener noreferrer"}},[t._v("publish"),r("OutboundLink")],1)]),t._v(" "),r("blockquote",[r("p",[t._v("Publish packages in the current project")])]),t._v(" "),r("h3",{attrs:{id:"run"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://github.com/lerna/lerna/tree/main/commands/run#readme",target:"_blank",rel:"noopener noreferrer"}},[t._v("run"),r("OutboundLink")],1)]),t._v(" "),r("blockquote",[r("p",[t._v("Run an npm script in each package that contains that script")])]),t._v(" "),r("h3",{attrs:{id:"monorepo-적용-w-lerna-github-package-registry"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#monorepo-적용-w-lerna-github-package-registry"}},[t._v("#")]),t._v(" monorepo 적용 (w/ lerna, github package registry)")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://viewsource.io/publishing-and-installing-private-github-packages-using-yarn-and-lerna/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://viewsource.io/publishing-and-installing-private-github-packages-using-yarn-and-lerna/"),r("OutboundLink")],1)]),t._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" init\nlerna init --independent\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br")])]),r("p",[t._v("프로젝트 루트에 "),r("code",[t._v("package.json")]),t._v(" 파일과 "),r("code",[t._v("lerna.json")]),t._v(" 설정파일이 생성된다")]),t._v(" "),r("h4",{attrs:{id:"package-json-root"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#package-json-root"}},[t._v("#")]),t._v(" "),r("code",[t._v("package.json")]),t._v(" - root")]),t._v(" "),r("div",{staticClass:"language-json line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"monorepo"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"private"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"workspaces"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"packages/core"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"packages/*"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"build"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lerna run build --stream"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"clean"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lerna run clean --parallel"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deps"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn exec --workspaces -- ncu"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deps:update"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn exec --workspaces -- ncu --target minor -u"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deps:clean"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"find . -name 'node_modules' -type d -prune -print -exec rm -rf '{}' +\"")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version:all"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lerna version --no-changelog"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"publish:all"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn run clean && yarn run build && lerna publish from-package"')]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br"),r("span",{staticClass:"line-number"},[t._v("12")]),r("br"),r("span",{staticClass:"line-number"},[t._v("13")]),r("br"),r("span",{staticClass:"line-number"},[t._v("14")]),r("br")])]),r("p",[t._v("workspace 목록을 별도 표기하여 빌드 실행 우선순위를 지정할 수 있음\n(이 경우 lerna 커맨드 실행시 패키지 중복오류가 발생할 수 있으므로 전체 경로("),r("code",[t._v("*")]),t._v(")만 사용하고 스크립트 실행등은 lerna run 사용)")]),t._v(" "),r("h4",{attrs:{id:"package-json-packages"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#package-json-packages"}},[t._v("#")]),t._v(" "),r("code",[t._v("package.json")]),t._v(" - packages")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://docs.npmjs.com/cli/v6/configuring-npm/package-json#repository",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.npmjs.com/cli/v6/configuring-npm/package-json#repository"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("패키지 이름은 "),r("code",[t._v("@scope")]),t._v(" + 워크스페이스 prefix 경로("),r("code",[t._v("packages/*")]),t._v(")를 제외한 패키지로 정의하고")]),t._v(" "),r("p",[t._v("각 패키지의 "),r("code",[t._v("package.json")]),t._v(" 파일에 다음 내용을 추가한다")]),t._v(" "),r("div",{staticClass:"language-json line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  ...\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@scope/package-name-without-workspaces-prefix"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"repository"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"url"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ssh://git@github.com/idpravus/monorepo.git"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"directory"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"packages/package-name-without-workspaces-prefix"')]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"publishConfig"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://npm.pkg.github.com/"')]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  ...\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br"),r("span",{staticClass:"line-number"},[t._v("12")]),r("br"),r("span",{staticClass:"line-number"},[t._v("13")]),r("br")])]),r("h4",{attrs:{id:"lerna-json"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lerna-json"}},[t._v("#")]),t._v(" "),r("code",[t._v("lerna.json")])]),t._v(" "),r("p",[t._v("다음 내용을 추가한다")]),t._v(" "),r("div",{staticClass:"language-json line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  ...\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"npmClient"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yarn"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"useWorkspaces"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"command"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"release"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ignoreChanges"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**/*.spec.ts"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**/*.md"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"publish"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://npm.pkg.github.com"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"allowBranch"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br"),r("span",{staticClass:"line-number"},[t._v("12")]),r("br"),r("span",{staticClass:"line-number"},[t._v("13")]),r("br"),r("span",{staticClass:"line-number"},[t._v("14")]),r("br"),r("span",{staticClass:"line-number"},[t._v("15")]),r("br")])]),r("h2",{attrs:{id:"rush"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#rush"}},[t._v("#")]),t._v(" Rush")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://rushjs.io/pages/intro/get_started/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://rushjs.io/pages/intro/get_started/"),r("OutboundLink")],1)]),t._v(" "),r("h2",{attrs:{id:"monorepo-tools"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#monorepo-tools"}},[t._v("#")]),t._v(" monorepo tools")]),t._v(" "),r("h3",{attrs:{id:"eslint"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#eslint"}},[t._v("#")]),t._v(" eslint")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://typescript-eslint.io/linting/typed-linting/monorepos",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://typescript-eslint.io/linting/typed-linting/monorepos"),r("OutboundLink")],1)]),t._v(" "),r("h3",{attrs:{id:"jest"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#jest"}},[t._v("#")]),t._v(" jest")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://jestjs.io/docs/next/configuration#projects-arraystring--projectconfig",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://jestjs.io/docs/next/configuration#projects-arraystring--projectconfig"),r("OutboundLink")],1)]),t._v(" "),r("h3",{attrs:{id:"vitest"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vitest"}},[t._v("#")]),t._v(" vitest")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://vitest.dev/guide/workspace.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vitest.dev/guide/workspace.html"),r("OutboundLink")],1)]),t._v(" "),r("h2",{attrs:{id:"monorepo-troubleshooting"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#monorepo-troubleshooting"}},[t._v("#")]),t._v(" monorepo troubleshooting")]),t._v(" "),r("h3",{attrs:{id:"symlinks-in-node-modules"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#symlinks-in-node-modules"}},[t._v("#")]),t._v(" symlinks in node_modules")]),t._v(" "),r("blockquote",[r("p",[r("code",[t._v("node_modules")]),t._v(" 를 복사할 때는 symlink도 포함해야 함")])]),t._v(" "),r("ul",[r("li",[r("code",[t._v("tar")]),t._v(" 는 별도 옵션 없어도 포함함")]),t._v(" "),r("li",[r("code",[t._v("zip")]),t._v(" 은 "),r("code",[t._v("-y, --symlinks")]),t._v(" 옵션 사용")])])])}),[],!1,null,null,null);e.default=s.exports}}]);