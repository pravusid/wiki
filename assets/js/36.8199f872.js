(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{239:function(e,a,s){"use strict";s.r(a);var r=s(0),t=Object(r.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[e._v("#")]),e._v(" Dockerfile")]),e._v(" "),s("p",[e._v("Dockerfile을 이용해서 배포용 이미지 파일을 생성한다")]),e._v(" "),s("h2",{attrs:{id:"dockerfile-기본-명령어"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-기본-명령어"}},[e._v("#")]),e._v(" Dockerfile 기본 명령어")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.docker.com/engine/reference/builder/"),s("OutboundLink")],1)]),e._v(" "),s("h3",{attrs:{id:"from"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#from"}},[e._v("#")]),e._v(" FROM")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("FROM <image> [AS <name>]\nFROM <image>[:<tag>] [AS <name>]\nFROM <image>[@<digest>] [AS <name>]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("베이스 이미지를 반드시 지정해야 하며 기본값으로 쓸 수 있는 베이스 이미지는 "),s("a",{attrs:{href:"https://hub.docker.com/explore/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker hub"),s("OutboundLink")],1),e._v("에서 확인가능")]),e._v(" "),s("h3",{attrs:{id:"copy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[e._v("#")]),e._v(" COPY")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('COPY [--chown=<user>:<group>] <src>... <dest>\nCOPY [--chown=<user>:<group>] ["<src>",... "<dest>"]\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("파일이나 디렉토리를 이미지로 복사. 일반적으로 소스를 복사함. "),s("code",[e._v("target")]),e._v("디렉토리가 없으면 자동생성")]),e._v(" "),s("h3",{attrs:{id:"add"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add"}},[e._v("#")]),e._v(" ADD")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('ADD [--chown=<user>:<group>] <src>... <dest>\nADD [--chown=<user>:<group>] ["<src>",... "<dest>"]\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[s("code",[e._v("COPY")]),e._v("명령어와 매우 유사하나 차이점이 있음.\n"),s("code",[e._v("src")]),e._v("에 파일 대신 URL을 입력할 수 있고 "),s("code",[e._v("src")]),e._v("에 압축 파일을 입력하는 경우 자동으로 압축을 해제하면서 복사됨.")]),e._v(" "),s("h3",{attrs:{id:"run"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[e._v("#")]),e._v(" RUN")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('RUN <command>\nRUN ["executable", "param1", "param2"]\nRUN executable param1 param2\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("명령어를 그대로 실행함. "),s("code",[e._v("/bin/sh -c")]),e._v(" 뒤에 명령어를 실행하는 방식")]),e._v(" "),s("h3",{attrs:{id:"cmd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmd"}},[e._v("#")]),e._v(" CMD")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('CMD ["executable","param1","param2"]\nCMD executable param1 param2\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("도커 컨테이너가 실행되었을 때 작동하는 명령어. 빌드할 때는 실행되지 않으며 여러 개의 "),s("code",[e._v("CMD")]),e._v("가 존재할 경우 가장 마지막 "),s("code",[e._v("CMD")]),e._v("만 실행 됨. 한꺼번에 여러 개의 프로그램을 실행하고 싶은 경우에는 "),s("code",[e._v("run.sh")]),e._v("파일을 작성하여 데몬으로 실행 함.")]),e._v(" "),s("h3",{attrs:{id:"workdir"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#workdir"}},[e._v("#")]),e._v(" WORKDIR")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("WORKDIR /path/to/workdir\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("각 명령어의 현재 디렉토리는 한 줄 한 줄마다 초기화되기 때문에  같은 디렉토리에서 계속 작업하기 위해서 "),s("code",[e._v("WORKDIR")]),e._v("을 사용함")]),e._v(" "),s("h3",{attrs:{id:"expose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#expose"}},[e._v("#")]),e._v(" EXPOSE")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("EXPOSE <port> [<port>/<protocol>...]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("도커 컨테이너가 실행되었을 때 요청을 기다리고 있는(Listen) 포트. 여러개의 포트를 지정가능")]),e._v(" "),s("h3",{attrs:{id:"volume"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#volume"}},[e._v("#")]),e._v(" VOLUME")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('VOLUME ["/data"]\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("컨테이너 외부의 파일시스템을 컨테이너 내부로 마운트 할 때 사용")]),e._v(" "),s("h3",{attrs:{id:"env"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#env"}},[e._v("#")]),e._v(" ENV")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ENV <key> <value>\nENV <key>=<value> ...\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("컨테이너에서 사용할 환경변수. 컨테이너를 실행할 때 "),s("code",[e._v("-e")]),e._v("옵션을 사용하면 기존 값을 오버라이딩")]),e._v(" "),s("h3",{attrs:{id:"entrypoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint"}},[e._v("#")]),e._v(" ENTRYPOINT")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('ENTRYPOINT ["executable", "param1", "param2"]\nENTRYPOINT command param1 param2\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("컨테이너가 시작되었을 때(docker run / docker start) 실행할 명령. Dockerfile에서 한 번만 지정할 수 있다.")]),e._v(" "),s("h3",{attrs:{id:"label"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#label"}},[e._v("#")]),e._v(" LABEL")]),e._v(" "),s("p",[e._v("이미지의 metadata를 명시")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('LABEL "com.example.vendor"="ACME Incorporated"\nLABEL com.example.label-with-value="foo"\nLABEL version="1.0"\nLABEL description="This text illustrates \\\nthat label-values can span multiple lines."\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("h3",{attrs:{id:"user"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#user"}},[e._v("#")]),e._v(" USER")]),e._v(" "),s("div",{staticClass:"language-dockerfile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("USER <user>[:<group>] or\nUSER <UID>[:<GID>]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("이미지와 Dockerfile에 지정된 RUN/CMD/ENTRYPOINT 명령을 실행할 때의 유저와 유저그룹을 지정한다")]),e._v(" "),s("blockquote",[s("p",[e._v("user의 primary group이 없으면 root group으로 실행됨")])]),e._v(" "),s("h2",{attrs:{id:"이미지-생성-및-사용"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#이미지-생성-및-사용"}},[e._v("#")]),e._v(" 이미지 생성 및 사용")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("절대경로지정: "),s("code",[e._v("docker build -f /path/to/a/Dockerfile .")])])]),e._v(" "),s("li",[s("p",[e._v("이름:태그 지정: "),s("code",[e._v("--tag")]),e._v("("),s("code",[e._v("-t")]),e._v("):")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("docker build -t shykes/myapp .")])]),e._v(" "),s("li",[s("code",[e._v("docker build -t shykes/myapp:latest -t shykes/myapp:1.0.2 .")])])])])])])}),[],!1,null,null,null);a.default=t.exports}}]);